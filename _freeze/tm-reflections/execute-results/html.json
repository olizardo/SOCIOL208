{
  "hash": "b7d6b5bab0e73265afa7c22cbf4cbc66",
  "result": {
    "markdown": "---\ntitle: \"The Method of Reflections in Two-Mode Networks\"\nexecute: \n  eval: true\n  echo: true\n  output: true\n  warning: false\n  message: false\nformat: \n   html:\n      code-line-numbers: true\n---\n\n\nIn a highly cited piece, [@hidalgo_hausmann09] (HH) motivated what they saw at the time as a novel approach to assigning meaningful scores to nodes in a two-mode network, using what they called a \"reflective\" approach. HH's original empirical application was to the two-mode country-by-product networks. Hence, they referred to their approach as a way to extract the \"economic complexity\" of countries in the world system (and dually the complexity of given products). \n\nOf course, just as with the [fitness/complexity](tm-fitness.qmd) approach, there is no logical connection between the formal method of iterative finding scores for nodes in two-mode networks and the particular case of economic trade since the approach proposed can be used to analyze any two-mode data matrix. As will be obvious, the HH approach belongs to the [extensive line](tm-prestige.qmd) of approaches to derive prestige scores for nodes in two-mode networks that we have reviewed, which included Bonacich and PageRank-style approaches. \n\nHow does the HH reflective scoring work? Let's define a two-mode network composed of a set of people $P$ and their affiliation relations to a set of groups $G$ can be represented by an affiliation matrix $\\mathbf{A}$ of dimensions $|P| \\times |G|$ with people along the rows and groups across the columns, where $|P|$ is the cardinality of the people set and $|G|$ is the cardinality of the group set, with cell entries $a_{pg}= 1$ if person $p$ is affiliated with group $g$ and $a_{pg}= 0$ otherwise. \n\nGiven this, the degree-centrality of people is given by:\n\n$$\n    C^R_p(1) = \\sum_g a_{pg}\n    \\label{eq:R1_p}\n$${#eq-pref0}\n\nAnd for groups:\n\n$$\n   C^R_g(1) = \\sum_p a_{pg}\n  \\label{eq:R1_g}\n$${#eq-gref0}\n\nThat is, the first-order centrality of people is the row sum of the entries in the affiliation matrix $\\mathbf{A}$, and the column sums of the same matrix give the first-order centrality of groups. \n\nAs noted by @hidalgo_hausmann09, the key to the reflective approach to computing the \"complexity\" of countries and products is the observation that, once we have these first-order quantities, it is possible to compute second-order quantities $C^R(2)$ for both people and groups using the *averaged* first-order centralities of the entities in the other mode they are connected to. \n\nFor people, these are given by:\n\n$$\n    C^R_p(2) = \\frac{1}{C^R_p(1)}\\sum_g a_{pg}C^R_g(1)\n    \\label{eq:R2_p}\n$${#eq-pref1}\n\nAnd for groups:\n\n$$\n   C^R_g(2) = \\frac{1}{C^R_g(1)}\\sum_p a_{pg}C^R_p(1)\n    \\label{eq:R2_g}\n$${#eq-gref1}\n\nWhile Equation @eq-pref0 assigns a high value to people who belong to a lot of groups,  @eq-pref1 assigns a high value to people who, on average, belong to large groups (e.g., whenever $a_{pg}*= 1$ and $C^R_g(1)$ is a big number). In the same way, while  @eq-gref0 assigns a high value to groups that have lots of members,  @eq-gref1 assigns a high value to groups that, on average, have members who themselves have lots of memberships (e.g., whenever $a_{pg}= 1$ and $C^R_p(1)$ is a big number). \n\nOf course, we can keep on going and define \"third-order\" reflections; for the people, these are given by:\n\n$$\n   C^R_p(3) = \\frac{1}{C^R_p(1)}\\sum_g a_{pg}C^R_g(2)\n   \\label{eq:R3_p}\n$${#eq-pref2}\n\nAnd for groups:\n\n$$\n   C^R_g(3) = \\frac{1}{C^R_g(1)}\\sum_p a_{pg}C^R_p(2)\n   \\label{eq:R3_g}\n$${#eq-gref2}\n\nAs we saw, while for people, @eq-pref1 measured the average size of the groups they join, @eq-pref2 assigns a high value to people who, on average, belong to groups who are themselves attended by highly active members (e.g., whenever $a_{pg}= 1$ and $C^R_g(2)$ is a big number). \n\nIn the same way, while @eq-gref1 assigns a high value to groups whose members have lots of memberships, @eq-gref2 assigns a high value to groups that, on average, have members who themselves (also on average) belong to large groups (e.g., $a_{pg}= 1$ and $C^R_p(2)$ is a big number).\n\nNote that for people, the even-numbered reflection $C^R_p(2)$ assigns scores based on a formal feature of the *groups* they belong to (in this case, the group sizes). On the other hand, the odd-numbered reflection $C^R_p(3)$ assigns scores based on a formal feature of the *members of the groups* they belong to (in this case, the average size of the groups they belong to). \n\nIn the same way, for the groups, the even-numbered reflection $C^R_g(2)$ assigns scores based on a formal feature of the *people* who belong to them (in this case, their activity). On the other hand, the odd-numbered reflection $C^R_g(3)$ assigns scores based on a formal feature of the *other groups their members belong to*(in this case, their average group size). \n\nWhile these are distinct metrics in principle, in practice, the ordering of the nodes in each mode ends up being identical across even and odd scores after their rank ordering \"freezes\" past a given number of iterations (proportional to the network size). \n\nMore generally, @hidalgo_hausmann09 show that we can define a series of reflective quantities for people and groups (whose verbal and substantive interpretation becomes more complex as the number of iterations increases). \n\nFor people, these are given by:\n\n$$\n    C^R_p(q) = \\frac{1}{C^R_p(1)}\\sum_g a_{pg}C^R_g(q-1) \n   \\label{eq:Rq_p}\n$${#eq-prefq}\n\nAnd for groups:\n\n$$\n   C^R_g(q) = \\frac{1}{C^R_g(1)}\\sum_p a_{pg}C^R_p(q-1)\n   \\label{eq:Rq_g}\n$${#eq-grefq}\n\n@eq-prefq says that the reflective score of a person *p*at iteration *q* is the sum of the reflective scores the groups they belong to at the $q-1$ iteration ($C^R_g(q-1)$) divided by their number of memberships $C^{R}_p(1)$. \n\n@eq-grefq says that the $q^{th}$ group reflective score is the sum of the reflective scores of their members at the $q-1$ iteration $C^R_p(q-1)$, divided by the number of group members $C^R_g(1)$.\n\n## Method of Reflections in the Southern Women Data\n\nLet's see how this would work in a real two-mode network. To do that, we load up our trusty *Southern Women* (SW) data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   library(networkdata)\n   library(igraph)\n   g <- southern_women\n   A <- as.matrix(as_biadjacency_matrix(g))\n```\n:::\n\n\nNow, we need a function that does all of the reflections that we just spoke about. Here's one that accomplishes that, which is slight modification of the `tm.status` function from the [two-mode prestige lecture notes](tm-prestige.qmd):\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    reflections <- function(x, iter = 20) { #x is a matrix with people as rows and groups as columns iters is number of reflections\n    z <- t(x)\n    p.c <- matrix(0, nrow(x), iter) #initialize person centralities\n    g.c <- matrix(0, ncol(x), iter) #initialize group centralities trajectory matrix\n    rownames(p.c) <- rownames(x)\n    rownames(g.c) <- colnames(x)\n    colnames(p.c) <- paste(\"Ref_\", c(1:iter), sep = \"\")\n    colnames(g.c) <- paste(\"Ref_\", c(1:iter), sep = \"\")\n    p.c[, 1] <- rowSums(x) #person degree centrality \n    g.c[, 1] <- colSums(x) #group degree centrality \n    k <- 1 #initializing counter\n    while (k < iter) {\n        p.c[, k + 1] <- (x %*% g.c[, k]) * p.c[, 1]^-1 #assign person average centrality of groups they belong to\n        g.c[, k + 1] <- (z %*% p.c[, k]) * g.c[, 1]^-1 #assign group average centrality of people in the group\n        k <- k + 1 #increase counter\n        } #end while loop\n    return(list(p.c = p.c, g.c = g.c))\n    } #end function\n```\n:::\n\n\nThe function above takes the biadjacency matrix $\\mathbf{A}$ as input and returns two objects: \n\n1. A matrix `p.c` with people as the rows and the as many columns as there are reflections, containing the reflective scores at each iteration for persons in each column. \n1. A matrix `g.c` with groups as the rows and the as many columns as there are reflections, containing the reflective scores at each iteration for groups in each column. \n\nAnd let's try it out:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    ref.res <- reflections(A)\n```\n:::\n\n\nLet's check out the person scores at the 18th reflection:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    ref.res$p.c[, 18]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL \n 8.237399  8.237471  8.237136  8.237493  8.237705  8.237390  8.236873  8.236036 \n     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY \n 8.236263  8.235172  8.234456  8.234045  8.234358  8.234379  8.234508  8.235424 \n   OLIVIA     FLORA \n 8.234058  8.234058 \n```\n:::\n:::\n\n\nThis all look like slightly different versions of the same number! The reason for this is as @hidalgo_hausmann09 note, is that the scores begin to *converge* as the number of reflections increase. To get noticeable differences, we need to *scale* the higher reflection scores using the standard normalization:\n\n$$\n\\tilde{C}^R =\\frac{C^R-\\bar{C}^R}{\\sigma_{C^R}}\n$${#eq-norm}\n\nWhere $\\bar{C}^R$ is the mean reflective score and $\\sigma_{C^R}$ is the standard deviation of the reflective scores. The resulting scores will have a mean of zero and variance of 1.0.\n\nIn `R` we can do this using the native `scale` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    scale(ref.res$p.c[, 18])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                [,1]\nEVELYN     1.1235228\nLAURA      1.1743094\nTHERESA    0.9398214\nBRENDA     1.1895381\nCHARLOTTE  1.3377969\nFRANCES    1.1176566\nELEANOR    0.7563908\nPEARL      0.1715174\nRUTH       0.3304853\nVERNE     -0.4321409\nMYRNA     -0.9320071\nKATHERINE -1.2190721\nSYLVIA    -1.0001263\nNORA      -0.9855713\nHELEN     -0.8958773\nDOROTHY   -0.2556010\nOLIVIA    -1.2103213\nFLORA     -1.2103213\nattr(,\"scaled:center\")\n[1] 8.23579\nattr(,\"scaled:scale\")\n[1] 0.001431558\n```\n:::\n:::\n\n\nBetter!\n\nRecall also that the @hidalgo_hausmann09 reflections iterate between odd and even scores. We want only one of those. So let's choose the even columns for persons and groups:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    HH.p <- scale(ref.res$p.c[, seq(2, 20, by = 2)])\n    HH.g <- scale(ref.res$g.c[, seq(2, 20, by = 2)])\n```\n:::\n\n\nAnd now we can put them in fancy tables, as in @tbl-ref:\n\n::: {#tbl-ref .cell layout-nrow=\"2\" tbl-cap='Reflective Scores' tbl-subcap='[\"Persons.\",\"Groups.\"]'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Ref_2 </th>\n   <th style=\"text-align:right;\"> Ref_4 </th>\n   <th style=\"text-align:right;\"> Ref_6 </th>\n   <th style=\"text-align:right;\"> Ref_8 </th>\n   <th style=\"text-align:right;\"> Ref_10 </th>\n   <th style=\"text-align:right;\"> Ref_12 </th>\n   <th style=\"text-align:right;\"> Ref_14 </th>\n   <th style=\"text-align:right;\"> Ref_16 </th>\n   <th style=\"text-align:right;\"> Ref_18 </th>\n   <th style=\"text-align:right;\"> Ref_20 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> CHARLOTTE </td>\n   <td style=\"text-align:right;\"> -0.94 </td>\n   <td style=\"text-align:right;\"> -1.03 </td>\n   <td style=\"text-align:right;\"> -0.73 </td>\n   <td style=\"text-align:right;\"> 0.27 </td>\n   <td style=\"text-align:right;\"> 1.03 </td>\n   <td style=\"text-align:right;\"> 1.26 </td>\n   <td style=\"text-align:right;\"> 1.32 </td>\n   <td style=\"text-align:right;\"> 1.33 </td>\n   <td style=\"text-align:right;\"> 1.34 </td>\n   <td style=\"text-align:right;\"> 1.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> BRENDA </td>\n   <td style=\"text-align:right;\"> -0.62 </td>\n   <td style=\"text-align:right;\"> -0.62 </td>\n   <td style=\"text-align:right;\"> -0.31 </td>\n   <td style=\"text-align:right;\"> 0.47 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.15 </td>\n   <td style=\"text-align:right;\"> 1.18 </td>\n   <td style=\"text-align:right;\"> 1.19 </td>\n   <td style=\"text-align:right;\"> 1.19 </td>\n   <td style=\"text-align:right;\"> 1.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> LAURA </td>\n   <td style=\"text-align:right;\"> -0.70 </td>\n   <td style=\"text-align:right;\"> -0.57 </td>\n   <td style=\"text-align:right;\"> -0.19 </td>\n   <td style=\"text-align:right;\"> 0.57 </td>\n   <td style=\"text-align:right;\"> 1.03 </td>\n   <td style=\"text-align:right;\"> 1.14 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> EVELYN </td>\n   <td style=\"text-align:right;\"> -0.80 </td>\n   <td style=\"text-align:right;\"> -0.58 </td>\n   <td style=\"text-align:right;\"> -0.18 </td>\n   <td style=\"text-align:right;\"> 0.58 </td>\n   <td style=\"text-align:right;\"> 1.02 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> FRANCES </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.27 </td>\n   <td style=\"text-align:right;\"> 0.51 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> THERESA </td>\n   <td style=\"text-align:right;\"> -0.31 </td>\n   <td style=\"text-align:right;\"> -0.21 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 0.58 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> 0.93 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> ELEANOR </td>\n   <td style=\"text-align:right;\"> 0.73 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 0.79 </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n   <td style=\"text-align:right;\"> 0.80 </td>\n   <td style=\"text-align:right;\"> 0.76 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 0.76 </td>\n   <td style=\"text-align:right;\"> 0.76 </td>\n   <td style=\"text-align:right;\"> 0.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> RUTH </td>\n   <td style=\"text-align:right;\"> 1.28 </td>\n   <td style=\"text-align:right;\"> 1.21 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n   <td style=\"text-align:right;\"> 0.51 </td>\n   <td style=\"text-align:right;\"> 0.38 </td>\n   <td style=\"text-align:right;\"> 0.34 </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> PEARL </td>\n   <td style=\"text-align:right;\"> 1.47 </td>\n   <td style=\"text-align:right;\"> 1.55 </td>\n   <td style=\"text-align:right;\"> 1.53 </td>\n   <td style=\"text-align:right;\"> 1.08 </td>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:right;\"> 0.27 </td>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> DOROTHY </td>\n   <td style=\"text-align:right;\"> 2.40 </td>\n   <td style=\"text-align:right;\"> 2.22 </td>\n   <td style=\"text-align:right;\"> 2.00 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 0.22 </td>\n   <td style=\"text-align:right;\"> -0.12 </td>\n   <td style=\"text-align:right;\"> -0.22 </td>\n   <td style=\"text-align:right;\"> -0.25 </td>\n   <td style=\"text-align:right;\"> -0.26 </td>\n   <td style=\"text-align:right;\"> -0.26 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> VERNE </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n   <td style=\"text-align:right;\"> 0.68 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> -0.34 </td>\n   <td style=\"text-align:right;\"> -0.44 </td>\n   <td style=\"text-align:right;\"> -0.44 </td>\n   <td style=\"text-align:right;\"> -0.44 </td>\n   <td style=\"text-align:right;\"> -0.43 </td>\n   <td style=\"text-align:right;\"> -0.43 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> HELEN </td>\n   <td style=\"text-align:right;\"> -0.49 </td>\n   <td style=\"text-align:right;\"> -0.57 </td>\n   <td style=\"text-align:right;\"> -0.74 </td>\n   <td style=\"text-align:right;\"> -0.99 </td>\n   <td style=\"text-align:right;\"> -0.99 </td>\n   <td style=\"text-align:right;\"> -0.94 </td>\n   <td style=\"text-align:right;\"> -0.91 </td>\n   <td style=\"text-align:right;\"> -0.90 </td>\n   <td style=\"text-align:right;\"> -0.90 </td>\n   <td style=\"text-align:right;\"> -0.89 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> MYRNA </td>\n   <td style=\"text-align:right;\"> 0.31 </td>\n   <td style=\"text-align:right;\"> 0.40 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> -0.63 </td>\n   <td style=\"text-align:right;\"> -0.97 </td>\n   <td style=\"text-align:right;\"> -1.00 </td>\n   <td style=\"text-align:right;\"> -0.97 </td>\n   <td style=\"text-align:right;\"> -0.95 </td>\n   <td style=\"text-align:right;\"> -0.93 </td>\n   <td style=\"text-align:right;\"> -0.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> NORA </td>\n   <td style=\"text-align:right;\"> -1.28 </td>\n   <td style=\"text-align:right;\"> -1.38 </td>\n   <td style=\"text-align:right;\"> -1.62 </td>\n   <td style=\"text-align:right;\"> -1.68 </td>\n   <td style=\"text-align:right;\"> -1.34 </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n   <td style=\"text-align:right;\"> -1.04 </td>\n   <td style=\"text-align:right;\"> -1.00 </td>\n   <td style=\"text-align:right;\"> -0.99 </td>\n   <td style=\"text-align:right;\"> -0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> SYLVIA </td>\n   <td style=\"text-align:right;\"> -0.62 </td>\n   <td style=\"text-align:right;\"> -0.92 </td>\n   <td style=\"text-align:right;\"> -1.34 </td>\n   <td style=\"text-align:right;\"> -1.67 </td>\n   <td style=\"text-align:right;\"> -1.43 </td>\n   <td style=\"text-align:right;\"> -1.20 </td>\n   <td style=\"text-align:right;\"> -1.08 </td>\n   <td style=\"text-align:right;\"> -1.03 </td>\n   <td style=\"text-align:right;\"> -1.00 </td>\n   <td style=\"text-align:right;\"> -0.99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> KATHERINE </td>\n   <td style=\"text-align:right;\"> -0.84 </td>\n   <td style=\"text-align:right;\"> -1.08 </td>\n   <td style=\"text-align:right;\"> -1.55 </td>\n   <td style=\"text-align:right;\"> -1.94 </td>\n   <td style=\"text-align:right;\"> -1.69 </td>\n   <td style=\"text-align:right;\"> -1.44 </td>\n   <td style=\"text-align:right;\"> -1.31 </td>\n   <td style=\"text-align:right;\"> -1.25 </td>\n   <td style=\"text-align:right;\"> -1.22 </td>\n   <td style=\"text-align:right;\"> -1.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> OLIVIA </td>\n   <td style=\"text-align:right;\"> -0.38 </td>\n   <td style=\"text-align:right;\"> -0.20 </td>\n   <td style=\"text-align:right;\"> -0.05 </td>\n   <td style=\"text-align:right;\"> -0.25 </td>\n   <td style=\"text-align:right;\"> -0.67 </td>\n   <td style=\"text-align:right;\"> -0.94 </td>\n   <td style=\"text-align:right;\"> -1.09 </td>\n   <td style=\"text-align:right;\"> -1.17 </td>\n   <td style=\"text-align:right;\"> -1.21 </td>\n   <td style=\"text-align:right;\"> -1.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> FLORA </td>\n   <td style=\"text-align:right;\"> -0.38 </td>\n   <td style=\"text-align:right;\"> -0.20 </td>\n   <td style=\"text-align:right;\"> -0.05 </td>\n   <td style=\"text-align:right;\"> -0.25 </td>\n   <td style=\"text-align:right;\"> -0.67 </td>\n   <td style=\"text-align:right;\"> -0.94 </td>\n   <td style=\"text-align:right;\"> -1.09 </td>\n   <td style=\"text-align:right;\"> -1.17 </td>\n   <td style=\"text-align:right;\"> -1.21 </td>\n   <td style=\"text-align:right;\"> -1.23 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup>*</sup> Scores normalized to unit variance.</td></tr></tfoot>\n</table>\n\n`````\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Ref_2 </th>\n   <th style=\"text-align:right;\"> Ref_4 </th>\n   <th style=\"text-align:right;\"> Ref_6 </th>\n   <th style=\"text-align:right;\"> Ref_8 </th>\n   <th style=\"text-align:right;\"> Ref_10 </th>\n   <th style=\"text-align:right;\"> Ref_12 </th>\n   <th style=\"text-align:right;\"> Ref_14 </th>\n   <th style=\"text-align:right;\"> Ref_16 </th>\n   <th style=\"text-align:right;\"> Ref_18 </th>\n   <th style=\"text-align:right;\"> Ref_20 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 6/27 </td>\n   <td style=\"text-align:right;\"> 1.24 </td>\n   <td style=\"text-align:right;\"> 1.24 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 1.14 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 9/26 </td>\n   <td style=\"text-align:right;\"> 0.64 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n   <td style=\"text-align:right;\"> 1.09 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 4/12 </td>\n   <td style=\"text-align:right;\"> 0.22 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> 1.07 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n   <td style=\"text-align:right;\"> 1.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 3/2 </td>\n   <td style=\"text-align:right;\"> 1.59 </td>\n   <td style=\"text-align:right;\"> 1.10 </td>\n   <td style=\"text-align:right;\"> 1.02 </td>\n   <td style=\"text-align:right;\"> 1.02 </td>\n   <td style=\"text-align:right;\"> 1.03 </td>\n   <td style=\"text-align:right;\"> 1.03 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2/25 </td>\n   <td style=\"text-align:right;\"> -0.38 </td>\n   <td style=\"text-align:right;\"> 0.43 </td>\n   <td style=\"text-align:right;\"> 0.81 </td>\n   <td style=\"text-align:right;\"> 0.92 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 5/19 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.30 </td>\n   <td style=\"text-align:right;\"> 0.52 </td>\n   <td style=\"text-align:right;\"> 0.60 </td>\n   <td style=\"text-align:right;\"> 0.62 </td>\n   <td style=\"text-align:right;\"> 0.63 </td>\n   <td style=\"text-align:right;\"> 0.63 </td>\n   <td style=\"text-align:right;\"> 0.63 </td>\n   <td style=\"text-align:right;\"> 0.63 </td>\n   <td style=\"text-align:right;\"> 0.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 3/15 </td>\n   <td style=\"text-align:right;\"> -0.33 </td>\n   <td style=\"text-align:right;\"> -0.06 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 9/16 </td>\n   <td style=\"text-align:right;\"> -0.93 </td>\n   <td style=\"text-align:right;\"> -0.39 </td>\n   <td style=\"text-align:right;\"> -0.05 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 4/8 </td>\n   <td style=\"text-align:right;\"> -1.33 </td>\n   <td style=\"text-align:right;\"> -1.19 </td>\n   <td style=\"text-align:right;\"> -0.87 </td>\n   <td style=\"text-align:right;\"> -0.67 </td>\n   <td style=\"text-align:right;\"> -0.58 </td>\n   <td style=\"text-align:right;\"> -0.54 </td>\n   <td style=\"text-align:right;\"> -0.51 </td>\n   <td style=\"text-align:right;\"> -0.50 </td>\n   <td style=\"text-align:right;\"> -0.50 </td>\n   <td style=\"text-align:right;\"> -0.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 4/7 </td>\n   <td style=\"text-align:right;\"> -0.47 </td>\n   <td style=\"text-align:right;\"> -0.65 </td>\n   <td style=\"text-align:right;\"> -0.81 </td>\n   <td style=\"text-align:right;\"> -0.91 </td>\n   <td style=\"text-align:right;\"> -0.96 </td>\n   <td style=\"text-align:right;\"> -0.99 </td>\n   <td style=\"text-align:right;\"> -1.01 </td>\n   <td style=\"text-align:right;\"> -1.01 </td>\n   <td style=\"text-align:right;\"> -1.02 </td>\n   <td style=\"text-align:right;\"> -1.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 6/10 </td>\n   <td style=\"text-align:right;\"> -0.13 </td>\n   <td style=\"text-align:right;\"> -0.47 </td>\n   <td style=\"text-align:right;\"> -0.80 </td>\n   <td style=\"text-align:right;\"> -0.97 </td>\n   <td style=\"text-align:right;\"> -1.05 </td>\n   <td style=\"text-align:right;\"> -1.09 </td>\n   <td style=\"text-align:right;\"> -1.10 </td>\n   <td style=\"text-align:right;\"> -1.11 </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 11/21 </td>\n   <td style=\"text-align:right;\"> 0.90 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> -0.56 </td>\n   <td style=\"text-align:right;\"> -0.91 </td>\n   <td style=\"text-align:right;\"> -1.05 </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n   <td style=\"text-align:right;\"> -1.15 </td>\n   <td style=\"text-align:right;\"> -1.16 </td>\n   <td style=\"text-align:right;\"> -1.17 </td>\n   <td style=\"text-align:right;\"> -1.18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 8/3 </td>\n   <td style=\"text-align:right;\"> 0.90 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> -0.56 </td>\n   <td style=\"text-align:right;\"> -0.91 </td>\n   <td style=\"text-align:right;\"> -1.05 </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n   <td style=\"text-align:right;\"> -1.15 </td>\n   <td style=\"text-align:right;\"> -1.16 </td>\n   <td style=\"text-align:right;\"> -1.17 </td>\n   <td style=\"text-align:right;\"> -1.18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2/23 </td>\n   <td style=\"text-align:right;\"> -1.93 </td>\n   <td style=\"text-align:right;\"> -2.45 </td>\n   <td style=\"text-align:right;\"> -2.15 </td>\n   <td style=\"text-align:right;\"> -1.76 </td>\n   <td style=\"text-align:right;\"> -1.51 </td>\n   <td style=\"text-align:right;\"> -1.38 </td>\n   <td style=\"text-align:right;\"> -1.30 </td>\n   <td style=\"text-align:right;\"> -1.27 </td>\n   <td style=\"text-align:right;\"> -1.25 </td>\n   <td style=\"text-align:right;\"> -1.24 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup>*</sup> Scores normalized to unit variance.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\nWe can see in @tbl-ref that in higher order reflections, the scores have converged to a steady value. Some of persons/groups receive big positive scores, while others receive negative scores, suggestive of strong differentiation in HH reflective scores for the *SW* data. \n\nA neat way to visualize data like that in @tbl-ref is using a **bump chart**. We can do this in `R` using the program [ggbump](https://r-graph-gallery.com/package/ggbump.html). First, we need to transform the data in @tbl-ref to \"long\" format. We use `dplyr` and `tidyr` to do that:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    library(dplyr)\n    library(tidyr)\n     HH.p.long <- data.frame(HH.p) %>% \n          mutate(person = rownames(HH.p)) %>% \n          pivot_longer(\n               cols = 1:10,\n               names_to = \"Ref\",\n               values_to = \"k\"\n          ) %>%\n       mutate(Ref = factor(Ref, ordered = TRUE, levels = colnames(HH.p))) \n    head(HH.p.long)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  person Ref         k\n  <chr>  <ord>   <dbl>\n1 EVELYN Ref_2  -0.799\n2 EVELYN Ref_4  -0.580\n3 EVELYN Ref_6  -0.178\n4 EVELYN Ref_8   0.585\n5 EVELYN Ref_10  1.02 \n6 EVELYN Ref_12  1.11 \n```\n:::\n\n```{.r .cell-code}\n     HH.g.long <- data.frame(HH.g) %>% \n          mutate(group = rownames(HH.g)) %>% \n          pivot_longer(\n               cols = 1:10,\n               names_to = \"Ref\",\n               values_to = \"k\"\n          ) %>%\n       mutate(Ref = factor(Ref, ordered = TRUE, levels = colnames(HH.g))) \n    head(HH.g.long)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  group Ref        k\n  <chr> <ord>  <dbl>\n1 6/27  Ref_2   1.24\n2 6/27  Ref_4   1.24\n3 6/27  Ref_6   1.17\n4 6/27  Ref_8   1.14\n5 6/27  Ref_10  1.13\n6 6/27  Ref_12  1.13\n```\n:::\n:::\n\n\nNow we can plot the persons and groups in their reflective score trajectory across the even reflections. The result looks like @fig-refs.\n\n\n::: {#fig-refs .cell layout-ncol=\"1\"}\n::: {.cell-output-display}\n![Persons](tm-reflections_files/figure-html/fig-refs-1.png){#fig-refs-1 width=1152}\n:::\n\n::: {.cell-output-display}\n![Groups](tm-reflections_files/figure-html/fig-refs-2.png){#fig-refs-2 width=1152}\n:::\n\nReflections\n:::\n\n\nAs @fig-refs-1 shows, *\\{Dorothy\\}* begins pretty high on the list according to the second reflection (the average size of the groups she belongs to is big) but loses that advantage as we move to further reflections, ending up closer to the bottom of the middle. Meanwhile, *\\{Charlotte, Brenda\\}* begin with pretty low scores on the second reflection, but end up at the top by the 20th. \n\nAs @fig-refs-2 shows, there's less volatility across reflections in the group ranks, but there is still some non-trivial reshuffling by the end. \n\n## The Method of Reflections as Correspondence Analysis\n\nAs @vandam_etal21 show, it turns out that the equilibrium scores computed by the method of reflections are none other than our old friend **Correspondence Analysis**! Let's see how this works. \n\nIf you recall [from the CA for two-mode networks lecture notes](tm-ca.qmd), in a two-mode network the first dimension of the CA scores (for persons) are equivalent to the second eigenvector of a matrix $\\mathbf{W}$ which is obtained from the information in the biadjacency matrix $\\mathbf{A}$ like this:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    W.p <- diag(1/rowSums(A)) %*% A %*% diag(1/colSums(A)) %*% t(A)\n```\n:::\n\n\nAnd we get the (real part of the) second eigenvector for the matrix like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    ca.p <- Re(eigen(W.p)$vectors[, 2])\n    ca.p\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] -0.24086413 -0.25389472 -0.19699941 -0.25768209 -0.29332258 -0.24023748\n [7] -0.15396144 -0.01170823 -0.05064337  0.13065696  0.24914639  0.31499509\n[13]  0.26300900  0.26263739  0.24339931  0.09130661  0.33019362  0.33019362\n```\n:::\n:::\n\n\nFor groups, the relevant CA matrix `W.g` is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    W.g <- diag(1/colSums(A)) %*% t(A) %*% diag(1/rowSums(A)) %*% A\n```\n:::\n\n\nAnd we get the second eigenvector of *that* matrix:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    ca.g <- Re(eigen(W.p)$vectors[, 2])\n    ca.g\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] -0.24086413 -0.25389472 -0.19699941 -0.25768209 -0.29332258 -0.24023748\n [7] -0.15396144 -0.01170823 -0.05064337  0.13065696  0.24914639  0.31499509\n[13]  0.26300900  0.26263739  0.24339931  0.09130661  0.33019362  0.33019362\n```\n:::\n:::\n\n\nAnd we can see that these scores are perfectly correlated with the equilibrium reflection scores:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n    abs(round(cor(ca.p, HH.p[, 10]), 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1\n```\n:::\n\n```{.r .cell-code}\n    abs(round(cor(ca.g, HH.p[, 10]), 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1\n```\n:::\n:::\n",
    "supporting": [
      "tm-reflections_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}