<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Extracting the Backbone of Bipartite Projections Using Graph Ensembles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Extracting the Backbone of Bipartite Projections Using Graph Ensembles">
<meta property="og:description" content="Recall from our lecture on two-mode networks that a common approach to analyzing them is what Everett and Borgatti (2013) call the “dual projection” approach.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Extracting the Backbone of Bipartite Projections Using Graph Ensembles</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centrality.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-mode.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige-two-mode.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link active">Extracting the Backbone of Bipartite Projections Using Graph Ensembles</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat1.html" class="sidebar-item-text sidebar-link">Statistical Models of Networks I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat2.html" class="sidebar-item-text sidebar-link">Statistical Models of Networks II</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat3.html" class="sidebar-item-text sidebar-link">Statistical Models of Networks III</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Handouts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-problem-with-bipartite-projections" id="toc-the-problem-with-bipartite-projections" class="nav-link active" data-scroll-target="#the-problem-with-bipartite-projections">The Problem with Bipartite Projections</a></li>
  <li><a href="#the-stochastic-degree-sequence-model" id="toc-the-stochastic-degree-sequence-model" class="nav-link" data-scroll-target="#the-stochastic-degree-sequence-model">The Stochastic Degree Sequence Model</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/backbone.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Extracting the Backbone of Bipartite Projections Using Graph Ensembles</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="the-problem-with-bipartite-projections" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-with-bipartite-projections">The Problem with Bipartite Projections</h2>
<p>Recall from our lecture on <a href="./two-mode.html">two-mode networks</a> that a common approach to analyzing them is what <span class="citation" data-cites="everett_borgatti13">Everett and Borgatti (<a href="#ref-everett_borgatti13" role="doc-biblioref">2013</a>)</span> call the “dual projection” approach. This involves computing the row and column object projections from the original affiliation matrix due to <span class="citation" data-cites="breiger74">Breiger (<a href="#ref-breiger74" role="doc-biblioref">1974</a>)</span>. Nevertheless, one issue with this approach is that the result is a weighted network, which can be hard to analyze using our usual tools.</p>
<p>Moreover, because just sharing a single membership (member) will create a connection between any two persons (groups) in the row (column) projection, the resulting weighted graphs are dense and usually lack meaningful or interesting structure. Thus, a common task is to try to prune and binarize bipartite projections. Zak <span class="citation" data-cites="neal14">Neal (<a href="#ref-neal14" role="doc-biblioref">2014</a>)</span> refers to this problem as extracting the <strong>backbone</strong> of the bipartite projection.</p>
<p>So let’s load up our trusty <em>Southern Women</em> data set and compute the bipartite projections:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   g <span class="ot">&lt;-</span> southern_women</span>
<span id="cb1-4"><a href="#cb1-4"></a>   Proj <span class="ot">&lt;-</span> <span class="fu">bipartite_projection</span>(g)</span>
<span id="cb1-5"><a href="#cb1-5"></a>   G.p <span class="ot">&lt;-</span> Proj[[<span class="dv">1</span>]]</span>
<span id="cb1-6"><a href="#cb1-6"></a>   G.g <span class="ot">&lt;-</span> Proj[[<span class="dv">2</span>]]</span>
<span id="cb1-7"><a href="#cb1-7"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_biadjacency_matrix</span>(g))</span>
<span id="cb1-8"><a href="#cb1-8"></a>   P <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(G.p, <span class="at">attr =</span> <span class="st">"weight"</span>))</span>
<span id="cb1-9"><a href="#cb1-9"></a>   G <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(G.g, <span class="at">attr =</span> <span class="st">"weight"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recall that <span class="math inline">\(\mathbf{A}\)</span> is the rectangular <strong>affiliation matrix</strong> recording adjacency relations between persons and groups, <span class="math inline">\(\mathbf{P}\)</span> is the weighted row projection between people, where the weight between pairs of people is the number of common memberships they share, and <span class="math inline">\(\mathbf{G}\)</span> is the weighted column projection between groups, where the weight between pairs of groups is the number of common members they share.</p>
<p>The <span class="math inline">\(\mathbf{P}\)</span> matrix looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   P</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL RUTH
EVELYN         0     6       7      6         3       4       3     3    3
LAURA          6     0       6      6         3       4       4     2    3
THERESA        7     6       0      6         4       4       4     3    4
BRENDA         6     6       6      0         4       4       4     2    3
CHARLOTTE      3     3       4      4         0       2       2     0    2
FRANCES        4     4       4      4         2       0       3     2    2
ELEANOR        3     4       4      4         2       3       0     2    3
PEARL          3     2       3      2         0       2       2     0    2
RUTH           3     3       4      3         2       2       3     2    0
VERNE          2     2       3      2         1       1       2     2    3
MYRNA          2     1       2      1         0       1       1     2    2
KATHERINE      2     1       2      1         0       1       1     2    2
SYLVIA         2     2       3      2         1       1       2     2    3
NORA           2     2       3      2         1       1       2     2    2
HELEN          1     2       2      2         1       1       2     1    2
DOROTHY        2     1       2      1         0       1       1     2    2
OLIVIA         1     0       1      0         0       0       0     1    1
FLORA          1     0       1      0         0       0       0     1    1
          VERNE MYRNA KATHERINE SYLVIA NORA HELEN DOROTHY OLIVIA FLORA
EVELYN        2     2         2      2    2     1       2      1     1
LAURA         2     1         1      2    2     2       1      0     0
THERESA       3     2         2      3    3     2       2      1     1
BRENDA        2     1         1      2    2     2       1      0     0
CHARLOTTE     1     0         0      1    1     1       0      0     0
FRANCES       1     1         1      1    1     1       1      0     0
ELEANOR       2     1         1      2    2     2       1      0     0
PEARL         2     2         2      2    2     1       2      1     1
RUTH          3     2         2      3    2     2       2      1     1
VERNE         0     3         3      4    3     3       2      1     1
MYRNA         3     0         4      4    3     3       2      1     1
KATHERINE     3     4         0      6    5     3       2      1     1
SYLVIA        4     4         6      0    6     4       2      1     1
NORA          3     3         5      6    0     4       1      2     2
HELEN         3     3         3      4    4     0       1      1     1
DOROTHY       2     2         2      2    1     1       0      1     1
OLIVIA        1     1         1      1    2     1       1      0     2
FLORA         1     1         1      1    2     1       1      2     0</code></pre>
</div>
</div>
<p>And the <span class="math inline">\(\mathbf{G}\)</span> matrix looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>   G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
6/27     0   2    3    2    3    3    2    3   1    0    0   0     0   0
3/2      2   0    3    2    3    3    2    3   2    0    0   0     0   0
4/12     3   3    0    4    6    5    4    5   2    0    0   0     0   0
9/26     2   2    4    0    4    3    3    3   2    0    0   0     0   0
2/25     3   3    6    4    0    6    6    7   3    0    0   0     0   0
5/19     3   3    5    3    6    0    5    7   4    1    1   1     1   1
3/15     2   2    4    3    6    5    0    8   5    3    2   4     2   2
9/16     3   3    5    3    7    7    8    0   9    4    1   5     2   2
4/8      1   2    2    2    3    4    5    9   0    4    3   5     3   3
6/10     0   0    0    0    0    1    3    4   4    0    2   5     3   3
2/23     0   0    0    0    0    1    2    1   3    2    0   2     1   1
4/7      0   0    0    0    0    1    4    5   5    5    2   0     3   3
11/21    0   0    0    0    0    1    2    2   3    3    1   3     0   3
8/3      0   0    0    0    0    1    2    2   3    3    1   3     3   0</code></pre>
</div>
</div>
<p>Now, our job is to binarize these matrices by retaining adjacency relations between nodes whose weights is significantly larger than we would expect given a suitable null model. This is a situation perfectly tailored for graph ensembles!</p>
</section>
<section id="the-stochastic-degree-sequence-model" class="level2">
<h2 class="anchored" data-anchor-id="the-stochastic-degree-sequence-model">The Stochastic Degree Sequence Model</h2>
<p><span class="citation" data-cites="neal14">Neal (<a href="#ref-neal14" role="doc-biblioref">2014</a>)</span> proposes one such approach called the <strong>Stochastic Degree Sequence Model</strong> (SDSM). This approach compares the observed weights in each bipartite projection against those from a bipartite graph ensemble where the graphs in the ensemble are generated from a model that preserves the expected (average) degrees of the nodes in the two-mode network.</p>
<p>We proceed as follows. First, we estimate a generalized linear model for binary outcomes (e.g., logit or probit, or your favorite other), where we predict the probability of observing an edge in the bipartite graph from the degrees of each node incident to each edge (and their statistical interaction). In <code>R</code> we can do this as follows. First, we create a dataset with the affiliation matrix as a response variable and the degrees of each node as coviarates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(A) <span class="co">#vectorized affiliation matrix</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>   d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">rowSums</span>(A), <span class="fu">ncol</span>(A))) <span class="co">#person degree vector</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>   d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">colSums</span>(A), <span class="at">each =</span> <span class="fu">nrow</span>(A))) <span class="co">#group degree vector</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>   dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, d1, d2) <span class="co">#data frame</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>   dat[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, ] <span class="co">#first 25 rows of data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   y d1 d2
1  1  8  3
2  1  7  3
3  0  8  3
4  1  7  3
5  0  4  3
6  0  4  3
7  0  4  3
8  0  3  3
9  0  4  3
10 0  4  3
11 0  4  3
12 0  6  3
13 0  7  3
14 0  8  3
15 0  5  3
16 0  2  3
17 0  2  3
18 0  2  3
19 1  8  3
20 1  7  3
21 1  8  3
22 0  7  3
23 0  4  3
24 0  4  3
25 0  4  3</code></pre>
</div>
</div>
<p>Then we estimate a logit regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   mylogit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> d1<span class="sc">*</span>d2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>   <span class="fu">summary</span>(mylogit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ d1 * d2, family = "binomial", data = dat)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -5.84765    1.09104  -5.360 8.34e-08 ***
d1           0.63010    0.17902   3.520 0.000432 ***
d2           0.45908    0.12876   3.565 0.000363 ***
d1:d2       -0.03279    0.02286  -1.434 0.151482    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 327.29  on 251  degrees of freedom
Residual deviance: 254.55  on 248  degrees of freedom
AIC: 262.55

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Then we compute the predicted probabilities for each case:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>   mypreds <span class="ot">&lt;-</span> <span class="fu">predict</span>(mylogit, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>   <span class="fu">round</span>(mypreds[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>], <span class="dv">2</span>) <span class="co">#first 25 predictions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
0.45 0.32 0.45 0.32 0.09 0.09 0.09 0.05 0.09 0.09 0.09 0.22 0.32 0.45 0.14 0.03 
  17   18   19   20   21   22   23   24   25 
0.03 0.03 0.45 0.32 0.45 0.32 0.09 0.09 0.09 </code></pre>
</div>
</div>
<p>Now, we use these predicted probabilities to generate an ensemble of graphs, where each edge in the graph is a Bernoulli draw from the predicted probability response vector. We can do this using the following function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>   bipart.ensemble <span class="ot">&lt;-</span> <span class="cf">function</span>(x, r, c) {</span>
<span id="cb12-2"><a href="#cb12-2"></a>      A <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x <span class="sc">&gt;</span> <span class="fu">runif</span>(<span class="fu">length</span>(x)))</span>
<span id="cb12-3"><a href="#cb12-3"></a>      A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(A, <span class="at">nrow =</span> r, <span class="at">ncol =</span> c)</span>
<span id="cb12-4"><a href="#cb12-4"></a>      <span class="fu">return</span>(A)</span>
<span id="cb12-5"><a href="#cb12-5"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above function uses the <code>runif</code> function in <code>R</code> to compare each predicted probability to a random number between zero and one, and then creates a new affiliation matrix that has a one in each cell if the predicted probability is larger than the corresponding random number.</p>
<p>Let’s see how this works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>   A1 <span class="ot">&lt;-</span> <span class="fu">bipart.ensemble</span>(mypreds, <span class="at">r =</span> <span class="fu">nrow</span>(A), <span class="at">c =</span> <span class="fu">ncol</span>(A))</span>
<span id="cb13-3"><a href="#cb13-3"></a>   <span class="fu">rownames</span>(A1) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb13-4"><a href="#cb13-4"></a>   <span class="fu">colnames</span>(A1) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb13-5"><a href="#cb13-5"></a>   A1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       1   1    0    0    0    1    1    1   0    0    0   1     1   1
LAURA        0   0    1    1    1    0    1    1   1    1    1   0     0   0
THERESA      1   0    1    1    1    1    0    1   1    1    0   1     0   1
BRENDA       0   0    1    0    1    0    1    1   1    0    1   0     0   0
CHARLOTTE    0   0    1    0    0    1    1    1   1    0    0   0     0   0
FRANCES      1   0    0    0    0    1    0    0   0    0    0   0     0   0
ELEANOR      0   0    0    0    0    0    0    1   0    0    0   0     0   0
PEARL        0   0    0    0    1    1    1    1   1    0    0   0     0   0
RUTH         0   0    1    0    1    0    0    1   1    0    0   0     1   0
VERNE        0   0    1    0    0    0    0    1   1    0    0   0     0   0
MYRNA        0   0    0    0    0    0    0    0   1    0    0   1     0   0
KATHERINE    0   1    0    0    0    1    1    1   1    0    0   1     0   0
SYLVIA       0   0    1    0    1    1    1    0   1    0    0   1     0   0
NORA         0   0    0    0    1    0    1    1   1    0    0   1     0   0
HELEN        1   0    1    0    0    0    1    1   1    0    0   1     0   0
DOROTHY      0   0    0    0    0    0    1    1   1    0    0   0     0   0
OLIVIA       0   1    0    0    0    0    0    1   1    0    0   1     0   0
FLORA        0   0    0    0    1    0    0    1   1    0    0   0     0   0</code></pre>
</div>
</div>
<p>Which generates an affiliation matrix realization from the predicted probabilities we calculated before, with the probability of each edge being a function of the degrees of each node in the original affiliation matrix. Now all we need to do is produce a bunch of these using the <code>replicate</code> function in <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   <span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>   B <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>, <span class="fu">bipart.ensemble</span>(mypreds, <span class="at">r =</span> <span class="fu">nrow</span>(A), <span class="at">c =</span> <span class="fu">ncol</span>(A)), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then create a bunch of person projections from these matrices using <code>lapply</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>   P.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(B, <span class="cf">function</span>(x) {x <span class="sc">%*%</span> <span class="fu">t</span>(x)}) <span class="co">#ensemble of row projections</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And a bunch of group projections:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   G.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(B, <span class="cf">function</span>(x) {<span class="fu">t</span>(x) <span class="sc">%*%</span> x}) <span class="co">#ensemble of column projections</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we generate a list of binary projections where two nodes are tied when their observed weight in the row or column projections is larger than the corresponding weight in the generated projections:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>   P.bin <span class="ot">&lt;-</span> <span class="fu">lapply</span>(P.list, <span class="cf">function</span>(x) {(P <span class="sc">&gt;</span> x) <span class="sc">*</span> <span class="dv">1</span>})</span>
<span id="cb18-2"><a href="#cb18-2"></a>   G.bin <span class="ot">&lt;-</span> <span class="fu">lapply</span>(G.list, <span class="cf">function</span>(x) {(G <span class="sc">&gt;</span> x) <span class="sc">*</span> <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now add all of the matrices in each list to count the number of times the observed value is larger than the expected value. We use the trusty <code>R</code> function <code>Reduce</code> with the <code>"+"</code> operator to do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   P.exp <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, P.bin)</span>
<span id="cb19-2"><a href="#cb19-2"></a>   G.exp <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, G.bin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The “p-value” for each edge weight in the row and column projections is just one minus the cells of this matrix divided by the number of graphs in the ensemble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   P.sig <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> P.exp<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>   G.sig <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> G.exp<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>   P.sig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL RUTH
EVELYN      1.00  0.30    0.19   0.29      0.47    0.21    0.52  0.33 0.56
LAURA       0.30  1.00    0.25   0.14      0.40    0.14    0.17  0.61 0.45
THERESA     0.19  0.25    1.00   0.24      0.22    0.18    0.22  0.42 0.19
BRENDA      0.29  0.14    0.24   1.00      0.19    0.14    0.14  0.67 0.46
CHARLOTTE   0.47  0.40    0.22   0.19      1.00    0.50    0.52  1.00 0.51
FRANCES     0.21  0.14    0.18   0.14      0.50    1.00    0.16  0.44 0.47
ELEANOR     0.52  0.17    0.22   0.14      0.52    0.16    1.00  0.47 0.20
PEARL       0.33  0.61    0.42   0.67      1.00    0.44    0.47  1.00 0.42
RUTH        0.56  0.45    0.19   0.46      0.51    0.47    0.20  0.42 1.00
VERNE       0.76  0.74    0.53   0.73      0.87    0.82    0.51  0.45 0.16
MYRNA       0.84  0.98    0.83   0.96      1.00    0.92    0.89  0.48 0.53
KATHERINE   0.96  0.98    0.97   1.00      1.00    0.93    0.94  0.57 0.67
SYLVIA      0.98  0.93    0.91   0.96      0.97    0.94    0.77  0.63 0.44
NORA        1.00  0.99    0.96   1.00      0.96    0.95    0.84  0.76 0.76
HELEN       0.99  0.91    0.93   0.86      0.88    0.93    0.59  0.86 0.57
DOROTHY     0.67  0.93    0.67   0.93      1.00    0.79    0.83  0.40 0.45
OLIVIA      0.91  1.00    0.95   1.00      1.00    1.00    1.00  0.74 0.79
FLORA       0.90  1.00    0.94   1.00      1.00    1.00    1.00  0.81 0.83
          VERNE MYRNA KATHERINE SYLVIA NORA HELEN DOROTHY OLIVIA FLORA
EVELYN     0.76  0.84      0.96   0.98 1.00  0.99    0.67   0.91  0.90
LAURA      0.74  0.98      0.98   0.93 0.99  0.91    0.93   1.00  1.00
THERESA    0.53  0.83      0.97   0.91 0.96  0.93    0.67   0.95  0.94
BRENDA     0.73  0.96      1.00   0.96 1.00  0.86    0.93   1.00  1.00
CHARLOTTE  0.87  1.00      1.00   0.97 0.96  0.88    1.00   1.00  1.00
FRANCES    0.82  0.92      0.93   0.94 0.95  0.93    0.79   1.00  1.00
ELEANOR    0.51  0.89      0.94   0.77 0.84  0.59    0.83   1.00  1.00
PEARL      0.45  0.48      0.57   0.63 0.76  0.86    0.40   0.74  0.81
RUTH       0.16  0.53      0.67   0.44 0.76  0.57    0.45   0.79  0.83
VERNE      1.00  0.14      0.32   0.14 0.45  0.27    0.43   0.77  0.87
MYRNA      0.14  1.00      0.10   0.17 0.56  0.25    0.46   0.80  0.83
KATHERINE  0.32  0.10      1.00   0.05 0.28  0.47    0.52   0.83  0.85
SYLVIA     0.14  0.17      0.05   1.00 0.22  0.30    0.61   0.85  0.90
NORA       0.45  0.56      0.28   0.22 1.00  0.35    0.89   0.60  0.61
HELEN      0.27  0.25      0.47   0.30 0.35  1.00    0.83   0.87  0.88
DOROTHY    0.43  0.46      0.52   0.61 0.89  0.83    1.00   0.73  0.78
OLIVIA     0.77  0.80      0.83   0.85 0.60  0.87    0.73   1.00  0.34
FLORA      0.87  0.83      0.85   0.90 0.61  0.88    0.78   0.34  1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   G.sig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      6/27  3/2 4/12 9/26 2/25 5/19 3/15 9/16  4/8 6/10 2/23  4/7 11/21  8/3
6/27  1.00 0.37 0.18 0.34 0.32 0.29 0.65 0.57 0.95 1.00 1.00 1.00  1.00 1.00
3/2   0.37 1.00 0.17 0.47 0.36 0.32 0.72 0.63 0.81 1.00 1.00 1.00  1.00 1.00
4/12  0.18 0.17 1.00 0.09 0.02 0.10 0.50 0.43 0.99 1.00 1.00 1.00  1.00 1.00
9/26  0.34 0.47 0.09 1.00 0.18 0.39 0.50 0.71 0.87 1.00 1.00 1.00  1.00 1.00
2/25  0.32 0.36 0.02 0.18 1.00 0.08 0.30 0.43 0.96 1.00 1.00 1.00  1.00 1.00
5/19  0.29 0.32 0.10 0.39 0.08 1.00 0.49 0.41 0.86 0.93 0.96 0.95  0.93 0.87
3/15  0.65 0.72 0.50 0.50 0.30 0.49 1.00 0.60 0.90 0.61 0.79 0.43  0.72 0.68
9/16  0.57 0.63 0.43 0.71 0.43 0.41 0.60 1.00 0.80 0.53 0.98 0.44  0.89 0.79
4/8   0.95 0.81 0.99 0.87 0.96 0.86 0.90 0.80 1.00 0.55 0.61 0.34  0.52 0.42
6/10  1.00 1.00 1.00 1.00 1.00 0.93 0.61 0.53 0.55 1.00 0.46 0.00  0.17 0.17
2/23  1.00 1.00 1.00 1.00 1.00 0.96 0.79 0.98 0.61 0.46 1.00 0.54  0.72 0.75
4/7   1.00 1.00 1.00 1.00 1.00 0.95 0.43 0.44 0.34 0.00 0.54 1.00  0.19 0.15
11/21 1.00 1.00 1.00 1.00 1.00 0.93 0.72 0.89 0.52 0.17 0.72 0.19  1.00 0.03
8/3   1.00 1.00 1.00 1.00 1.00 0.87 0.68 0.79 0.42 0.17 0.75 0.15  0.03 1.00</code></pre>
</div>
</div>
<p>We then connect two nodes in the backbone, when this value is below some standard threshold (e.g., <span class="math inline">\(p &lt; 0.25\)</span>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   P.back <span class="ot">&lt;-</span> (P.sig <span class="sc">&lt;</span> <span class="fl">0.25</span>) <span class="sc">*</span> <span class="dv">1</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>   G.back <span class="ot">&lt;-</span> (G.sig <span class="sc">&lt;</span> <span class="fl">0.25</span>) <span class="sc">*</span> <span class="dv">1</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>   P.back</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL RUTH
EVELYN         0     0       1      0         0       1       0     0    0
LAURA          0     0       0      1         0       1       1     0    0
THERESA        1     0       0      1         1       1       1     0    1
BRENDA         0     1       1      0         1       1       1     0    0
CHARLOTTE      0     0       1      1         0       0       0     0    0
FRANCES        1     1       1      1         0       0       1     0    0
ELEANOR        0     1       1      1         0       1       0     0    1
PEARL          0     0       0      0         0       0       0     0    0
RUTH           0     0       1      0         0       0       1     0    0
VERNE          0     0       0      0         0       0       0     0    1
MYRNA          0     0       0      0         0       0       0     0    0
KATHERINE      0     0       0      0         0       0       0     0    0
SYLVIA         0     0       0      0         0       0       0     0    0
NORA           0     0       0      0         0       0       0     0    0
HELEN          0     0       0      0         0       0       0     0    0
DOROTHY        0     0       0      0         0       0       0     0    0
OLIVIA         0     0       0      0         0       0       0     0    0
FLORA          0     0       0      0         0       0       0     0    0
          VERNE MYRNA KATHERINE SYLVIA NORA HELEN DOROTHY OLIVIA FLORA
EVELYN        0     0         0      0    0     0       0      0     0
LAURA         0     0         0      0    0     0       0      0     0
THERESA       0     0         0      0    0     0       0      0     0
BRENDA        0     0         0      0    0     0       0      0     0
CHARLOTTE     0     0         0      0    0     0       0      0     0
FRANCES       0     0         0      0    0     0       0      0     0
ELEANOR       0     0         0      0    0     0       0      0     0
PEARL         0     0         0      0    0     0       0      0     0
RUTH          1     0         0      0    0     0       0      0     0
VERNE         0     1         0      1    0     0       0      0     0
MYRNA         1     0         1      1    0     0       0      0     0
KATHERINE     0     1         0      1    0     0       0      0     0
SYLVIA        1     1         1      0    1     0       0      0     0
NORA          0     0         0      1    0     0       0      0     0
HELEN         0     0         0      0    0     0       0      0     0
DOROTHY       0     0         0      0    0     0       0      0     0
OLIVIA        0     0         0      0    0     0       0      0     0
FLORA         0     0         0      0    0     0       0      0     0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>   G.back</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
6/27     0   0    1    0    0    0    0    0   0    0    0   0     0   0
3/2      0   0    1    0    0    0    0    0   0    0    0   0     0   0
4/12     1   1    0    1    1    1    0    0   0    0    0   0     0   0
9/26     0   0    1    0    1    0    0    0   0    0    0   0     0   0
2/25     0   0    1    1    0    1    0    0   0    0    0   0     0   0
5/19     0   0    1    0    1    0    0    0   0    0    0   0     0   0
3/15     0   0    0    0    0    0    0    0   0    0    0   0     0   0
9/16     0   0    0    0    0    0    0    0   0    0    0   0     0   0
4/8      0   0    0    0    0    0    0    0   0    0    0   0     0   0
6/10     0   0    0    0    0    0    0    0   0    0    0   1     1   1
2/23     0   0    0    0    0    0    0    0   0    0    0   0     0   0
4/7      0   0    0    0    0    0    0    0   0    1    0   0     1   1
11/21    0   0    0    0    0    0    0    0   0    1    0   1     0   1
8/3      0   0    0    0    0    0    0    0   0    1    0   1     1   0</code></pre>
</div>
</div>
<p>And we can now plot the backbones:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>   <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>   G.p <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(P.back, <span class="at">mode =</span> <span class="st">"undirected"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>   <span class="fu">plot</span>(G.p, </span>
<span id="cb28-4"><a href="#cb28-4"></a>     <span class="at">vertex.size=</span><span class="dv">8</span>, <span class="at">vertex.frame.color=</span><span class="st">"lightgray"</span>, </span>
<span id="cb28-5"><a href="#cb28-5"></a>     <span class="at">vertex.label.dist=</span><span class="dv">2</span>, <span class="at">edge.curved=</span><span class="fl">0.2</span>, <span class="at">edge.width =</span> <span class="dv">2</span>,</span>
<span id="cb28-6"><a href="#cb28-6"></a>     <span class="at">vertex.label.cex =</span> <span class="fl">1.25</span>, <span class="at">edge.color =</span> <span class="st">"lightgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="backbone_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1152"></p>
<p></p><figcaption class="figure-caption">One mode backbone of people using the SDSM.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>   <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>   G.g <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(G.back, <span class="at">mode =</span> <span class="st">"undirected"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>   <span class="fu">plot</span>(G.g, </span>
<span id="cb29-4"><a href="#cb29-4"></a>     <span class="at">vertex.size=</span><span class="dv">8</span>, <span class="at">vertex.frame.color=</span><span class="st">"lightgray"</span>, </span>
<span id="cb29-5"><a href="#cb29-5"></a>     <span class="at">vertex.label.dist=</span><span class="dv">2</span>, <span class="at">edge.curved=</span><span class="fl">0.2</span>, <span class="at">edge.width =</span> <span class="dv">2</span>,</span>
<span id="cb29-6"><a href="#cb29-6"></a>     <span class="at">vertex.label.cex =</span> <span class="fl">1.25</span>, <span class="at">edge.color =</span> <span class="st">"lightgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="backbone_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1152"></p>
<p></p><figcaption class="figure-caption">One mode backbone of groups using the SDSM.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can put together all of the above steps into a handy dandy function called <code>sdsm.back</code> which takes the affiliation matrix <span class="math inline">\(\mathbf{A}\)</span> as input and returns the two projection backbones as output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>   sdsm.back <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">p.val =</span> <span class="fl">0.25</span>, <span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>      <span class="fu">set.seed</span>(seed)</span>
<span id="cb30-3"><a href="#cb30-3"></a>      r <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb30-4"><a href="#cb30-4"></a>      c <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb30-5"><a href="#cb30-5"></a>      P <span class="ot">&lt;-</span> A <span class="sc">%*%</span> <span class="fu">t</span>(A) <span class="co">#row projection</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>      G <span class="ot">&lt;-</span> <span class="fu">t</span>(A) <span class="sc">%*%</span> A <span class="co">#column projection</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>      y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(A) <span class="co">#vectorized affiliation matrix</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>      d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">rowSums</span>(A), <span class="fu">ncol</span>(A))) <span class="co">#person degree vector</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>      d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">colSums</span>(A), <span class="at">each =</span> <span class="fu">nrow</span>(A))) <span class="co">#group degree vector</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>      dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, d1, d2) <span class="co">#data frame</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>      res <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> d1<span class="sc">*</span>d2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb30-12"><a href="#cb30-12"></a>      pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(res, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb30-13"><a href="#cb30-13"></a>      gen.aff <span class="ot">&lt;-</span> <span class="cf">function</span>(w) {</span>
<span id="cb30-14"><a href="#cb30-14"></a>         <span class="fu">return</span>(<span class="fu">matrix</span>(<span class="fu">as.numeric</span>(w <span class="sc">&gt;</span> <span class="fu">runif</span>(<span class="fu">length</span>(w))), <span class="at">nrow =</span> r, <span class="at">ncol =</span> c))    </span>
<span id="cb30-15"><a href="#cb30-15"></a>         }</span>
<span id="cb30-16"><a href="#cb30-16"></a>      B <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n, <span class="fu">gen.aff</span>(pred), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-17"><a href="#cb30-17"></a>      P.bin <span class="ot">&lt;-</span> <span class="fu">lapply</span>(B, <span class="cf">function</span>(x) {(P <span class="sc">&gt;</span> x <span class="sc">%*%</span> <span class="fu">t</span>(x)) <span class="sc">*</span> <span class="dv">1</span>})</span>
<span id="cb30-18"><a href="#cb30-18"></a>      G.bin <span class="ot">&lt;-</span> <span class="fu">lapply</span>(B, <span class="cf">function</span>(x) {(G <span class="sc">&gt;</span> <span class="fu">t</span>(x) <span class="sc">%*%</span> x) <span class="sc">*</span> <span class="dv">1</span>})</span>
<span id="cb30-19"><a href="#cb30-19"></a>      P.back <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, P.bin)<span class="sc">/</span>n) <span class="sc">&lt;</span> p.val) <span class="sc">*</span> <span class="dv">1</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>      G.back <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">Reduce</span>(<span class="st">"+"</span>, G.bin)<span class="sc">/</span>n) <span class="sc">&lt;</span> p.val) <span class="sc">*</span> <span class="dv">1</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">P.back =</span> P.back, <span class="at">G.back =</span> G.back))</span>
<span id="cb30-22"><a href="#cb30-22"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And voila:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>   <span class="fu">sdsm.back</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$P.back
          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL RUTH
EVELYN         0     0       0      0         0       0       0     0    0
LAURA          0     0       1      1         0       1       1     0    0
THERESA        0     1       0      1         1       0       0     0    0
BRENDA         0     1       1      0         1       1       1     0    0
CHARLOTTE      0     0       1      1         0       0       0     0    0
FRANCES        0     1       0      1         0       0       1     0    0
ELEANOR        0     1       0      1         0       1       0     0    1
PEARL          0     0       0      0         0       0       0     0    0
RUTH           0     0       0      0         0       0       1     0    0
VERNE          0     0       0      0         0       0       0     0    1
MYRNA          0     0       0      0         0       0       0     0    0
KATHERINE      0     0       0      0         0       0       0     0    0
SYLVIA         0     0       0      0         0       0       0     0    0
NORA           0     0       0      0         0       0       0     0    0
HELEN          0     0       0      0         0       0       0     0    0
DOROTHY        0     0       0      0         0       0       0     0    0
OLIVIA         0     0       0      0         0       0       0     0    0
FLORA          0     0       0      0         0       0       0     0    0
          VERNE MYRNA KATHERINE SYLVIA NORA HELEN DOROTHY OLIVIA FLORA
EVELYN        0     0         0      0    0     0       0      0     0
LAURA         0     0         0      0    0     0       0      0     0
THERESA       0     0         0      0    0     0       0      0     0
BRENDA        0     0         0      0    0     0       0      0     0
CHARLOTTE     0     0         0      0    0     0       0      0     0
FRANCES       0     0         0      0    0     0       0      0     0
ELEANOR       0     0         0      0    0     0       0      0     0
PEARL         0     0         0      0    0     0       0      0     0
RUTH          1     0         0      0    0     0       0      0     0
VERNE         0     1         0      1    0     0       0      0     0
MYRNA         1     0         1      1    0     1       0      0     0
KATHERINE     0     1         0      1    0     0       0      0     0
SYLVIA        1     1         1      0    0     1       0      0     0
NORA          0     0         0      0    0     0       0      0     0
HELEN         0     1         0      1    0     0       0      0     0
DOROTHY       0     0         0      0    0     0       0      0     0
OLIVIA        0     0         0      0    0     0       0      0     1
FLORA         0     0         0      0    0     0       0      1     0

$G.back
      6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
6/27     0   0    1    0    0    0    0    0   0    0    0   0     0   0
3/2      0   0    1    0    0    0    0    0   0    0    0   0     0   0
4/12     1   1    0    1    1    1    0    0   0    0    0   0     0   0
9/26     0   0    1    0    1    0    0    0   0    0    0   0     0   0
2/25     0   0    1    1    0    1    0    0   0    0    0   0     0   0
5/19     0   0    1    0    1    0    0    0   0    0    0   0     0   0
3/15     0   0    0    0    0    0    0    0   0    0    0   0     0   0
9/16     0   0    0    0    0    0    0    0   0    0    0   0     0   0
4/8      0   0    0    0    0    0    0    0   0    0    0   0     0   0
6/10     0   0    0    0    0    0    0    0   0    0    0   1     1   1
2/23     0   0    0    0    0    0    0    0   0    0    0   0     0   0
4/7      0   0    0    0    0    0    0    0   0    1    0   0     1   1
11/21    0   0    0    0    0    0    0    0   0    1    0   1     0   1
8/3      0   0    0    0    0    0    0    0   0    1    0   1     1   0</code></pre>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-breiger74" class="csl-entry" role="doc-biblioentry">
Breiger, Ronald L. 1974. <span>“The Duality of Persons and Groups.”</span> <em>Social Forces</em> 53 (2): 181–90.
</div>
<div id="ref-everett_borgatti13" class="csl-entry" role="doc-biblioentry">
Everett, Martin G, and Stephen P Borgatti. 2013. <span>“The Dual-Projection Approach for Two-Mode Networks.”</span> <em>Social Networks</em> 35 (2): 204–10.
</div>
<div id="ref-neal14" class="csl-entry" role="doc-biblioentry">
Neal, Zachary. 2014. <span>“The Backbone of Bipartite Projections: Inferring Relationships from Co-Authorship, Co-Sponsorship, Co-Attendance and Other Co-Behaviors.”</span> <em>Social Networks</em> 39: 84–97.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>