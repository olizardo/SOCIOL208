<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Graph Ensembles in Two-Mode Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Graph Ensembles in Two-Mode Networks">
<meta property="og:description" content="As we saw in the graph ensemble lesson, there are many approaches to randomizing the structure of one-mode networks when the aim is to create graph ensembles preserving selected properties.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Graph Ensembles in Two-Mode Networks</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">The Eigendecomposition of a Square Matrix</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Centrality and Prestige</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centrality.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Centrality Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Equivalence and Similarity</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-walk.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Communities and Clustering</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Two-Mode Networks</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-basic.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-centrality.html" class="sidebar-item-text sidebar-link">Centrality in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-duality.html" class="sidebar-item-text sidebar-link">The Duality of Persons and Groups</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-similarity.html" class="sidebar-item-text sidebar-link">Similarity and Equivalence in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-community-ca.html" class="sidebar-item-text sidebar-link">Community Detection in Two-Mode Networks Using CA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-spectral.html" class="sidebar-item-text sidebar-link">Spectral Clustering of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-fitness.html" class="sidebar-item-text sidebar-link">Fitness and Complexity in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-null.html" class="sidebar-item-text sidebar-link active">Graph Ensembles in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link">Extracting the Backbone of Bipartite Projections Using Two-Mode Graph Ensembles</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Data Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loading.html" class="sidebar-item-text sidebar-link">Loading Network Data from a File</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-lists.html" class="sidebar-item-text sidebar-link">Handling Graph Objects in Lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subgraph-select.html" class="sidebar-item-text sidebar-link">Selecting a Subgraph Based on Edge Conditions</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#two-mode-erdos-renyi-model" id="toc-two-mode-erdos-renyi-model" class="nav-link active" data-scroll-target="#two-mode-erdos-renyi-model">Two-Mode Erdos-Renyi Model</a></li>
  <li><a href="#fixed-degree-models" id="toc-fixed-degree-models" class="nav-link" data-scroll-target="#fixed-degree-models">Fixed Degree Models</a>
  <ul class="collapse">
  <li><a href="#fixing-row-degrees" id="toc-fixing-row-degrees" class="nav-link" data-scroll-target="#fixing-row-degrees">Fixing Row Degrees</a></li>
  <li><a href="#fixing-column-degrees" id="toc-fixing-column-degrees" class="nav-link" data-scroll-target="#fixing-column-degrees">Fixing Column Degrees</a></li>
  <li><a href="#fixing-row-and-column-degrees" id="toc-fixing-row-and-column-degrees" class="nav-link" data-scroll-target="#fixing-row-and-column-degrees">Fixing Row and Column Degrees</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/tm-null.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Graph Ensembles in Two-Mode Networks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As we saw in the <a href="./swap.html">graph ensemble lesson</a>, there are many approaches to randomizing the structure of one-mode networks when the aim is to create <strong>graph ensembles</strong> preserving selected properties. These ensembles, in turn, can be used to do <strong>null hypothesis testing</strong> in networks.</p>
<p>Not surprisingly, a similar suite of techniques exist for the two-mode case, but until recently various approaches were scattered (and reduplicated) across a bunch of literatures in social network analysis, ecology, network physics, and computer science <span class="citation" data-cites="neal_etal24">(<a href="#ref-neal_etal24" role="doc-biblioref">Neal et al. 2024</a>)</span>.</p>
<section id="two-mode-erdos-renyi-model" class="level2">
<h2 class="anchored" data-anchor-id="two-mode-erdos-renyi-model">Two-Mode Erdos-Renyi Model</h2>
<p>Like with one-mode networks, the simplest null model for two-mode networks is one that preserves the number of nodes and the number of edges. This model, like we saw in the one-mode network case, also preserves anything that is a function of these two-quantities. In the two-mode case, this is the bipartite graph’s <strong>density</strong> and the average degrees of the nodes in each mode (recall that two-mode networks <a href="./tm-basic.html">have two average degrees</a>). This is thus a two-mode version of the <strong>Erdos-Renyi</strong> null model.</p>
<p>Let’s load up the <em>Southern Women</em> (SW) data and see how it works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   A <span class="ot">&lt;-</span> <span class="fu">as_biadjacency_matrix</span>(southern_women)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s compute some <a href="./tm-basic.html">basic two-mode network statistics</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   d <span class="ot">&lt;-</span> <span class="fu">sum</span>(A)<span class="sc">/</span>(<span class="fu">nrow</span>(A)<span class="sc">*</span><span class="fu">ncol</span>(A)) <span class="co">#density</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>   ad.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(A)) <span class="co">#average degree of people</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>   ad.g <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">colSums</span>(A)) <span class="co">#average degree of groups</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>   d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3531746</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>   ad.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.944444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   ad.g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.357143</code></pre>
</div>
</div>
<p>We can see that the density of the SW network is <span class="math inline">\(d=\)</span> 0.35, the average degree of people <span class="math inline">\(\bar{k_p}=\)</span> 4.94 and the average degree of groups <span class="math inline">\(\bar{k_g}=\)</span> 6.36.</p>
<p>Now, let’s compute something on this network, like the <strong>degree correlation</strong> between people and groups, answering the question: Do people with lots of memberships tend to join larger groups?</p>
<p>We already know the answer to this question for the SW data from the <a href="./tm-basic.html">two-mode network analysis lecture notes</a>, which is negative. In this network people with a lot of memberships connect to smaller groups.</p>
<p>Here’s a version of that function that takes the biadjacency matrix as input, creates the bipartite matrix from it and returns the two-mode degree correlation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   tm.deg.corr <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>      B <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb8-3"><a href="#cb8-3"></a>                  <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(x), <span class="at">ncol =</span> <span class="fu">nrow</span>(x)), x),</span>
<span id="cb8-4"><a href="#cb8-4"></a>                  <span class="fu">cbind</span>(<span class="fu">t</span>(x), <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(x), <span class="at">ncol =</span> <span class="fu">ncol</span>(x)))</span>
<span id="cb8-5"><a href="#cb8-5"></a>                  ) <span class="co">#creating bipartite matrix</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>      d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">e =</span> <span class="fu">as.vector</span>(B), </span>
<span id="cb8-7"><a href="#cb8-7"></a>                      <span class="at">rd =</span> <span class="fu">rep</span>(<span class="fu">rowSums</span>(B), <span class="fu">ncol</span>(B)), </span>
<span id="cb8-8"><a href="#cb8-8"></a>                      <span class="at">cd =</span> <span class="fu">rep</span>(<span class="fu">colSums</span>(B), <span class="at">each =</span> <span class="fu">nrow</span>(B))</span>
<span id="cb8-9"><a href="#cb8-9"></a>                      )</span>
<span id="cb8-10"><a href="#cb8-10"></a>      <span class="fu">return</span>(<span class="fu">cor</span>(d[d<span class="sc">$</span>e <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span>rd, d[d<span class="sc">$</span>e <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span>cd))</span>
<span id="cb8-11"><a href="#cb8-11"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>   <span class="fu">tm.deg.corr</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3369979</code></pre>
</div>
</div>
<p>Which is the same number we got before.</p>
<p>Now let’s see how we can generate an Erdos-Renyi two-mode network with a specified number of edges. A simple approach goes like this:</p>
<p>First, let’s create a vectorized version of the adjacency matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>   v.a <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(A)</span>
<span id="cb11-2"><a href="#cb11-2"></a>   v.a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
 [38] 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1
 [75] 1 1 1 1 1 0 1 0 0 0 0 0 0 0 0 0 1 1 1 1 0 1 1 1 0 0 0 0 0 1 0 0 0 0 0 1 1
[112] 1 1 0 1 0 1 1 0 0 1 1 1 0 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 1 0
[149] 0 0 0 1 1 1 1 1 1 1 0 1 1 1 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0
[186] 0 0 0 0 0 0 0 0 1 1 0 1 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0
[223] 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0</code></pre>
</div>
</div>
<p>These are just the biadjacency matrix entries stretched out into a long vector of length equal to the number of rows multiplied by the number of columns of the matrix (18 <span class="math inline">\(\times\)</span> 14 <span class="math inline">\(=\)</span> 252).</p>
<p>Then we just reshuffle the values of this vector by reassigning vector positions across the entire length of the vector at random:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   v.shuff <span class="ot">&lt;-</span> v.a[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(v.a))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can just generate a new biadjacency matrix <code>A.perm</code> from the reshuffled vector <code>v.shuff</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   A.perm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(v.shuff, <span class="at">nrow =</span> <span class="fu">nrow</span>(A)) <span class="co">#creating permuted biadjacency matrix</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>   <span class="fu">rownames</span>(A.perm) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb14-3"><a href="#cb14-3"></a>   <span class="fu">colnames</span>(A.perm) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb14-4"><a href="#cb14-4"></a>   A.perm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       0   0    0    1    0    0    0    0   0    1    0   0     1   1
LAURA        1   0    1    0    0    1    0    0   0    0    0   0     0   1
THERESA      1   0    0    1    1    0    1    0   0    0    0   1     0   0
BRENDA       1   0    0    0    0    1    0    0   0    0    0   0     0   1
CHARLOTTE    1   0    0    0    0    0    0    1   0    0    0   1     0   1
FRANCES      1   1    0    1    1    0    0    0   1    0    0   0     1   1
ELEANOR      1   0    0    0    0    0    0    0   0    1    0   1     1   0
PEARL        0   0    0    1    1    0    1    0   0    0    0   1     0   1
RUTH         0   0    1    0    0    1    0    1   1    0    1   0     1   1
VERNE        1   1    1    1    0    0    0    0   0    0    0   1     1   1
MYRNA        1   0    0    0    0    0    0    0   0    1    1   0     0   0
KATHERINE    0   0    1    0    1    0    0    1   0    0    0   0     0   0
SYLVIA       0   0    1    0    0    0    0    1   1    0    1   0     0   0
NORA         0   0    1    0    0    1    1    0   1    0    0   1     1   0
HELEN        0   0    1    1    0    0    0    1   1    1    1   1     1   1
DOROTHY      0   0    0    1    0    0    0    1   0    0    0   0     1   1
OLIVIA       1   0    1    0    0    1    0    1   0    0    0   0     1   1
FLORA        1   0    0    0    0    1    0    0   0    0    0   0     1   1</code></pre>
</div>
</div>
<p>We can verify that <code>A.perm</code> has the same basic network statistics as <code>A</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>   d <span class="ot">&lt;-</span> <span class="fu">sum</span>(A.perm)<span class="sc">/</span>(<span class="fu">nrow</span>(A.perm)<span class="sc">*</span><span class="fu">ncol</span>(A.perm)) <span class="co">#density</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>   ad.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(A.perm)) <span class="co">#average degree of people</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>   ad.g <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">colSums</span>(A.perm)) <span class="co">#average degree of groups</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>   d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3531746</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>   ad.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.944444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   ad.g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.357143</code></pre>
</div>
</div>
<p>But <em>not</em> the same degree distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   <span class="fu">rowSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   <span class="fu">rowSums</span>(A.perm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        4         4         5         3         4         7         4         5 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        7         7         3         3         4         6         9         4 
   OLIVIA     FLORA 
        6         4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>   <span class="fu">colSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>   <span class="fu">colSums</span>(A.perm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
   10     2     8     7     4     6     3     7     5     4     4     7    10 
  8/3 
   12 </code></pre>
</div>
</div>
<p>We can now package the two-mode permutation steps into a function called <code>tm.perm</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>   tm.perm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>      w <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">as.vector</span>(x)[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(v.a))], <span class="at">nrow =</span> <span class="fu">nrow</span>(x))</span>
<span id="cb30-3"><a href="#cb30-3"></a>      <span class="fu">rownames</span>(w) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(x)</span>
<span id="cb30-4"><a href="#cb30-4"></a>      <span class="fu">colnames</span>(w) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(x)</span>
<span id="cb30-5"><a href="#cb30-5"></a>      <span class="fu">return</span>(w)</span>
<span id="cb30-6"><a href="#cb30-6"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And generate a 500 strong two-mode Erdos-Renyi graph ensemble for the SW data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>   <span class="fu">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>   G <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>, <span class="fu">tm.perm</span>(A), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now <code>sapply</code> the <code>tm.deg.corr</code> function from before across our ensemble to get 500 degree correlations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>   corrs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(G, tm.deg.corr)</span>
<span id="cb32-2"><a href="#cb32-2"></a>   corrs[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="co">#first hundred entries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] -0.344356903 -0.134295344 -0.133596070 -0.267644558 -0.171674275
  [6] -0.275663672 -0.283254133 -0.193806406 -0.337994690 -0.212437024
 [11] -0.257590223 -0.118158698 -0.242565641 -0.166337214 -0.173132238
 [16] -0.274868693 -0.217969624 -0.216451292 -0.291344341 -0.283195324
 [21] -0.207689408 -0.248837917 -0.198871612 -0.240695741 -0.221265615
 [26] -0.185705284 -0.289478802 -0.159541270 -0.171820823 -0.186560960
 [31] -0.215368270 -0.254480771 -0.177874085 -0.151141815 -0.289125269
 [36] -0.224790425 -0.201960650 -0.270071352 -0.116296228 -0.185726631
 [41] -0.303763988 -0.259510523 -0.218542183 -0.112107029 -0.243725759
 [46] -0.005737813 -0.198127012 -0.229914646 -0.204889016 -0.079508887
 [51]  0.027440505 -0.202949007 -0.218607373 -0.025492884 -0.133046441
 [56] -0.160869565 -0.185500601 -0.213562420 -0.155718555 -0.250021152
 [61] -0.053023663 -0.137790380 -0.236702431 -0.248327843 -0.131984233
 [66] -0.205270847 -0.198270225 -0.235000000 -0.286357283 -0.144811901
 [71] -0.294190720 -0.203126837 -0.116331339 -0.253407599 -0.191774271
 [76] -0.145264282 -0.202891718 -0.184967788 -0.141816921 -0.149469250
 [81] -0.218688180 -0.218279156 -0.012786560 -0.197629515 -0.148183895
 [86] -0.138678154 -0.277539621 -0.266943121 -0.304491726 -0.118560460
 [91] -0.129700324  0.004097715 -0.252852092 -0.239662227 -0.264175504
 [96] -0.219322074 -0.201478868 -0.206365547 -0.296350444 -0.136214570</code></pre>
</div>
</div>
<p>So let’s see how our observed value stacks up in the grand scheme:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>   <span class="fu">library</span>(ggplot2)</span>
<span id="cb34-2"><a href="#cb34-2"></a>   p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(corrs, <span class="dv">2</span>)), <span class="fu">aes</span>(<span class="at">x =</span> corrs))</span>
<span id="cb34-3"><a href="#cb34-3"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.015</span>, <span class="at">stat =</span> <span class="st">"bin"</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">tm.deg.corr</span>(A), </span>
<span id="cb34-5"><a href="#cb34-5"></a>                       <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>)</span>
<span id="cb34-6"><a href="#cb34-6"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">1</span>, </span>
<span id="cb34-7"><a href="#cb34-7"></a>                       <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>)</span>
<span id="cb34-8"><a href="#cb34-8"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Q by Level"</span>, <span class="at">y =</span> <span class="st">"Freq."</span>)</span>
<span id="cb34-9"><a href="#cb34-9"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb34-10"><a href="#cb34-10"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="sc">-</span><span class="fl">0.04</span>, <span class="at">y=</span><span class="dv">45</span>, <span class="at">label=</span> <span class="st">"Zero Point"</span>, <span class="at">color =</span> <span class="st">"purple"</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y=</span><span class="dv">45</span>, <span class="at">label=</span> <span class="st">"Obs. Value"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb34-12"><a href="#cb34-12"></a>   p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-null_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It looks like our observed value is close to the tail end of the negative spectrum, suggesting it is statistically improbable to have been obvserved by chance. We can compute the value that corresponds to the 1st percentile of the assortativity distribution from the ensemble and then see if what observe is below that value (<span class="math inline">\(p &lt; 0.01\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>   <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1% 
-0.3587599 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>   <span class="fu">tm.deg.corr</span>(A) <span class="sc">&lt;</span> <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1% 
FALSE </code></pre>
</div>
</div>
<p>Whoops. Looks like the observed value is not extreme enough using a <span class="math inline">\(p &lt;0.01\)</span> criterion of statistical significance. Let’s try a less stringent one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>   <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        5% 
-0.3141873 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>   <span class="fu">tm.deg.corr</span>(A) <span class="sc">&lt;</span> <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  5% 
TRUE </code></pre>
</div>
</div>
<p>Aha! A test of the hypothesis that the observed value is smaller than the value at the 95th percentile of the distribution of values in this null graph ensemble returns a positive answer, suggesting that degree anti-correlation is present in the SW data, at statistically significant levels, net of density.</p>
<p>As before, if we wanted a more stringent <strong>two-tailed test</strong> we would need to create a vector with the <em>absolute value</em> of the two-mode degree correlation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>   <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(corrs))(<span class="fu">abs</span>(<span class="fu">tm.deg.corr</span>(A)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.032</code></pre>
</div>
</div>
<p>Which is still statistically significant at conventional levels (<span class="math inline">\(p &lt;0.05\)</span>).</p>
</section>
<section id="fixed-degree-models" class="level2">
<h2 class="anchored" data-anchor-id="fixed-degree-models">Fixed Degree Models</h2>
<p>As we already noted, the two-mode Erdos-Renyi model fixes the number of edges (and thus the density and average degrees) in the network, but does not preserve the original degree distributions. We might want to test our hypotheses by using a two-mode graph ensemble that “controls for” the node degrees.</p>
<p>How do we do that? One complication is that we have two sets of degrees so we have more options than in the one mode case. We can fix the row (person) degree, or the column (group) degree or <em>both</em> degrees.</p>
<p>Let’s begin with the simplest case, in which we fix <em>either</em> the row or column degree but not both.</p>
<section id="fixing-row-degrees" class="level3">
<h3 class="anchored" data-anchor-id="fixing-row-degrees">Fixing Row Degrees</h3>
<p>To fix the row degrees, we need to randomize the entries in each row of the biadjacency matrix, while preserving the number of ones in that row. One way to do this is to write a function that takes an observed row of the matrix, randomizes it and then substitutes it for the observed row:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>   rand.row <span class="ot">&lt;-</span> <span class="cf">function</span>(r) {</span>
<span id="cb45-2"><a href="#cb45-2"></a>      <span class="fu">return</span>(r[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(r))])</span>
<span id="cb45-3"><a href="#cb45-3"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can just <code>apply</code> the <code>rand.row</code> function to each row of the biadjacency matrix <code>A</code> to generate a new matrix <code>A.r</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>   A.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(A, <span class="dv">1</span>, rand.row)</span>
<span id="cb46-2"><a href="#cb46-2"></a>   A.r <span class="ot">&lt;-</span> <span class="fu">t</span>(A.r)</span>
<span id="cb46-3"><a href="#cb46-3"></a>   <span class="fu">rownames</span>(A.r) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb46-4"><a href="#cb46-4"></a>   <span class="fu">colnames</span>(A.r) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s the original matrix <code>A</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>   A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       1   1    1    1    1    1    0    1   1    0    0   0     0   0
LAURA        1   1    1    0    1    1    1    1   0    0    0   0     0   0
THERESA      0   1    1    1    1    1    1    1   1    0    0   0     0   0
BRENDA       1   0    1    1    1    1    1    1   0    0    0   0     0   0
CHARLOTTE    0   0    1    1    1    0    1    0   0    0    0   0     0   0
FRANCES      0   0    1    0    1    1    0    1   0    0    0   0     0   0
ELEANOR      0   0    0    0    1    1    1    1   0    0    0   0     0   0
PEARL        0   0    0    0    0    1    0    1   1    0    0   0     0   0
RUTH         0   0    0    0    1    0    1    1   1    0    0   0     0   0
VERNE        0   0    0    0    0    0    1    1   1    0    0   1     0   0
MYRNA        0   0    0    0    0    0    0    1   1    1    0   1     0   0
KATHERINE    0   0    0    0    0    0    0    1   1    1    0   1     1   1
SYLVIA       0   0    0    0    0    0    1    1   1    1    0   1     1   1
NORA         0   0    0    0    0    1    1    0   1    1    1   1     1   1
HELEN        0   0    0    0    0    0    1    1   0    1    1   1     0   0
DOROTHY      0   0    0    0    0    0    0    1   1    0    0   0     0   0
OLIVIA       0   0    0    0    0    0    0    0   1    0    1   0     0   0
FLORA        0   0    0    0    0    0    0    0   1    0    1   0     0   0</code></pre>
</div>
</div>
<p>And the reshuffled matrix <code>A.r</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>   A.r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       1   0    0    1    0    1    1    1   1    0    1   0     0   1
LAURA        0   0    1    1    1    0    0    0   1    0    1   1     0   1
THERESA      1   0    1    0    0    1    0    1   1    0    1   1     0   1
BRENDA       0   1    1    0    1    0    1    0   0    1    0   0     1   1
CHARLOTTE    0   0    1    0    0    0    0    0   1    1    1   0     0   0
FRANCES      0   1    0    1    0    0    1    1   0    0    0   0     0   0
ELEANOR      0   0    0    0    0    0    1    0   0    1    1   0     0   1
PEARL        0   0    0    0    1    0    0    0   1    1    0   0     0   0
RUTH         0   0    0    0    0    1    0    1   0    1    0   0     0   1
VERNE        0   0    0    0    1    1    0    1   0    0    0   0     1   0
MYRNA        1   1    0    0    0    0    1    1   0    0    0   0     0   0
KATHERINE    0   1    1    0    0    1    0    0   0    0    1   0     1   1
SYLVIA       1   0    0    0    1    0    0    1   1    1    1   0     0   1
NORA         1   1    0    1    1    1    0    1   0    1    0   0     1   0
HELEN        0   0    1    0    1    1    0    0   0    1    0   0     0   1
DOROTHY      1   0    0    0    0    0    0    0   0    1    0   0     0   0
OLIVIA       0   1    0    0    0    0    0    0   0    1    0   0     0   0
FLORA        0   0    0    0    0    0    0    0   0    0    0   1     0   1</code></pre>
</div>
</div>
<p>Note that the new matrix <code>A.r</code> preserves the person degrees of the original:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>   <span class="fu">rowSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>   <span class="fu">rowSums</span>(A.r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
</div>
<p>But not the group degrees, because each person’s memberships are randomly distributed across groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>   <span class="fu">colSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>   <span class="fu">colSums</span>(A.r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    6     6     6     4     7     7     5     8     6    10     7     3     4 
  8/3 
   10 </code></pre>
</div>
</div>
<p>All the other lower order statistics like density are preserved:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>   <span class="fu">sum</span>(A.r)<span class="sc">/</span>(<span class="fu">nrow</span>(A.r)<span class="sc">*</span><span class="fu">ncol</span>(A.r))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3531746</code></pre>
</div>
</div>
<p>Now we package everything into a function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>   fix.deg <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">mode =</span> <span class="dv">1</span>) {</span>
<span id="cb61-2"><a href="#cb61-2"></a>      w <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, mode, <span class="cf">function</span>(r) {r[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(r))]})</span>
<span id="cb61-3"><a href="#cb61-3"></a>      <span class="cf">if</span> (mode <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb61-4"><a href="#cb61-4"></a>         w <span class="ot">&lt;-</span> <span class="fu">t</span>(w)</span>
<span id="cb61-5"><a href="#cb61-5"></a>         }</span>
<span id="cb61-6"><a href="#cb61-6"></a>      <span class="fu">rownames</span>(w) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(x)</span>
<span id="cb61-7"><a href="#cb61-7"></a>      <span class="fu">colnames</span>(w) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(x)</span>
<span id="cb61-8"><a href="#cb61-8"></a>      <span class="fu">return</span>(w)</span>
<span id="cb61-9"><a href="#cb61-9"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then generate a graph ensemble of reshuffled matrices that preserve the person degrees, and compute our degree correlations in that set of networks:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>   <span class="fu">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>   G <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>, <span class="fu">fix.deg</span>(A), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>   corrs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(G, tm.deg.corr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s compute the degree correlations across this ensemble and see how our observed value stacks up in the grand scheme:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="tm-null_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking pretty good! Let’s check the p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>   <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        5% 
-0.2756015 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>   <span class="fu">tm.deg.corr</span>(A) <span class="sc">&lt;</span> <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  5% 
TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>   <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(corrs))(<span class="fu">abs</span>(<span class="fu">tm.deg.corr</span>(A)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.016</code></pre>
</div>
</div>
<p>Neat! Our result can continue to be defended at the <span class="math inline">\(p &lt; 0.05\)</span> level. Still a chance of getting published.</p>
</section>
<section id="fixing-column-degrees" class="level3">
<h3 class="anchored" data-anchor-id="fixing-column-degrees">Fixing Column Degrees</h3>
<p>We can fix the column degrees using the same <code>fix.deg</code> function as earlier, but this time, we just change the <code>mode</code> argument to equal <code>2</code>, to <code>apply</code> the function to the columns and not the rows of the matrix <code>A</code>.</p>
<p>For instance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>   A.c <span class="ot">&lt;-</span> <span class="fu">fix.deg</span>(A, <span class="at">mode =</span> <span class="dv">2</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a>   A.c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       0   1    0    1    1    1    1    0   1    0    1   1     0   0
LAURA        0   0    1    0    0    0    1    1   1    0    0   0     0   0
THERESA      0   1    0    1    1    0    0    1   1    1    0   0     0   0
BRENDA       0   0    1    0    0    1    0    1   0    0    1   1     1   0
CHARLOTTE    0   0    0    0    0    1    0    1   1    0    0   0     0   0
FRANCES      0   1    0    0    1    0    1    1   1    1    0   0     1   0
ELEANOR      0   0    0    0    0    0    1    0   0    1    1   0     0   0
PEARL        0   0    0    0    0    0    0    0   1    1    0   0     0   0
RUTH         0   0    0    0    1    0    0    1   1    0    0   0     0   0
VERNE        1   0    1    0    1    1    1    1   1    0    0   1     0   1
MYRNA        0   0    1    0    1    1    1    1   0    0    0   0     0   0
KATHERINE    1   0    0    1    0    0    1    1   1    0    0   1     1   0
SYLVIA       0   0    0    0    1    0    1    1   1    1    0   0     0   0
NORA         1   0    1    0    1    0    1    1   0    0    0   0     0   0
HELEN        0   0    0    0    0    1    0    1   1    0    0   1     0   1
DOROTHY      0   0    0    0    0    1    0    0   0    0    1   0     0   0
OLIVIA       0   0    0    0    0    1    1    1   1    0    0   0     0   0
FLORA        0   0    1    1    0    0    0    1   0    0    0   1     0   1</code></pre>
</div>
</div>
<p>Which generates a reshuffled adjacency matrix that preserves the group degrees:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>   <span class="fu">colSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>   <span class="fu">colSums</span>(A.c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
</div>
<p>But <em>not</em> the person degrees:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>   <span class="fu">rowSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>   <span class="fu">rowSums</span>(A.c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         4         6         6         3         7         3         2 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        3         9         5         7         5         5         5         2 
   OLIVIA     FLORA 
        4         5 </code></pre>
</div>
</div>
<p>And now we test our hypothesis that there is degree anti-correlation in the SW data on an ensemble of graphs with fixed group degrees:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>   <span class="fu">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a>   G <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>, <span class="fu">fix.deg</span>(A, <span class="at">mode =</span> <span class="dv">2</span>), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a>   corrs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(G, tm.deg.corr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see how things look:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="tm-null_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Uh oh, adjusting for group degrees seems to have made our conclusions a bit more shaky. All of the estimated degree correlations are negative (below zero) and our observed value does not seem to be as extreme as before.</p>
<p>Let’ see what the p-values say:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>   <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        5% 
-0.3316684 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>   <span class="fu">tm.deg.corr</span>(A) <span class="sc">&lt;</span> <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  5% 
TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>   <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(corrs))(<span class="fu">abs</span>(<span class="fu">tm.deg.corr</span>(A)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.036</code></pre>
</div>
</div>
<p>Still significant at <span class="math inline">\(p &lt; 0.05\)</span>!</p>
<p>Regardless, it is clear that our earlier conclusions from the Erdos-Renyi model were a bit too optimistic. What happens when we try to fix <em>both</em> the row and column degrees?</p>
</section>
<section id="fixing-row-and-column-degrees" class="level3">
<h3 class="anchored" data-anchor-id="fixing-row-and-column-degrees">Fixing Row and Column Degrees</h3>
<p>To fix row and column degrees, we play a swapping game. At each round, we select two random persons <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. Each person collects their memberships and calculates the memberships they have that the other person does not have (and vice versa). Thus, <span class="math inline">\(a\)</span> has a set of memberships that <span class="math inline">\(b\)</span> does not have, and <span class="math inline">\(b\)</span> has a set of memberships that <span class="math inline">\(a\)</span> does not have. Then they trade memberships <span class="math inline">\(n\)</span> times where <span class="math inline">\(n\)</span> is a number between zero and the minimum of the size of the two sets of memberships that the other person does not have. We repeat this trading game for <span class="math inline">\(k\)</span> number of times.</p>
<p>Below is a function called <code>make.swap</code> that implements this algorithm, called “curveball” <span class="citation" data-cites="neal_etal24">(<a href="#ref-neal_etal24" role="doc-biblioref">Neal et al. 2024</a>)</span>. The function takes the biadjacency matrix as input and repeats the swapping process described above 100 times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>   make.swap <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">k =</span> <span class="dv">100</span>) {</span>
<span id="cb86-2"><a href="#cb86-2"></a>      z <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#initializing counter</span></span>
<span id="cb86-3"><a href="#cb86-3"></a>      <span class="cf">while</span>(z <span class="sc">&lt;=</span> k) {</span>
<span id="cb86-4"><a href="#cb86-4"></a>         n <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rownames</span>(x), <span class="dv">2</span>) <span class="co">#sampling two people at random</span></span>
<span id="cb86-5"><a href="#cb86-5"></a>         a <span class="ot">&lt;-</span> n[<span class="dv">1</span>] <span class="co">#person a</span></span>
<span id="cb86-6"><a href="#cb86-6"></a>         b <span class="ot">&lt;-</span> n[<span class="dv">2</span>] <span class="co">#person b</span></span>
<span id="cb86-7"><a href="#cb86-7"></a>         a.m <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(x[a, ] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#person a's memberships</span></span>
<span id="cb86-8"><a href="#cb86-8"></a>         b.m <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(x[b, ] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#person b's memberships</span></span>
<span id="cb86-9"><a href="#cb86-9"></a>         ab <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(a.m, b.m) <span class="co">#memberships that a has that b does not</span></span>
<span id="cb86-10"><a href="#cb86-10"></a>         ba <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(b.m, a.m) <span class="co">#memberships that b has that a does not</span></span>
<span id="cb86-11"><a href="#cb86-11"></a>         w <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(ab), <span class="fu">length</span>(ba)), <span class="at">size =</span> <span class="dv">1</span>) <span class="co">#number of rounds of trade</span></span>
<span id="cb86-12"><a href="#cb86-12"></a>         <span class="cf">if</span> (w <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb86-13"><a href="#cb86-13"></a>            <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>w) {</span>
<span id="cb86-14"><a href="#cb86-14"></a>               ab.m <span class="ot">&lt;-</span> <span class="fu">sample</span>(ab, <span class="dv">1</span>) <span class="co">#membership that a will transfer to b</span></span>
<span id="cb86-15"><a href="#cb86-15"></a>               ba.m <span class="ot">&lt;-</span> <span class="fu">sample</span>(ba, <span class="dv">1</span>) <span class="co">#membership that b will transfer to a</span></span>
<span id="cb86-16"><a href="#cb86-16"></a>               x[a, ab.m] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#a loses membership</span></span>
<span id="cb86-17"><a href="#cb86-17"></a>               x[b, ab.m] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#b gains membership</span></span>
<span id="cb86-18"><a href="#cb86-18"></a>               x[b, ba.m] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#b loses membership</span></span>
<span id="cb86-19"><a href="#cb86-19"></a>               x[a, ba.m] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#a gains membership</span></span>
<span id="cb86-20"><a href="#cb86-20"></a>               a.m <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(x[a, ] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#updating a's memberships</span></span>
<span id="cb86-21"><a href="#cb86-21"></a>               b.m <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(x[b, ] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#updating b's memberships</span></span>
<span id="cb86-22"><a href="#cb86-22"></a>               ab <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(a.m, b.m) <span class="co">#updating differences between a and b's memberships</span></span>
<span id="cb86-23"><a href="#cb86-23"></a>               ba <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(b.m, a.m) <span class="co">#updating differences between b and a's memberships</span></span>
<span id="cb86-24"><a href="#cb86-24"></a>               }</span>
<span id="cb86-25"><a href="#cb86-25"></a>            }</span>
<span id="cb86-26"><a href="#cb86-26"></a>         z <span class="ot">&lt;-</span> z <span class="sc">+</span> <span class="dv">1</span> <span class="co">#incrementing counter</span></span>
<span id="cb86-27"><a href="#cb86-27"></a>         }</span>
<span id="cb86-28"><a href="#cb86-28"></a>      <span class="fu">return</span>(x)</span>
<span id="cb86-29"><a href="#cb86-29"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>   A.s <span class="ot">&lt;-</span> <span class="fu">make.swap</span>(A)</span>
<span id="cb87-2"><a href="#cb87-2"></a>   A.s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       0   0    1    0    0    0    1    1   1    0    1   1     1   1
LAURA        0   1    1    0    1    1    0    1   1    0    0   1     0   0
THERESA      1   0    0    1    0    1    1    1   1    1    0   0     1   0
BRENDA       0   0    1    0    0    1    1    1   1    1    1   0     0   0
CHARLOTTE    0   1    0    0    0    0    1    1   0    0    0   0     0   1
FRANCES      0   0    1    0    1    1    0    0   1    0    0   0     0   0
ELEANOR      0   0    0    0    1    0    1    1   1    0    0   0     0   0
PEARL        0   0    0    0    0    0    1    0   1    0    0   1     0   0
RUTH         0   0    0    1    1    0    1    1   0    0    0   0     0   0
VERNE        1   0    0    0    0    0    0    1   0    0    0   1     0   1
MYRNA        0   0    0    0    0    1    1    1   0    1    0   0     0   0
KATHERINE    0   0    1    1    0    1    1    1   1    0    0   0     0   0
SYLVIA       0   1    1    0    1    1    0    0   1    0    1   0     1   0
NORA         1   0    0    1    1    0    1    1   1    1    0   1     0   0
HELEN        0   0    0    0    1    0    0    1   1    1    0   1     0   0
DOROTHY      0   0    0    0    1    0    0    0   1    0    0   0     0   0
OLIVIA       0   0    0    0    0    0    0    1   0    0    1   0     0   0
FLORA        0   0    0    0    0    1    0    1   0    0    0   0     0   0</code></pre>
</div>
</div>
<p>We can see that while the specifc entries of the swapped biadjacency matrix <code>A.s</code> are different from those of the original matrix <code>A</code> both the row and column degrees are preserved:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>   <span class="fu">rowSums</span>(A.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>   <span class="fu">rowSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>   <span class="fu">colSums</span>(A.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>   <span class="fu">colSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
</div>
<p>And now we create our graph ensemble with fixed row <em>and</em> column degrees, and test our degree anti-correlation hypothesis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>   <span class="fu">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb97-2"><a href="#cb97-2"></a>   G <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>, <span class="fu">make.swap</span>(A), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-3"><a href="#cb97-3"></a>   corrs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(G, tm.deg.corr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plotting the results gives us:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="tm-null_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Like before, all of the estimated degree correlations are below zero, and also like before, the observed value does not look as extreme as with the Erdos-Renyi or fixed degree model for either rows or columns separately.</p>
<p>Let’s check the p-value at <span class="math inline">\(p &lt; 0.05\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>   <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        5% 
-0.3425058 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>   <span class="fu">tm.deg.corr</span>(A) <span class="sc">&lt;</span> <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   5% 
FALSE </code></pre>
</div>
</div>
<p>No longer significant! What’s the actual p-value?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>   <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(corrs))(<span class="fu">abs</span>(<span class="fu">tm.deg.corr</span>(A)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.062</code></pre>
</div>
</div>
<p>As suspected, the two-tailed test indicates that the hypothesis of degree anti-correlation is no longer justified in these data even using a criterion of <span class="math inline">\(p &lt; 0.05\)</span>.</p>
<p>Looks like our paper won’t be published after all :(</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-neal_etal24" class="csl-entry" role="doc-biblioentry">
Neal, Zachary P, Annabell Cadieux, Diego Garlaschelli, Nicholas J Gotelli, Fabio Saracco, Tiziano Squartini, Shade T Shutters, Werner Ulrich, Guanyang Wang, and Giovanni Strona. 2024. <span>“Pattern Detection in Bipartite Networks: A Review of Terminology, Applications, and Methods.”</span> <em>PLOS Complex Systems</em> 1 (2): e0000010.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>