---
title: "Generalized Prestige Scoring in Two-Mode Networks"
execute: 
  eval: true
  echo: true
  output: true
  warning: false
  message: false
format: 
  html:
    code-line-numbers: true
---

In the lecture note on [Status and Prestige in Two-Mode Netwoks](prestige-two-mode.qmd) we examine various ways of assigning scores to the row and column objects of the biadjacency matrix to derive status scores for the nodes of a two-mode network. 

The dual scoring approach due to @bonacich91 (the dual "Eigenvector Centrality") serves as the standard here, with other approaches (e.g., PageRank-style scoring) serving as deviations and tweaks on the general formula. All can be modeled as the "prismatic" [@podolny01] distribution of status within a system, where nodes in one mode get status from the status of the nodes in each mode and vice versa. 

In formuelese, the iterative two-mode network status scoring can formalized as follows. At each iteration $q$ the vector of status scores for the row nodes $\mathbf{s}^R$ and the column nodes $\mathbf{s}^C$ is given by: 

$$
s^R_i(q) = \sum_j\mathbf{A}_{ij}s^C_j(q-1)
$${#eq-iter1}


$$
s^C_j(q) = \sum_i\mathbf{A}_{ij}s^R_i(q-1)
$${#eq-iter2}   


With the restriction that at the initial step $\mathbf{s}(0)^C = \mathbf{1}$ where $\mathbf{1}$ is the all ones vector of length equals to the number of columns of the biadjacency matrix. At iteration $q > 0$ we normalize both score vectors:

$$
\mathbf{s}^R(q) = \frac{\mathbf{s}^R(q)}{||\mathbf{s}^R(q)||_2}
$${#eq-norm1}   

$$
\mathbf{s}^C(q) = \frac{\mathbf{s}^C(q)}{||\mathbf{s}^C(q)||_2}
$${#eq-norm2} 

Where $||\mathbf{s}||_2 = \sqrt{\sum_i s_i^2}$ is the Euclidean vector norm. 

As [noted before](prestige-two-mode.qmd), one way to generalize the Bonacich scoring is by substituting some other matrix other than $\mathbf{A}$ like the row-stochastic matrix $\mathbf{P}$ into the above equations and let the process run until convergence. 

In a technical paper, @pugliese_etal16 [p. 1909] hint at an alternative way to generalize the usual status scoring in two-mode networks that involves changing the status scores themselves while keeping the standard biadjacency matrix $\mathbf{A}$ in place.

Their basic idea is that at each time step in the iteration we can substitute the following for the current status scores:

$$    
s^R_i(q) = \left(\sum_j\mathbf{A}_{ij}\left[s^C_j(q-1)\right]^{-\delta}\right)^{-\frac{1}{\delta}}
$${#eq-gen1}

$$
    s^C_j(q) = \left(\sum_i\mathbf{A}_{ij}\left[s^R_i(q-1)\right]^{-\gamma}\right)^{-\frac{1}{\gamma}}
$${#eq-gen2}

This generalization works like this: When the parameter $\gamma = 1$ it has the effect of *inverting* the row object's status scores ($s^R_i(q-1)$) that go into the calculation of the column object's status (inside the parentheses), meaning that column objects that connect to *low status* row objects receive *more* status. However, the same parameter outside the parentheses reverses the first inversion, such that column objects receive more status when they connect almost exclusively to high-status row objects and shun the low status ones. 

The $\delta$ parameters work similarly. When $\delta = 1$ the column object's status scores ($s^C_i(q-1)$) that go into the calculation of the focal row object's status are reversed, so that row objects receive *more* status when they connect to *low status* row objects (inside the parentheses). The same parameter (outside the parentheses) reverses this inversion, such that the status of a given row object increases when they connect to high status column objects and shun the low status ones. 

Note that when both parameters $\{\gamma, \delta\} = -1$ the equations above reduce to the usual Bonacich dual scoring. Different parameter value combinations $\{\gamma, \delta\}$ in the $\{+1, -1\}$ range instantiate different ways in which status operates in a given system. 

Why would we want to generalize status scoring in this way? Recall that the basic principle of Bonacich scoring is based on the equation of status and *popularity*/*activity*. In the canonical case of persons and groups [@breiger74], an event receives status from being attended by high-status individuals and an individual receives status from being affiliated with a high status event; in each case, status from the point of view of the event means having highly active members, and from the point of view of the individual it means being affiliated with popular events. 

But status may not always work this way. Consider the world-economic network linking countries to the products they have a competitive advantage in producing. Analysts noticed that the most developed countries produce both "complex" products that only a select few of other highly developed economies produce and also less "complex" (e.g., natural resources) products that the other less developed economics produce [@tacchella_etal12]. That  means that the "complexity" of a product cannot be derived simply taking a summary (e.g., sum or average) of the status score of the countries that produce it, because high status countries engage in both high and low status forms of production. 

In the case of persons and groups [@breiger74], an equivalent situation would go as follows. Imagine there is a set of elite women and a set of elite events that only the elite women attend. However, elite women are also endowed with a spirit of *noblesse oblige*, which means that the most elite of them *also* attend non-elite events. This means that when determining the status of the *events* it is not very informative to know that elites affiliate with them; rather, we should weigh more heavily whether non-elites affiliate with an event in determining an event's status, such that as the the number of non-elites women who affiliate with an event increases, a given event's status is downgraded in a non-linear way. In formal terms, the status of column objects is heavily contaminated by having non-elite row-object affiliates, which we may refer to as a *column object contamination* system. 

Note that the aforementioned dynamics would describe to any status system in which elites are likely to have both elite and non-elite affiliations, and in which elite status is not *necessarily* threatened by having such non-elite affiliations. However, in this system the status of *genres* is negatively and steeply affected by having non-elite audiences. Such a system approximates the description of the "omnivore" regime that, as argued by cultural sociologists, organizes contemporary cultural consumption choices.   

One approach to modeling this type of elite-omnivorousness status system is to set $\gamma = 1$ in @eq-gen2 so that a column object's status is the sum of the inverse of the inverse of the status of the row objects affiliated with it. This means that a column object's status decreases non-linearly when it is affiliated with low status row objects, and this feeds back into the calculation of each row object's status. 

An alternative status system applies the same "status contamination" reasoning as we just described, but it does so asymmetrically in determining the status of the row objects, not the column objects they affiliate with. Thus, in the case of person and groups, imagine a status system in which the status of persons is fragile, so that *any* affiliation with low status events will drive it downward non-linearly. This then feeds back into the determination of an event's status, such that events likely to be attended by these contaminated elites themselves rapidly lose status. 

Note that in this case, "omnivore" elites will be low status, and elites who's affiliations remain tied exclusively to elite events will retain status. The same goes for column objects, as only those column objects more likely to be attended by more discerning elites (those who completely avoid low status events) will retain status. In formal terms, the status of row objects is heavily contaminated by having non-elite column-object affiliations, which we may refer to as a *row object contamination* system. 

To implement this "fragile eliteness" status system, we can set $\delta = 1$ in @eq-gen1, which models a system in which a row object's status decreases non-linearly when it is affiliated with a low status column object. This feeds back into the calculation of each column object's status, such that column object's preferred by the now low-status row objects suffer a steeper status penalty.  

Finally, a system in which *both* the status of row and column objects decreases non-linearly when they are connected to low-status objects in the other mode (double status contammination, feeding back into one another), would have *both* $\gamma = 1$ and  $\delta = 1$ in @eq-gen1 and @eq-gen2.

So the generalized status scoring model above allows us to consider different status distribution  regimes, which we can characterize as follows:

|$\gamma$|$\delta$|Status Distribution Regime|
|-------|--------|--------|--------|------|
|-1|-1|Popularity Brings Status|
|-1|1|Row Low-Status Contamination for Column Objects|
|-1|1|Column Low-Status Contamination for Row Objects|
|1|1|Generalized Low-Status Contamination for Row and Column Objects|

Let's see how this would work with real data. Let's load up the trusty Southern Women (SW) data:


```{r}
   library(networkdata)
   library(igraph)
   g <- southern_women
   A <- as.matrix(as_biadjacency_matrix(g))
```

Here's the SW biadjacency matrix in table form:

```{r}
#| label: tbl-sw
#| tbl-cap: "Southern Women Data Biadjacency Matrix with Row and Columns Ordered by Degree Centrality"
#| echo: false
    library(kableExtra)
    A <- A[names(sort(rowSums(A), decreasing = TRUE)), names(sort(colSums(A), decreasing = TRUE))]
    kbl(A, format = "pipe") %>% 
    kable_styling(bootstrap_options = c("hover", "condensed", "responsive"))
```

And here's a function that modifies the status distribution game function to incorporate generalized status scores parameters:

```{r}
   tm.status <- function(w, gamma = -1, delta = -1) {
      y <- matrix(1, ncol(w), 1) #initial group status column vector set to a constant
      z <- t(w)
      epsilon <- 1 
      k <- 0
      while (epsilon > 1e-10) {
         o.y <- y 
         x <- (w %*% (o.y^-delta))^(1/-delta) #generalized status scores for people
         x <- x/mean(x) #normalizing new people status scores 
         y <- (z %*% (x^-gamma))^(1/-gamma) #generalized status scores for groups
         y <- y/mean(y) #normalizing new group status scores 
         if (k > 1) {
            epsilon <- abs(sum(abs(y) - abs(o.y))) 
            }
         k <- k + 1
         }
   return(list(p.s = x, g.s = y, k = k))
   }
```

We then run the function for the four status distribution regimes:

```{r}
   s1 <- tm.status(A) #Bonacich Scores
   s2 <- tm.status(A, gamma = 1, delta = -1) #column contamination
   s3 <- tm.status(A, gamma = -1, delta = 1) #row contamination
   s4 <- tm.status(A, gamma = 1, delta = 1) #double contamination
```

Now we check out the different status orderings. For people, this looks like this:

```{r}
#| echo: false
#| label: tbl-people
#| tbl-cap: "Status Scores for Persons"
   s1.col <- data.frame(n = rownames(s1$p.s)[order(s1$p.s/max(s1$p.s), decreasing = TRUE)],
                   s = round(sort(s1$p.s/max(s1$p.s), decreasing = TRUE), 2))
   s2.col <- data.frame(n = rownames(s2$p.s)[order(s2$p.s/max(s2$p.s), decreasing = TRUE)],
                   s = round(sort(s2$p.s/max(s2$p.s), decreasing = TRUE), 2))
   s3.col <- data.frame(n = rownames(s3$p.s)[order(s3$p.s/max(s3$p.s), decreasing = TRUE)],
                   s = round(sort(s3$p.s/max(s3$p.s), decreasing = TRUE), 2))
   s4.col <- data.frame(n = rownames(s4$p.s)[order(s4$p.s/max(s4$p.s), decreasing = TRUE)],
                   s = round(sort(s4$p.s/max(s4$p.s), decreasing = TRUE), 2))
   s.tab <- cbind(s1.col, s2.col, s3.col, s4.col)
   library(kableExtra)
   kbl(s.tab, format = "pipe", 
       align = c("l", "c", "l", "c", "l", "c", "l", "c"),
       col.names = c("Person", "Bonacich", "Person", "Col. Contamination", "Person", "Row Contamination", "Person", "Double Contamination")) %>% 
   kable_styling(bootstrap_options = c("hover", "condensed", "responsive")) %>%
   footnote(symbol = c("Scores normalized by dividing by the maximum.")) 
```

And for the groups:

```{r}
#| echo: false
#| label: tbl-groups
#| tbl-cap: "Status Scores for Groups"
   s1.col <- data.frame(n = rownames(s1$g.s)[order(s1$g.s/max(s1$g.s), decreasing = TRUE)], s = round(sort(s1$g.s/max(s1$g.s), decreasing = TRUE), 2))
   s2.col <- data.frame(n = rownames(s2$g.s)[order(s2$g.s/max(s2$g.s), decreasing = TRUE)], s = round(sort(s2$g.s/max(s2$g.s), decreasing = TRUE), 2))
   s3.col <- data.frame(n = rownames(s3$g.s)[order(s3$g.s/max(s3$g.s), decreasing = TRUE)], s = round(sort(s3$g.s/max(s3$g.s), decreasing = TRUE), 2))
   s4.col <- data.frame(n = rownames(s4$g.s)[order(s4$g.s/max(s4$g.s), decreasing = TRUE)], s = round(sort(s4$g.s/max(s4$g.s), decreasing = TRUE), 2))
   s.tab <- cbind(s1.col, s2.col, s3.col, s4.col)
   library(kableExtra)
   kbl(s.tab, format = "pipe", 
       align = c("l", "c", "l", "c", "l", "c", "l", "c"),
       col.names = c("Group", "Bonacich", "Group", "Col. Contamination", "Group", "Row Contamination", "Group", "Double Contamination")) %>% 
   kable_styling(bootstrap_options = c("hover", "condensed", "responsive")) |> 
   footnote(symbol = c("Scores normalized by dividing by the maximum.")) 
```
As we can see in the first two columns of @tbl-groups, the Bonacich Eigenvector ranking is pretty similar to the ranking we obtain using degree with events 9/16, 3/15, 4/8, 5/19, and 2/25 ranked toward the top. 

As the third and fourth columns of @tbl-groups shows, the ranking obtained in the column contamination model is completely different and in many ways reversed. Events 3/2, 6/27, 11/21, and 8/3 come toward the top and most of the events ranked first by the eigenvector score are toward the bottom. The reason for that, is that while events 3/2, 6/27, 11/21, and 8/3 are relative small events by degree, they are attended almost exclusively by the highest status women and are avoided by the lower status women. The column contamination model thus uncovers the most elite set of events by this status metric. 

As the first four columns of @tbl-people show, ranking the women using the column contamination model's event scores serves to magnify the Bonacich status differences between them, while also re-ordering the top of the ranks. The top four women receive very high normalized scores ($\mathbf{s}^R > 0.8$) and the bottom seven meager scores ($\mathbf{s}^R < 0.2$). This ranking reveals Evelyn as the top woman, followed closely by Nora, Laura, and Sylvia. The reason for Nora's rise in standing according to the generalized column contamination metric is that she attends almost all of the elite events uncovered by the same metric, as we can see in @tbl-sw.

But what if status operated such that *any* affiliation with non-elite events would highly degrade a woman's status? Rows five and six of @tbl-people tell that story. As we can see, the row-contamination status order of women is almost the complete reverse as that implied by the column contamination model. Here, Dorothy emerges as to the top person, followed somewhat distantly by Olivia, Flora, and Pearl, all undisputed low status women according to the Bonacich and especially the colum contamination model's scores. 

All of the high status women according to these other status metrics are lumped to the bottom in the row-contamination system. The reason for this is that only two events, namely, 4/8 and 9/16 emerge as high status events by this metric, and these are the two most popular events, as we can see in @tbl-sw. Dorothy attends both buth shuns *every* other event, which puts her toward the top. Olvia and Flora on the other hand attend 4/8 and just one other event. Pearl, the fourth woman ranked by this metric, attends the two high-status events, but also attends a low status event (5/19) which degrades her position. As we can see, this status metric thus rewards high status selectivity and heavily punishes the omnivore strategy. 

As we can see in @tbl-groups, the double status contamination model, combining the omnivore and excluvist status dynamics, provides yet another picture of the event status system. Here, event 2/23 emerges as the highest status event, followed closely by events 11/21 and 8/3. Events 4/8 and 9/16, the top events in the row-contaminaton model are now towards the bottom of the status order. As we ca see in @tbl-sw, all of these events are relatively restrictive in terms of attendance; what they have in common is that they *combine* memberships of the two types of elite women uncovered by the row and column-object contamination models; that is, their membership include both high-status membership omnivores like Nora, and exclusivists like Olivia and Flora, the last two of whom emerge as the top status women in the double-contamination dynamic. 
