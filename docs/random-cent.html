<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Random Walk Centralities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Random Walk Centralities">
<meta property="og:description" content="In the lecture notes on random walk concepts we defined two basic quantities helpful for analyzing networks in terms of dynamic diffusion processes: The average first passage time and the average…">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Random Walk Centralities</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Basic Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-dir.html" class="sidebar-item-text sidebar-link">Basic Network Statistics for Directed Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">Matrix Eigendecomposition</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Centrality</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./degcent.html" class="sidebar-item-text sidebar-link">Degree Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./closcent.html" class="sidebar-item-text sidebar-link">Closeness Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./betcent.html" class="sidebar-item-text sidebar-link">Betwenness Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Centrality Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./edgecent.html" class="sidebar-item-text sidebar-link">Edge Centralities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-centrality.html" class="sidebar-item-text sidebar-link">Centrality in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Status and Prestige</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pagerank.html" class="sidebar-item-text sidebar-link">PageRank Prestige Scoring</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hits.html" class="sidebar-item-text sidebar-link">Hubs and Authorities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige-ml.html" class="sidebar-item-text sidebar-link">Prestige in Multilayer Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Equivalence and Similarity</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-similarity.html" class="sidebar-item-text sidebar-link">Similarity and Equivalence in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Communities and Clustering</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-community-ca.html" class="sidebar-item-text sidebar-link">Community Detection in Two-Mode Networks Using CA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-spectral.html" class="sidebar-item-text sidebar-link">Spectral Clustering of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Two-Mode Networks</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-basic.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-duality.html" class="sidebar-item-text sidebar-link">The Duality of Persons and Groups</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-reflections.html" class="sidebar-item-text sidebar-link">The Method of Reflections in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-fitness.html" class="sidebar-item-text sidebar-link">Fitness and Complexity in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-null.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link">Extracting the Backbone of Bipartite Projections Using Two-Mode Graph Ensembles</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">Data Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loading.html" class="sidebar-item-text sidebar-link">Loading Network Data from a File</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-lists.html" class="sidebar-item-text sidebar-link">Handling Graph Objects in Lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subgraph-select.html" class="sidebar-item-text sidebar-link">Selecting a Subgraph Based on Edge Conditions</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#randon-walk-closeness" id="toc-randon-walk-closeness" class="nav-link active" data-scroll-target="#randon-walk-closeness">Randon Walk Closeness</a></li>
  <li><a href="#current-flow-closeness" id="toc-current-flow-closeness" class="nav-link" data-scroll-target="#current-flow-closeness">Current Flow Closeness</a></li>
  <li><a href="#random-walk-betweenness" id="toc-random-walk-betweenness" class="nav-link" data-scroll-target="#random-walk-betweenness">Random Walk Betweenness</a>
  <ul class="collapse">
  <li><a href="#computing-random-walk-betweeness" id="toc-computing-random-walk-betweeness" class="nav-link" data-scroll-target="#computing-random-walk-betweeness">Computing Random Walk Betweeness</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/random-cent.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Random Walk Centralities</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In the lecture notes on <a href="./random.html">random walk concepts</a> we defined two basic quantities helpful for analyzing networks in terms of dynamic diffusion processes: The <strong>average first passage time</strong> and the <strong>average commute distance</strong>.</p>
<p>Both of these concepts serve as measures of distances (and its inverse proximity) based on how to two nodes are connected via direct and indirect paths, where the paths are defined by how something (e.g., gossip, disease, a meme) diffuses through the walk structure of the network based on transition probabilities governed by the inverse of the degrees of each node.</p>
<p>In the lecture on <a href="./closcent.html">closeness centrality</a> we saw how one of the fundamental centrality measures in social network analysis is defined according to a distance measure, in that case the <strong>geodesic</strong> or <strong>shortest path distance</strong>. Two nodes are far if the length of the shortest path separating is very long, and are close if it is very short (with the minimum being adjacency or length one).</p>
<p>Since random walk concepts are distance/proximity concepts, we can use them to build analogues of the centrality measures based on the geodesic distance.</p>
<section id="randon-walk-closeness" class="level2">
<h2 class="anchored" data-anchor-id="randon-walk-closeness">Randon Walk Closeness</h2>
<p>The most obvious extension is to build a measure of closeness based on the random walk concept fo the average first passage time. Two nodes are distant is the average number of steps it takes for something to get from one to the other is big, and they are close if the number of steps is small. So the average first passage time metric is the random-walk analogue to the geodesic distance, but it is based on random walks on <em>all</em> paths in the graph regardless of length.</p>
<p>Thus, if <span class="math inline">\(m_{ij}\)</span> is the average first passage time between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> then the <strong>random walk closeness centrality</strong> of node <span class="math inline">\(i\)</span> is given by:</p>
<p><span id="eq-rclos"><span class="math display">\[
C^{RCLO}_i = \left[\sum_j m_{ij}\right]^{-1}
\tag{1}\]</span></span></p>
<p>Where the denominator of the fraction is just the sum of the rows of the matrix <span class="math inline">\(\mathbf{M}\)</span></p>
<p>Just like closeness, we can also compute the normalized version of random walk closeness, by taking the average first passage time of each node across all of the other nodes in the graph:</p>
<p><span id="eq-nrclos"><span class="math display">\[
C^{NRCL}_i = \frac{N-1}{\sum_j m_{ij}}
\tag{2}\]</span></span></p>
<p>Let’s see how this would work in real data. Let’s load up our trusty <em>Pulp Fiction</em> dataset based on scene co-appearances in the movie:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>    <span class="fu">library</span>(networkdata)</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="fu">library</span>(stringr) <span class="co">#using stringr to change names from all caps to title case</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    g <span class="ot">&lt;-</span> movie_559</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="fu">V</span>(g)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">str_to_title</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name)</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="fu">V</span>(g)<span class="sc">$</span>name[<span class="fu">which</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Esmarelda"</span>)] <span class="ot">&lt;-</span> <span class="st">"Esmeralda"</span> <span class="co">#fixing misspelled name</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="fu">E</span>(g)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#setting edge weights to 1.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, we need the code we used <a href="./random-cent.html">before</a> to compute the average first passage time to get our random walk distance matrix <span class="math inline">\(\mathbf{M}\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>    A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb2-2"><a href="#cb2-2"></a>    d <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(A) <span class="co">#degree vector </span></span>
<span id="cb2-3"><a href="#cb2-3"></a>    D <span class="ot">&lt;-</span> <span class="fu">diag</span>(d) <span class="co">#degree matrix</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    L <span class="ot">&lt;-</span> D <span class="sc">-</span> A <span class="co">#Laplacian</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>    E <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(A), <span class="fu">nrow</span>(A))<span class="sc">/</span><span class="fu">nrow</span>(A)</span>
<span id="cb2-6"><a href="#cb2-6"></a>    L.p <span class="ot">&lt;-</span> <span class="fu">solve</span>(L <span class="sc">+</span> E) <span class="sc">-</span> E <span class="co">#pseudo-inverse of Laplacian</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>    e <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(A), <span class="dv">1</span>) <span class="co">#column vector of all ones</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>    l <span class="ot">&lt;-</span> <span class="fu">diag</span>(L.p) <span class="co">#diagonal vector of Laplacian inverse</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>    vol.A <span class="ot">&lt;-</span> <span class="fu">sum</span>(d) <span class="co">#graph volume </span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    M <span class="ot">&lt;-</span> vol.A <span class="sc">*</span> (e <span class="sc">%*%</span> <span class="fu">t</span>(l))</span>
<span id="cb2-11"><a href="#cb2-11"></a>    M <span class="ot">&lt;-</span> M <span class="sc">-</span> (vol.A <span class="sc">*</span> L.p)</span>
<span id="cb2-12"><a href="#cb2-12"></a>    M <span class="ot">&lt;-</span> M <span class="sc">+</span> (L.p <span class="sc">%*%</span> d) <span class="sc">%*%</span> <span class="fu">t</span>(e)</span>
<span id="cb2-13"><a href="#cb2-13"></a>    M <span class="ot">&lt;-</span> M <span class="sc">-</span> (e <span class="sc">%*%</span> (<span class="fu">t</span>(d) <span class="sc">%*%</span> L.p))</span>
<span id="cb2-14"><a href="#cb2-14"></a>   <span class="fu">round</span>(M[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Brett Buddy Butch Capt Koons Ed Sullivan English Dave Esmeralda Fabienne
 [1,]   0.0 110.8  13.1       49.1       110.8         53.9     216.1     62.2
 [2,]  35.0   0.0  16.7       44.4       102.0         51.6     219.7     76.6
 [3,]  30.6 110.0   0.0       44.2       110.0         50.6     203.0     69.2
 [4,]  34.5 105.7  12.2        0.0       105.7         52.3     215.2     75.1
 [5,]  35.0 102.0  16.7       44.4         0.0         51.6     219.7     76.6
 [6,]  32.8 106.4  12.0       45.7       106.4          0.0     215.0     74.2
 [7,]  31.6 111.0   1.0       45.2       111.0         51.6       0.0     70.2
 [8,]  21.6 111.8  11.1       49.1       111.8         54.6     214.1      0.0
 [9,]  33.2 109.2  18.2       49.7       109.2         55.8     221.2     73.4
[10,]  31.1 111.2   7.8       47.6       111.2         50.9     210.8     72.2
      Fourth Man Gawker #2
 [1,]      106.1      83.0
 [2,]      106.3      87.3
 [3,]      108.5      77.2
 [4,]      108.0      84.9
 [5,]      106.3      87.3
 [6,]      107.6      81.7
 [7,]      109.5      78.2
 [8,]      105.7      83.5
 [9,]        0.0      88.4
[10,]      109.4       0.0</code></pre>
</div>
</div>
<p>And here are the first ten rows and columns of the <span class="math inline">\(\mathbf{M}\)</span> mmatrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>    <span class="fu">rownames</span>(M) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(M)</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="fu">round</span>(M, <span class="dv">1</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Brett Buddy Butch Capt Koons Ed Sullivan English Dave Esmeralda
Brett          0.0 110.8  13.1       49.1       110.8         53.9     216.1
Buddy         35.0   0.0  16.7       44.4       102.0         51.6     219.7
Butch         30.6 110.0   0.0       44.2       110.0         50.6     203.0
Capt Koons    34.5 105.7  12.2        0.0       105.7         52.3     215.2
Ed Sullivan   35.0 102.0  16.7       44.4         0.0         51.6     219.7
English Dave  32.8 106.4  12.0       45.7       106.4          0.0     215.0
Esmeralda     31.6 111.0   1.0       45.2       111.0         51.6       0.0
Fabienne      21.6 111.8  11.1       49.1       111.8         54.6     214.1
Fourth Man    33.2 109.2  18.2       49.7       109.2         55.8     221.2
Gawker #2     31.1 111.2   7.8       47.6       111.2         50.9     210.8
             Fabienne Fourth Man Gawker #2
Brett            62.2      106.1      83.0
Buddy            76.6      106.3      87.3
Butch            69.2      108.5      77.2
Capt Koons       75.1      108.0      84.9
Ed Sullivan      76.6      106.3      87.3
English Dave     74.2      107.6      81.7
Esmeralda        70.2      109.5      78.2
Fabienne          0.0      105.7      83.5
Fourth Man       73.4        0.0      88.4
Gawker #2        72.2      109.4       0.0</code></pre>
</div>
</div>
<p>Now to compute random walk closeness according to <a href="#eq-rclos">Equation&nbsp;1</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   rw.clos <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(M)<span class="sc">^-</span><span class="dv">1</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>   <span class="fu">sort</span>(rw.clos, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       The Gimp             Zed Sportscaster #2         Maynard Sportscaster #1 
   0.0003172878    0.0003172878    0.0003158847    0.0003049048    0.0003001459 
      Esmeralda       Gawker #2      Pedestrian           Buddy     Ed Sullivan 
   0.0002890414    0.0002776414    0.0002776414    0.0002773396    0.0002773396 </code></pre>
</div>
</div>
<p>And the normalized version:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   nrw.clos <span class="ot">&lt;-</span> (<span class="fu">vcount</span>(g) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">rowSums</span>(M)</span>
<span id="cb8-2"><a href="#cb8-2"></a>   <span class="fu">sort</span>(nrw.clos, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       The Gimp             Zed Sportscaster #2         Maynard Sportscaster #1 
     0.01173965      0.01173965      0.01168773      0.01128148      0.01110540 
      Esmeralda       Gawker #2      Pedestrian           Buddy     Ed Sullivan 
     0.01069453      0.01027273      0.01027273      0.01026157      0.01026157 </code></pre>
</div>
</div>
<p>Note that in contrast to the measures based on shortest paths, in which the top characters also have the top closeness, the random walk version selects more obscure characters as the most central (e.g., The Gimp and Zed).</p>
<p>Note that because the average first passage time is an asymmetric measure, we have a choice as to whether to compute it based on the “out” or the “in” distances. When we use the row sums of the <span class="math inline">\(\mathbf{M}\)</span> matrix we count a node as close if the average first passage time between them and the other nodes in the graph is small.</p>
<p>But we can also say that a node is close to others if the average first passage time between the others and that node is small. In that case we would want to use the <em>column sums</em> of the <span class="math inline">\(\mathbf{M}\)</span> matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>   nrw.clos <span class="ot">&lt;-</span> (<span class="fu">vcount</span>(g) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">colSums</span>(M)</span>
<span id="cb10-2"><a href="#cb10-2"></a>   <span class="fu">sort</span>(nrw.clos, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Vincent       Butch       Jules         Mia   Marsellus       Brett 
 0.10885425  0.06704354  0.06392210  0.04047785  0.04008249  0.02937037 
     Marvin       Roger Honey Bunny     Pumpkin 
 0.02620981  0.02620981  0.02388114  0.02388114 </code></pre>
</div>
</div>
<p>Note that using this measure gives us more interpretable results, with the most important characters in the story being in the top ten.</p>
</section>
<section id="current-flow-closeness" class="level2">
<h2 class="anchored" data-anchor-id="current-flow-closeness">Current Flow Closeness</h2>
<p>What if we were to use the average commute time as our distance measure instead? This makes sense, because just like the average first passage time, two nodes are far if the average commute time between them is big, and close if it is small.</p>
<p>If we do that, we end up with a closeness centrality measure called <strong>Current Flow Closeness</strong> which is a weird name due to the fact that it was developed in the study of electrical circuit networks!</p>
<p>So if <span class="math inline">\(n_{ij}\)</span> is the average commute time distance between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> then the current flow closeness of <span class="math inline">\(i\)</span> is given by:</p>
<p><span id="eq-cfclos"><span class="math display">\[
C^{CFCL}_i = \left[\sum_j n_{ij}\right]^{-1}
\tag{3}\]</span></span></p>
<p>And the normalized version:</p>
<p><span id="eq-nrclos"><span class="math display">\[
C^{NCFC}_i = \frac{N-1}{\sum_j n_{ij}}
\tag{4}\]</span></span></p>
<p>Remember that once we have <span class="math inline">\(\mathbf{M}\)</span>, the <span class="math inline">\(\mathbf{N}\)</span> matrix of average commute time distances is just:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>   N <span class="ot">&lt;-</span> M <span class="sc">+</span> <span class="fu">t</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And here are the first ten rows and columns of the <span class="math inline">\(\mathbf{N}\)</span> mmatrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   <span class="fu">round</span>(N, <span class="dv">1</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Brett Buddy Butch Capt Koons Ed Sullivan English Dave Esmeralda
Brett          0.0 145.8  43.6       83.6       145.8         86.7     247.6
Buddy        145.8   0.0 126.8      150.1       204.0        158.0     330.8
Butch         43.6 126.8   0.0       56.3       126.8         62.6     204.0
Capt Koons    83.6 150.1  56.3        0.0       150.1         98.0     260.3
Ed Sullivan  145.8 204.0 126.8      150.1         0.0        158.0     330.8
English Dave  86.7 158.0  62.6       98.0       158.0          0.0     266.6
Esmeralda    247.6 330.8 204.0      260.3       330.8        266.6       0.0
Fabienne      83.7 188.3  80.3      124.2       188.3        128.8     284.3
Fourth Man   139.3 215.4 126.7      157.7       215.4        163.4     330.7
Gawker #2    114.1 198.5  85.0      132.5       198.5        132.5     289.0
             Fabienne Fourth Man Gawker #2
Brett            83.7      139.3     114.1
Buddy           188.3      215.4     198.5
Butch            80.3      126.7      85.0
Capt Koons      124.2      157.7     132.5
Ed Sullivan     188.3      215.4     198.5
English Dave    128.8      163.4     132.5
Esmeralda       284.3      330.7     289.0
Fabienne          0.0      179.1     155.7
Fourth Man      179.1        0.0     197.8
Gawker #2       155.7      197.8       0.0</code></pre>
</div>
</div>
<p>And now to compute the current flow closeness:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   cf.clos <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(N<span class="sc">/</span><span class="fu">sum</span>(d))<span class="sc">^-</span><span class="dv">1</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>   <span class="fu">sort</span>(cf.clos, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Vincent       Butch       Jules         Mia   Marsellus       Brett 
 0.05076202  0.04883195  0.04788957  0.04459401  0.04443553  0.04139034 
     Marvin       Roger Honey Bunny     Pumpkin 
 0.04015006  0.04015006  0.03897407  0.03897407 </code></pre>
</div>
</div>
<p>Note that we divided the entries in the average commute time matrix <span class="math inline">\(\mathbf{N}\)</span> by the volume of the graph <span class="math inline">\(\sum_i d_i\)</span> (the sum of degrees) to transform them into <strong>resistance distances</strong> <span class="citation" data-cites="fouss_etal16">(<a href="#ref-fouss_etal16" role="doc-biblioref">Fouss, Saerens, and Shimbo 2016, 78</a>)</span>, which does not make a difference for the rankings because it is just dividing by a constant.</p>
<p>And the normalized version:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   ncf.clos <span class="ot">&lt;-</span> (<span class="fu">vcount</span>(g)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">rowSums</span>(N<span class="sc">/</span><span class="fu">sum</span>(d))</span>
<span id="cb17-2"><a href="#cb17-2"></a>   <span class="fu">sort</span>(ncf.clos, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Vincent       Butch       Jules         Mia   Marsellus       Brett 
   1.878195    1.806782    1.771914    1.649978    1.644115    1.531442 
     Marvin       Roger Honey Bunny     Pumpkin 
   1.485552    1.485552    1.442041    1.442041 </code></pre>
</div>
</div>
<p>We can see that in contrast to the random walk closeness based on out-distances, but like the random walk closeness based on in-distances, the current flow closeness gives results that are closer to those obtained using the geodesic distance version of closeness with the most important characters in the story being in the top ten.</p>
</section>
<section id="random-walk-betweenness" class="level2">
<h2 class="anchored" data-anchor-id="random-walk-betweenness">Random Walk Betweenness</h2>
<p>We can extend a similar “random walk” reasoning to the concept of <a href="./betcent.html">betweenness centrality</a>. Recall that the standard computation of betweenness centrality only counts the number <em>shortest paths</em> that a given node is an intermediary on. We can extend the same reasoning beyond shortest paths to consider all paths of any length.</p>
<p>Consider a random walk process on a social network of the sort we <a href="./random.html">talked about before</a>. In this version we select a “seed” or “source” node <span class="math inline">\(i\)</span> and a destination (also called “sink) node <span class="math inline">\(j\)</span>. We start a diffusion process on <span class="math inline">\(i\)</span> and stop it when it reaches <span class="math inline">\(j\)</span>. The node-to-node transition are governed by the probabilities stored in the matrix <span class="math inline">\(\mathbf{P}\)</span>.</p>
<p>If we replay this process many times, each time selecting a random source and a random destination node in the network (such that all pairs of nodes get to play each role) then we <em>could</em> count the number of times the thing diffusing through the network when <em>through</em> some third node <span class="math inline">\(k\)</span>. A node has a high <strong>random walk betweenness centrality</strong> if it is likely to be an intermediary on most random walk diffusion processes that start and end with some other pair of nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>.</p>
<section id="computing-random-walk-betweeness" class="level3">
<h3 class="anchored" data-anchor-id="computing-random-walk-betweeness">Computing Random Walk Betweeness</h3>
<p>How do we calculate random walk betweenness? Turns out the information we seek is stored in the <strong>pseudo-inverse of the Laplacian</strong> matrix (<span class="math inline">\(\mathbf{L}^+\)</span>), which you recall from our <a href="./random.html">previous discussion</a> is defined as:</p>
<p><span id="eq-ilap"><span class="math display">\[
\mathbf{L}^+ = \left(\mathbf{L} -  \frac{\mathbf{E}}{N}\right) ^{-1}- \frac{\mathbf{E}}{N}
\tag{5}\]</span></span></p>
<p>Where <span class="math inline">\(\mathbf{L} = \mathbf{D} - \mathbf{A}\)</span>, <span class="math inline">\(\mathbf{D}\)</span> is the matrix containing the degrees of each node in the diagonal, <span class="math inline">\(\mathbf{E}\)</span> is the all ones matrix of the same dimension as <span class="math inline">\(\mathbf{A}\)</span>, and <span class="math inline">\(N\)</span> is the number of nodes in the network. Note that we already computed this matrix when calculating random walk closeness earlier for the <em>Pulp Fiction</em> network (<code>L.p</code>).</p>
<p>As <span class="citation" data-cites="fouss_etal16">Fouss, Saerens, and Shimbo (<a href="#ref-fouss_etal16" role="doc-biblioref">2016, 161</a>)</span> note, if we wanted to know the amount of “flow” (<span class="math inline">\(\phi\)</span>) that goes through a node <span class="math inline">\(k\)</span> during a random walk process involving a seed node <span class="math inline">\(i\)</span> and destination node <span class="math inline">\(l\)</span> all we need to do is compute:</p>
<p><span id="eq-flow1"><span class="math display">\[
\phi_k = \frac{1}{2}\sum_{j \in N(k)}^{N} a_{jk}|l_{ij}^+ - l_{jl}^+ - l_{ik}^+ + l_{kl}^+|
\tag{6}\]</span></span></p>
<p>Where the summation goes over all of <span class="math inline">\(k\)</span>’s neighbors <span class="math inline">\(j\)</span>. What this formula tells us is that the amount of flow that <span class="math inline">\(k\)</span> intermediates when a random walk process starts at <span class="math inline">\(i\)</span> and ends with <span class="math inline">\(l\)</span> is the sum of the amount of flow that would come through each edge <span class="math inline">\(e_{jk}\)</span> in the graph, connecting <span class="math inline">\(k\)</span> to one of their neighbors <span class="math inline">\(j\)</span>.</p>
<p>Let’s write a function to test this out in the <em>Pulp Fiction</em> network:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>    flow.k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, c, w) {</span>
<span id="cb19-2"><a href="#cb19-2"></a>        z <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(w))</span>
<span id="cb19-3"><a href="#cb19-3"></a>        i <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(w)<span class="sc">$</span>name <span class="sc">==</span> a)</span>
<span id="cb19-4"><a href="#cb19-4"></a>        l <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(w)<span class="sc">$</span>name <span class="sc">==</span> b)</span>
<span id="cb19-5"><a href="#cb19-5"></a>        k <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(w)<span class="sc">$</span>name <span class="sc">==</span> c)</span>
<span id="cb19-6"><a href="#cb19-6"></a>        f <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(w)) {</span>
<span id="cb19-8"><a href="#cb19-8"></a>            <span class="cf">if</span> (i <span class="sc">!=</span>k <span class="sc">&amp;</span> l <span class="sc">!=</span> k) {</span>
<span id="cb19-9"><a href="#cb19-9"></a>                f <span class="ot">&lt;-</span> f <span class="sc">+</span> (z[j,k] <span class="sc">*</span> <span class="fu">abs</span>(L.p[i,j] <span class="sc">-</span> L.p[j,l] <span class="sc">-</span> L.p[i,k] <span class="sc">+</span> L.p[k,l]))</span>
<span id="cb19-10"><a href="#cb19-10"></a>                }</span>
<span id="cb19-11"><a href="#cb19-11"></a>            }</span>
<span id="cb19-12"><a href="#cb19-12"></a>        f <span class="ot">&lt;-</span> f<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>        <span class="fu">return</span>(f)</span>
<span id="cb19-14"><a href="#cb19-14"></a>        }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>flow.k</code> function takes the seed node <code>a</code>, the destination node <code>b</code>, the intermediary node <code>c</code> and the graph <code>w</code> as arguments, and returns the total amount of flow that would go from each of <span class="math inline">\(k\)</span>’s neighbors <span class="math inline">\(j\)</span> as output according to <a href="#eq-flow1">Equation&nbsp;6</a>.</p>
<p>For instance, if we wanted to find the amount of flow that would go through Vincent if we started a random walk process with Mia and ended it with Pumpkin an infinite number of times, we would just type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>    <span class="fu">round</span>(<span class="fu">flow.k</span>(<span class="st">"Mia"</span>, <span class="st">"Pumpkin"</span>, <span class="st">"Vincent"</span>, g), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.711</code></pre>
</div>
</div>
<p>And if we wanted to change to the intermediary node to Brett:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>    <span class="fu">round</span>(<span class="fu">flow.k</span>(<span class="st">"Mia"</span>, <span class="st">"Pumpkin"</span>, <span class="st">"Brett"</span>, g), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.048</code></pre>
</div>
</div>
<p>Indicating that Vincent would intermediate much more of the flow between Mia and Pumpkin than would Brett.</p>
<p>Now, the overall random walk betweenness centrality of any node is just their average flow score across each pair of nodes in the graph. The following wrapper around <code>flow.k</code> figures that out:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>    flow.bet <span class="ot">&lt;-</span> <span class="cf">function</span>(c, w) {</span>
<span id="cb24-2"><a href="#cb24-2"></a>        b <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>        n <span class="ot">&lt;-</span> <span class="fu">vcount</span>(w)</span>
<span id="cb24-4"><a href="#cb24-4"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">V</span>(w)<span class="sc">$</span>name) {</span>
<span id="cb24-5"><a href="#cb24-5"></a>            <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">V</span>(w)<span class="sc">$</span>name) {</span>
<span id="cb24-6"><a href="#cb24-6"></a>                b <span class="ot">&lt;-</span> b <span class="sc">+</span> <span class="fu">flow.k</span>(i, j, c, w) <span class="co">#summing flows</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>            }</span>
<span id="cb24-8"><a href="#cb24-8"></a>        }</span>
<span id="cb24-9"><a href="#cb24-9"></a>        b <span class="ot">&lt;-</span> b <span class="sc">*</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (n<span class="sc">-</span> <span class="dv">2</span>))<span class="sc">^-</span><span class="dv">1</span> <span class="co">#averaging across pairs</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>        <span class="fu">return</span>(b)</span>
<span id="cb24-11"><a href="#cb24-11"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now find Vincent’s random walk betweenness:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>    <span class="fu">round</span>(<span class="fu">flow.bet</span>(<span class="st">"Vincent"</span>, g), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.498</code></pre>
</div>
</div>
<p>Which is higher than Brett’s</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>    <span class="fu">round</span>(<span class="fu">flow.bet</span>(<span class="st">"Brett"</span>, g), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.077</code></pre>
</div>
</div>
<p><span class="citation" data-cites="fouss_etal16">Fouss, Saerens, and Shimbo (<a href="#ref-fouss_etal16" role="doc-biblioref">2016, 162</a>)</span> show that we can use some matrix tricks to compute these quantities more efficiently. First, they note that the total flow going through a particular edge <span class="math inline">\(e_{jk}\)</span> in the graph for every source/destination pair of nodes can be computed as follows. First, we compute the matrix <span class="math inline">\(\mathbf{N}_jk\)</span>:</p>
<p><span class="math display">\[
\mathbf{N}_{jk} = (\mathbf{l}^+_j  - \mathbf{l}^+_k)\mathbf{e^T} - \mathbf{e}(\mathbf{l}^+_j  - \mathbf{l}^+_k)^T
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{l}^+_j\)</span> is the <span class="math inline">\(j^{th}\)</span> column of <span class="math inline">\(\mathbf{L}^+\)</span>.</p>
<p>Then, the flow through edge <span class="math inline">\(e_{jk}\)</span> is given by:</p>
<p><span class="math display">\[
\phi_{jk} = (\mathbf{e} - \mathbf{e}_k)^T |\mathbf{N}_{jk}| (\mathbf{e} - \mathbf{e}_k)
\]</span></p>
<p>The random walk betweenness of <span class="math inline">\(k\)</span> is then the sum of <span class="math inline">\(\phi_{jk}\)</span> across each neighbor <span class="math inline">\(j \in N(k)\)</span>.</p>
<p>Here’s a function that packages those tricks to compute the random walk betweenness of each node in the graph, based on <span class="citation" data-cites="fouss_etal16">Fouss, Saerens, and Shimbo (<a href="#ref-fouss_etal16" role="doc-biblioref">2016</a>, algorithm 4.5)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>    cur.flow.bet <span class="ot">&lt;-</span> <span class="cf">function</span>(w) {</span>
<span id="cb29-2"><a href="#cb29-2"></a>        n <span class="ot">&lt;-</span> <span class="fu">vcount</span>(w)</span>
<span id="cb29-3"><a href="#cb29-3"></a>        b <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb29-4"><a href="#cb29-4"></a>        <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb29-5"><a href="#cb29-5"></a>            l.k <span class="ot">&lt;-</span> L.p[, k]</span>
<span id="cb29-6"><a href="#cb29-6"></a>            N.k <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">neighbors</span>(w, k))</span>
<span id="cb29-7"><a href="#cb29-7"></a>            <span class="cf">for</span> (j <span class="cf">in</span> N.k) {</span>
<span id="cb29-8"><a href="#cb29-8"></a>                l.j <span class="ot">&lt;-</span> L.p[, j]</span>
<span id="cb29-9"><a href="#cb29-9"></a>                Njk <span class="ot">&lt;-</span> ((l.j <span class="sc">-</span> l.k) <span class="sc">%*%</span> <span class="fu">t</span>(e)) <span class="sc">-</span> (e <span class="sc">%*%</span> <span class="fu">t</span>(l.j <span class="sc">-</span> l.k))</span>
<span id="cb29-10"><a href="#cb29-10"></a>                e.k <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, <span class="dv">1</span>)</span>
<span id="cb29-11"><a href="#cb29-11"></a>                e.k[k] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>                b[k] <span class="ot">&lt;-</span> b[k] <span class="sc">+</span> (<span class="fu">t</span>(e <span class="sc">-</span> e.k) <span class="sc">%*%</span> <span class="fu">abs</span>(Njk) <span class="sc">%*%</span> (e <span class="sc">-</span> e.k))</span>
<span id="cb29-13"><a href="#cb29-13"></a>            }</span>
<span id="cb29-14"><a href="#cb29-14"></a>        }</span>
<span id="cb29-15"><a href="#cb29-15"></a>    b <span class="ot">&lt;-</span> b <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (n<span class="sc">-</span> <span class="dv">2</span>)))<span class="sc">^-</span><span class="dv">1</span> <span class="co">#averaging across pairs</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="fu">names</span>(b) <span class="ot">&lt;-</span> <span class="fu">V</span>(w)<span class="sc">$</span>name</span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="fu">return</span>(b)</span>
<span id="cb29-18"><a href="#cb29-18"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now for the big reveal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>    cf.bet <span class="ot">&lt;-</span> <span class="fu">cur.flow.bet</span>(g)</span>
<span id="cb30-2"><a href="#cb30-2"></a>    <span class="fu">round</span>(<span class="fu">sort</span>(cf.bet, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Vincent       Butch       Jules         Mia   Marsellus     Pumpkin 
      0.498       0.454       0.309       0.187       0.147       0.115 
Honey Bunny     Maynard       Brett      Marvin 
      0.115       0.106       0.077       0.060 </code></pre>
</div>
</div>
<p>Which gives us the same answer as we obtained earlier for Vincent (the top node) while also showing the other top random walk betweenness centrality nodes in the network. These nodes, are not surprisingly, also some of the most central characters in the story.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-fouss_etal16" class="csl-entry" role="doc-biblioentry">
Fouss, François, Marco Saerens, and Masashi Shimbo. 2016. <em>Algorithms and Models for Network Data and Link Analysis</em>. Cambridge University Press.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>