<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Vertex Similarity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Vertex Similarity">
<meta property="og:description" content="As we noted in the role equivalence handout, for odd reasons, classical approaches to structural similarity in networks used distance metrics but did not measure similarity directly.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Vertex Similarity</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">Matrix Eigendecomposition</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Centrality and Prestige</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centrality.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Centrality Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-centrality.html" class="sidebar-item-text sidebar-link">Centrality in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pagerank.html" class="sidebar-item-text sidebar-link">PageRank Prestige Scoring</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hits.html" class="sidebar-item-text sidebar-link">Hubs and Authorities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Equivalence and Similarity</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link active">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-walk.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-similarity.html" class="sidebar-item-text sidebar-link">Similarity and Equivalence in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Communities and Clustering</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-community-ca.html" class="sidebar-item-text sidebar-link">Community Detection in Two-Mode Networks Using CA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-spectral.html" class="sidebar-item-text sidebar-link">Spectral Clustering of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Two-Mode Networks</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-basic.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-duality.html" class="sidebar-item-text sidebar-link">The Duality of Persons and Groups</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-reflections.html" class="sidebar-item-text sidebar-link">The Method of Reflections in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-fitness.html" class="sidebar-item-text sidebar-link">Fitness and Complexity in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-null.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link">Extracting the Backbone of Bipartite Projections Using Two-Mode Graph Ensembles</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Data Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loading.html" class="sidebar-item-text sidebar-link">Loading Network Data from a File</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-lists.html" class="sidebar-item-text sidebar-link">Handling Graph Objects in Lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subgraph-select.html" class="sidebar-item-text sidebar-link">Selecting a Subgraph Based on Edge Conditions</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#basic-ingredients-of-vertex-similarity-metrics" id="toc-basic-ingredients-of-vertex-similarity-metrics" class="nav-link active" data-scroll-target="#basic-ingredients-of-vertex-similarity-metrics">Basic Ingredients of Vertex Similarity Metrics</a></li>
  <li><a href="#normalized-similarity-metrics" id="toc-normalized-similarity-metrics" class="nav-link" data-scroll-target="#normalized-similarity-metrics">Normalized Similarity Metrics</a></li>
  <li><a href="#similarity-and-structural-equivalence" id="toc-similarity-and-structural-equivalence" class="nav-link" data-scroll-target="#similarity-and-structural-equivalence">Similarity and Structural Equivalence</a></li>
  <li><a href="#generalized-similarities" id="toc-generalized-similarities" class="nav-link" data-scroll-target="#generalized-similarities">Generalized Similarities</a></li>
  <li><a href="#global-similarity-indices" id="toc-global-similarity-indices" class="nav-link" data-scroll-target="#global-similarity-indices">Global Similarity Indices</a>
  <ul class="collapse">
  <li><a href="#the-local-path-similarity-index" id="toc-the-local-path-similarity-index" class="nav-link" data-scroll-target="#the-local-path-similarity-index">The Local Path Similarity Index</a></li>
  <li><a href="#the-katz-similarity" id="toc-the-katz-similarity" class="nav-link" data-scroll-target="#the-katz-similarity">The Katz Similarity</a></li>
  <li><a href="#degree-weighted-katz-similarity-aka-leicht-holme-newman" id="toc-degree-weighted-katz-similarity-aka-leicht-holme-newman" class="nav-link" data-scroll-target="#degree-weighted-katz-similarity-aka-leicht-holme-newman">Degree-Weighted Katz Similarity (AKA Leicht-Holme-Newman)</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/similarity.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Vertex Similarity</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As we noted in the role equivalence handout, for odd reasons, classical approaches to structural similarity in networks used <em>distance</em> metrics but did not measure similarity directly. More recent approaches from network and information science prefer to define vertex similarity using direct similarity measures based on local structural characteristics, like node neighborhoods.</p>
<p>Mathematically, similarity is a less stringent (but also less well-defined compared to distances) relation between pairs of nodes in a graph than distance, so it can be easier to work with in most applications.</p>
<p>For instance, similarity is required to be symmetric (<span class="math inline">\(s_{ij} = s_{ji}\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>) and most metrics have reasonable bounds (e.g., 0 for least similar and 1.0 for maximally similar). Given such a bounded similarity we can get to <em>dissimilarity</em> by subtracting one: <span class="math inline">\(d_{ij} = 1 - s_{ij}\)</span></p>
<section id="basic-ingredients-of-vertex-similarity-metrics" class="level2">
<h2 class="anchored" data-anchor-id="basic-ingredients-of-vertex-similarity-metrics">Basic Ingredients of Vertex Similarity Metrics</h2>
<p>Consider two nodes and the set of nodes that are the immediate neighbors to each. In this case, most vertex similarity measures will make use of three pieces of information:</p>
<ol type="1">
<li><p>The number of common neighbors <span class="math inline">\(p\)</span>.</p></li>
<li><p>The number of actors <span class="math inline">\(q\)</span> who are connected to node <span class="math inline">\(i\)</span> but not to node <span class="math inline">\(j\)</span>.</p></li>
<li><p>The number of actors <span class="math inline">\(r\)</span> who are connected to node <span class="math inline">\(j\)</span> but not to node <span class="math inline">\(i\)</span>.</p></li>
</ol>
<p>In the simplest case of the binary undirected graph then these are given by:</p>
<p><span class="math display">\[
   p = \sum_{k = 1}^{n} a_{ik} a_{jk}
\]</span></p>
<p><span class="math display">\[
   q = \sum_{k = 1}^{n} a_{ik} (1 - a_{jk})
\]</span></p>
<p><span class="math display">\[
   r = \sum_{k = 1}^{n} (1- a_{ik}) a_{jk}
\]</span></p>
<p>In matrix form:</p>
<p><span class="math display">\[
   \mathbf{A}(p) = \mathbf{A} \mathbf{A} = \mathbf{A}^2
\]</span></p>
<p><span class="math display">\[
   \mathbf{A}(q) = \mathbf{A} (1 - \mathbf{A})
\]</span></p>
<p><span class="math display">\[
   \mathbf{A}(r) = (1 - \mathbf{A}) \mathbf{A}
\]</span></p>
<p>Let’s look at an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   g.flint <span class="ot">&lt;-</span> movie_267</span>
<span id="cb1-4"><a href="#cb1-4"></a>   g.flint <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.flint, <span class="fu">degree</span>(g.flint) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g.flint))</span>
<span id="cb1-6"><a href="#cb1-6"></a>   A.p <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A <span class="co">#common neighbors matrix</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>   A.q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="co">#neighbors of i not connected to j</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>   A.r <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">%*%</span> A <span class="co">#neighbors of j not connected to i</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>   A.p[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM            6      4     5        2    5            2          2    5
BARNEY             4     13     9        1   11            5          3    7
BETTY              5      9    13        2    9            3          4    8
FELDSPAR           2      1     2        2    1            0          2    2
FRED               5     11     9        1   14            4          3    9
HEADMISTRESS       2      5     3        0    4            5          0    3
HERDMASTER         2      3     4        2    3            0          4    4
LAVA               5      7     8        2    9            3          4   11
LEACH              2      3     3        1    2            2          1    2
MORRIS             2      3     2        0    2            3          0    2
             LEACH MORRIS
BAM-BAM          2      2
BARNEY           3      3
BETTY            3      2
FELDSPAR         1      0
FRED             2      2
HEADMISTRESS     2      3
HERDMASTER       1      0
LAVA             2      2
LEACH            3      1
MORRIS           1      3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>   A.q[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM            0      2     1        4    1            4          4    1
BARNEY             9      0     4       12    2            8         10    6
BETTY              8      4     0       11    4           10          9    5
FELDSPAR           0      1     0        0    1            2          0    0
FRED               9      3     5       13    0           10         11    5
HEADMISTRESS       3      0     2        5    1            0          5    2
HERDMASTER         2      1     0        2    1            4          0    0
LAVA               6      4     3        9    2            8          7    0
LEACH              1      0     0        2    1            1          2    1
MORRIS             1      0     1        3    1            0          3    1
             LEACH MORRIS
BAM-BAM          4      4
BARNEY          10     10
BETTY           10     11
FELDSPAR         1      2
FRED            12     12
HEADMISTRESS     3      2
HERDMASTER       3      4
LAVA             9      9
LEACH            0      2
MORRIS           2      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>   A.r[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM            0      9     8        0    9            3          2    6
BARNEY             2      0     4        1    3            0          1    4
BETTY              1      4     0        0    5            2          0    3
FELDSPAR           4     12    11        0   13            5          2    9
FRED               1      2     4        1    0            1          1    2
HEADMISTRESS       4      8    10        2   10            0          4    8
HERDMASTER         4     10     9        0   11            5          0    7
LAVA               1      6     5        0    5            2          0    0
LEACH              4     10    10        1   12            3          3    9
MORRIS             4     10    11        2   12            2          4    9
             LEACH MORRIS
BAM-BAM          1      1
BARNEY           0      0
BETTY            0      1
FELDSPAR         2      3
FRED             1      1
HEADMISTRESS     1      0
HERDMASTER       2      3
LAVA             1      1
LEACH            0      2
MORRIS           2      0</code></pre>
</div>
</div>
<p>Note that while <span class="math inline">\(\mathbf{A}(p)\)</span> is necessarily symmetric, neither <span class="math inline">\(q\)</span> nor <span class="math inline">\(r\)</span> have to be. Barney has many more neighbors that Bam-Bam is not connected to than vice versa. Also note that the <span class="math inline">\(\mathbf{A}(r)\)</span> matrix is just the transpose of the <span class="math inline">\(\mathbf{A}(q)\)</span> matrix in the undirected case.</p>
<p>So the most obvious measure of similarity between two nodes is simply the number of common neighbors <span class="citation" data-cites="leicht_etal06">(<a href="#ref-leicht_etal06" role="doc-biblioref">Leicht, Holme, and Newman 2006</a>)</span>:</p>
<p><span class="math display">\[
   s_{ij} = p_{ij}
\]</span></p>
<p>We have already seen a version of this in the directed case when talking about the HITS algorithm <span class="citation" data-cites="kleinberg99">(<a href="#ref-kleinberg99" role="doc-biblioref">Kleinberg 1999</a>)</span>, which computes a spectral (eigenvector-based) ranking based on the matrices of common in and out-neighbors in a directed graph.</p>
<p><span class="math display">\[
   p^{in}_{ij} = \sum_{k = 1}^{n} a_{ki} a_{kj}
\]</span></p>
<p><span class="math display">\[
   p^{out}_{ij} = \sum_{k = 1}^{n} a_{ik} a_{jk}
\]</span></p>
<p>Which in matrix form is:</p>
<p><span class="math display">\[
   \mathbf{A}(p^{out}) = \mathbf{A}^T \mathbf{A}
\]</span></p>
<p><span class="math display">\[
   \mathbf{A}(p^{in}) = \mathbf{A} \mathbf{A}^T
\]</span></p>
<p>In this case, similarity can be measured <em>either</em> by the number of common in-neighbors or the number of common out-neighbors.</p>
<p>If the network under consideration is a (directed) <strong>citation network</strong> with nodes being papers and links between papers defined as a citation from paper <span class="math inline">\(i\)</span> to paper <span class="math inline">\(j\)</span>, then the number of <em>common in-neighbors</em> between two papers is their <strong>co-citation</strong> similarity (the number of other papers that cite both papers), and the number of <em>common out-neighbors</em> is their <strong>bibliographic coupling</strong> similarity (the overlap in their list of references).</p>
<p>One problem with using unbounded quantities like the sheer number of common (in or out) neighbors to define node similarity is that they are only limited by the number of nodes in the network <span class="citation" data-cites="leicht_etal06">(<a href="#ref-leicht_etal06" role="doc-biblioref">Leicht, Holme, and Newman 2006</a>)</span>. Thus, an actor with many neighbors will end up having lots of other neighbors in common with lots of other nodes, which will mean we would count them as “similar” to almost everyone.</p>
</section>
<section id="normalized-similarity-metrics" class="level2">
<h2 class="anchored" data-anchor-id="normalized-similarity-metrics">Normalized Similarity Metrics</h2>
<p>Normalized similarity metrics deal with this issue by adjusting the raw similarity based on <span class="math inline">\(p\)</span> using the number of non-shared neighbors <span class="math inline">\(q\)</span> and <span class="math inline">\(r\)</span>.</p>
<p>The two most popular versions of normalized vertex similarity scores are the <strong>Jaccard index</strong> and the <strong>cosine similarity</strong> (sometimes also referred to as the <strong>Salton Index</strong>).</p>
<p>The Jacccard index is given by:</p>
<p><span class="math display">\[
   s_{ij} = \frac{p}{p + q + r}
\]</span></p>
<p>Which is the ratio of the size of the <em>intersection</em> of the neighborhoods of the two nodes (number of common neighbors) divided by the size of the <em>union</em> of the two neighborhoods.</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>   J <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (A.p <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb7-2"><a href="#cb7-2"></a>   <span class="fu">round</span>(J[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         1.00   0.27  0.36     0.33 0.33         0.22       0.25 0.42
BARNEY          0.27   1.00  0.53     0.07 0.69         0.38       0.21 0.41
BETTY           0.36   0.53  1.00     0.15 0.50         0.20       0.31 0.50
FELDSPAR        0.33   0.07  0.15     1.00 0.07         0.00       0.50 0.18
FRED            0.33   0.69  0.50     0.07 1.00         0.27       0.20 0.56
HEADMISTRESS    0.22   0.38  0.20     0.00 0.27         1.00       0.00 0.23
HERDMASTER      0.25   0.21  0.31     0.50 0.20         0.00       1.00 0.36
LAVA            0.42   0.41  0.50     0.18 0.56         0.23       0.36 1.00
LEACH           0.29   0.23  0.23     0.25 0.13         0.33       0.17 0.17
MORRIS          0.29   0.23  0.14     0.00 0.13         0.60       0.00 0.17
             LEACH MORRIS
BAM-BAM       0.29   0.29
BARNEY        0.23   0.23
BETTY         0.23   0.14
FELDSPAR      0.25   0.00
FRED          0.13   0.13
HEADMISTRESS  0.33   0.60
HERDMASTER    0.17   0.00
LAVA          0.17   0.17
LEACH         1.00   0.20
MORRIS        0.20   1.00</code></pre>
</div>
</div>
<p>Here showing that Barney is more similar to Fred and Betty than he is to Bam-Bam.</p>
<p>The cosine similarity is given by:</p>
<p><span class="math display">\[
   s_{ij} = \frac{p}{\sqrt{p + q} \sqrt{p + r}}
\]</span></p>
<p>Which is the ratio of the number of common neighbors divided by the product of the square root of the degrees of each node (or the square root of the product which is the same thing), since <span class="math inline">\(p\)</span> + <span class="math inline">\(q\)</span> is the degree of node <span class="math inline">\(i\)</span> and <span class="math inline">\(p\)</span> + <span class="math inline">\(r\)</span> is the degree of node <span class="math inline">\(j\)</span>.</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>   C <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (<span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.q) <span class="sc">*</span> <span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.r))</span>
<span id="cb9-2"><a href="#cb9-2"></a>   <span class="fu">round</span>(C[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         1.00   0.45  0.57     0.58 0.55         0.37       0.41 0.62
BARNEY          0.45   1.00  0.69     0.20 0.82         0.62       0.42 0.59
BETTY           0.57   0.69  1.00     0.39 0.67         0.37       0.55 0.67
FELDSPAR        0.58   0.20  0.39     1.00 0.19         0.00       0.71 0.43
FRED            0.55   0.82  0.67     0.19 1.00         0.48       0.40 0.73
HEADMISTRESS    0.37   0.62  0.37     0.00 0.48         1.00       0.00 0.40
HERDMASTER      0.41   0.42  0.55     0.71 0.40         0.00       1.00 0.60
LAVA            0.62   0.59  0.67     0.43 0.73         0.40       0.60 1.00
LEACH           0.47   0.48  0.48     0.41 0.31         0.52       0.29 0.35
MORRIS          0.47   0.48  0.32     0.00 0.31         0.77       0.00 0.35
             LEACH MORRIS
BAM-BAM       0.47   0.47
BARNEY        0.48   0.48
BETTY         0.48   0.32
FELDSPAR      0.41   0.00
FRED          0.31   0.31
HEADMISTRESS  0.52   0.77
HERDMASTER    0.29   0.00
LAVA          0.35   0.35
LEACH         1.00   0.33
MORRIS        0.33   1.00</code></pre>
</div>
</div>
<p>Showing results similar (pun intended) to those obtained using the Jaccard index.</p>
<p>A less commonly used option is the <strong>Dice Coefficient</strong> (sometimes called the <strong>Sorensen Index</strong>) given by:</p>
<p><span class="math display">\[
   s_{ij} = \frac{2p}{2p + q + r}
\]</span></p>
<p>Which is given by the ratio of <em>twice</em> the number of common neighbors divided by twice the same quantity plus the sum of the non-shared neighbors (and thus a variation of the Jaccard measure).</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>   D <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb11-2"><a href="#cb11-2"></a>   <span class="fu">round</span>(D[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         1.00   0.42  0.53     0.50 0.50         0.36       0.40 0.59
BARNEY          0.42   1.00  0.69     0.13 0.81         0.56       0.35 0.58
BETTY           0.53   0.69  1.00     0.27 0.67         0.33       0.47 0.67
FELDSPAR        0.50   0.13  0.27     1.00 0.12         0.00       0.67 0.31
FRED            0.50   0.81  0.67     0.12 1.00         0.42       0.33 0.72
HEADMISTRESS    0.36   0.56  0.33     0.00 0.42         1.00       0.00 0.38
HERDMASTER      0.40   0.35  0.47     0.67 0.33         0.00       1.00 0.53
LAVA            0.59   0.58  0.67     0.31 0.72         0.38       0.53 1.00
LEACH           0.44   0.38  0.38     0.40 0.24         0.50       0.29 0.29
MORRIS          0.44   0.38  0.25     0.00 0.24         0.75       0.00 0.29
             LEACH MORRIS
BAM-BAM       0.44   0.44
BARNEY        0.38   0.38
BETTY         0.38   0.25
FELDSPAR      0.40   0.00
FRED          0.24   0.24
HEADMISTRESS  0.50   0.75
HERDMASTER    0.29   0.00
LAVA          0.29   0.29
LEACH         1.00   0.33
MORRIS        0.33   1.00</code></pre>
</div>
</div>
<p>Once again, showing results comparable to the previous.</p>
<p>Note, that all three of these pairwise measures of similarity are bounded between zero and one, with nodes being maximally similar to themselves and with pairs of distinct nodes being maximally similar when they have the same set of neighbors (e.g., they are structurally equivalent).</p>
<p><span class="citation" data-cites="leicht_etal06">Leicht, Holme, and Newman (<a href="#ref-leicht_etal06" role="doc-biblioref">2006</a>)</span> introduce a variation on the theme of normalized structural similarity scores. Their point is that maybe we should care about nodes that are <em>surprisingly</em> similar given some suitable null model. They propose the <strong>configuration model</strong> as such a null model. This model takes a graph with the same degree distribution as the original but with connections formed at random as reference.</p>
<p>The <strong>LHN similarity index</strong> (for Leicht, Holme, and Newman) is then given by:</p>
<p><span class="math display">\[
s_{ij} = \frac{p}{(p + q)(p + r)}
\]</span></p>
<p>Which can be seen as a variation of the cosine similarity defined earlier.</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   D <span class="ot">&lt;-</span> A.p <span class="sc">/</span> ((A.p <span class="sc">+</span> A.q) <span class="sc">*</span> (A.p <span class="sc">+</span> A.r))</span>
<span id="cb13-2"><a href="#cb13-2"></a>   <span class="fu">round</span>(D[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         0.17   0.05  0.06     0.17 0.06         0.07       0.08 0.08
BARNEY          0.05   0.08  0.05     0.04 0.06         0.08       0.06 0.05
BETTY           0.06   0.05  0.08     0.08 0.05         0.05       0.08 0.06
FELDSPAR        0.17   0.04  0.08     0.50 0.04         0.00       0.25 0.09
FRED            0.06   0.06  0.05     0.04 0.07         0.06       0.05 0.06
HEADMISTRESS    0.07   0.08  0.05     0.00 0.06         0.20       0.00 0.05
HERDMASTER      0.08   0.06  0.08     0.25 0.05         0.00       0.25 0.09
LAVA            0.08   0.05  0.06     0.09 0.06         0.05       0.09 0.09
LEACH           0.11   0.08  0.08     0.17 0.05         0.13       0.08 0.06
MORRIS          0.11   0.08  0.05     0.00 0.05         0.20       0.00 0.06
             LEACH MORRIS
BAM-BAM       0.11   0.11
BARNEY        0.08   0.08
BETTY         0.08   0.05
FELDSPAR      0.17   0.00
FRED          0.05   0.05
HEADMISTRESS  0.13   0.20
HERDMASTER    0.08   0.00
LAVA          0.06   0.06
LEACH         0.33   0.11
MORRIS        0.11   0.33</code></pre>
</div>
</div>
<p>Which, once again, produces similar results to what we found before. Note, however, that the LHN is not naturally maximal for self-similar nodes.</p>
</section>
<section id="similarity-and-structural-equivalence" class="level2">
<h2 class="anchored" data-anchor-id="similarity-and-structural-equivalence">Similarity and Structural Equivalence</h2>
<p>All normalized similarity measures bounded between zero and one (like Jaccard, Cosine, and Dice) also define a <em>distance</em> on each pair of nodes which is equal to one minus the similarity. So the <strong>cosine distance</strong> between two nodes is one minus the cosine similarity, and so on for the Jaccard and Dice indexes.</p>
<p>Because they define distances, this also means that these approaches can be used to find approximately structurally equivalent classes of nodes in a graph just like we did with the Euclidean and correlation distances.</p>
<p>For instance, consider our toy graph from before with four structurally equivalent sets of nodes:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="similarity_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A toy graph demonstrating structural equivalence.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The cosine similarity matrix for this graph is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb15-2"><a href="#cb15-2"></a>   A.p <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A </span>
<span id="cb15-3"><a href="#cb15-3"></a>   A.q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> (<span class="dv">1</span> <span class="sc">-</span> A) </span>
<span id="cb15-4"><a href="#cb15-4"></a>   A.r <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">%*%</span> A </span>
<span id="cb15-5"><a href="#cb15-5"></a>   C <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (<span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.q) <span class="sc">*</span> <span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.r))</span>
<span id="cb15-6"><a href="#cb15-6"></a>   <span class="fu">round</span>(C, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     A    B    C    D    E    F    G    H    I
A 1.00 0.26 0.26 0.58 0.58 0.58 0.67 0.00 0.00
B 0.26 1.00 1.00 0.00 0.00 0.00 0.26 0.67 0.67
C 0.26 1.00 1.00 0.00 0.00 0.00 0.26 0.67 0.67
D 0.58 0.00 0.00 1.00 1.00 1.00 0.58 0.25 0.25
E 0.58 0.00 0.00 1.00 1.00 1.00 0.58 0.25 0.25
F 0.58 0.00 0.00 1.00 1.00 1.00 0.58 0.25 0.25
G 0.67 0.26 0.26 0.58 0.58 0.58 1.00 0.00 0.00
H 0.00 0.67 0.67 0.25 0.25 0.25 0.00 1.00 0.75
I 0.00 0.67 0.67 0.25 0.25 0.25 0.00 0.75 1.00</code></pre>
</div>
</div>
<p>Note that structurally equivalent nodes have similarity scores equal to 1.0. In this case, the distance matrix is given by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   D <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And a hierarchical clustering on this matrix reveals the structurally equivalent classes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(D) </span>
<span id="cb18-2"><a href="#cb18-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="similarity_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can package all that we said before into a handy function that takes a graph as input and returns all four normalized similarity metrics as output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   vertex.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-2"><a href="#cb19-2"></a>      A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(x))</span>
<span id="cb19-3"><a href="#cb19-3"></a>      A.p <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A </span>
<span id="cb19-4"><a href="#cb19-4"></a>      A.q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> (<span class="dv">1</span> <span class="sc">-</span> A) </span>
<span id="cb19-5"><a href="#cb19-5"></a>      A.r <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">%*%</span> A </span>
<span id="cb19-6"><a href="#cb19-6"></a>      J <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (A.p <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb19-7"><a href="#cb19-7"></a>      C <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (<span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.q) <span class="sc">*</span> <span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.r))</span>
<span id="cb19-8"><a href="#cb19-8"></a>      D <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb19-9"><a href="#cb19-9"></a>      L <span class="ot">&lt;-</span> A.p <span class="sc">/</span> ((A.p <span class="sc">+</span> A.q) <span class="sc">*</span> (A.p <span class="sc">+</span> A.r))</span>
<span id="cb19-10"><a href="#cb19-10"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">J =</span> J, <span class="at">C =</span> C, <span class="at">D =</span> D, <span class="at">L =</span> L))</span>
<span id="cb19-11"><a href="#cb19-11"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the <em>Flintstones</em> network, we could then find structurally equivalent blocks from the similarity analysis as follows (using Cosine):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   g.flint <span class="ot">&lt;-</span> movie_267</span>
<span id="cb20-2"><a href="#cb20-2"></a>   g.flint <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.flint, <span class="fu">degree</span>(g.flint) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> <span class="fu">vertex.sim</span>(g.flint)<span class="sc">$</span>C)</span>
<span id="cb20-4"><a href="#cb20-4"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="similarity_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can then extract our blocks just like we did with the Euclidean distance hierarchical clustering results in the previous handout:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        BAM-BAM          BARNEY           BETTY        FELDSPAR            FRED 
              1               2               2               3               2 
   HEADMISTRESS      HERDMASTER            LAVA           LEACH          MORRIS 
              4               3               2               5               4 
      MRS SLATE         PEBBLES PEBBLES BAM-BAM        PILTDOWN      POINDEXTER 
              2               1               5               6               5 
         PYRITE           SLATE           WILMA 
              6               2               2 </code></pre>
</div>
</div>
<p>This analysis now puts <span class="math inline">\(\{\)</span><span class="math inline">\(Barney, Betty, Fred, Lava, Mrs. Slate, Slate, Wilma\)</span>}$ in the second block of equivalent actors (shown as the right-most cluster of actors in the dendrogram).</p>
</section>
<section id="generalized-similarities" class="level2">
<h2 class="anchored" data-anchor-id="generalized-similarities">Generalized Similarities</h2>
<p>So far, we have defined distances and similarities mainly as a function of the number of shared neighbors between two nodes. Structural equivalence is an idealized version of this, obtaining whenever people share exactly the same set of neighbors.</p>
<p>Yet, similarities based on local neighborhood information only have been criticized (e.g., by <span class="citation" data-cites="borgatti_everett92">Borgatti and Everett (<a href="#ref-borgatti_everett92" role="doc-biblioref">1992</a>)</span>) for not quite capturing the sociological intuition behind the idea of a <em>role</em> which is usually what they are deployed for. That is, two doctors don’t occupy the same role because they treat the <em>same</em> set of patients (in fact, this would be weird); instead, the set of doctors occupy the same role to the extent they treat a set of actors in the same (or similar) role: Namely, patients, regardless of whether those actors are literally the same or not.</p>
<p>This worry led social network analysts to try to generalize the concept of structural equivalence using less stringent algebraic definition, resulting in something of a proliferation of different equivalences such as <strong>automorphic</strong> or <strong>regular equivalence</strong> <span class="citation" data-cites="borgatti_everett92">(<a href="#ref-borgatti_everett92" role="doc-biblioref">Borgatti and Everett 1992</a>)</span>.</p>
<p>Unfortunately, none of this work led (unlike the work on structural equivalence) to useful or actionable tools for data analysis, with some even concluding that some definitions of equivalence (like regular equivalence) are unlikely to be found in any interesting substantive setting.</p>
<p>A better approach here is to use the more relaxed notion of similarity like we did above to come up with a more general definition that can capture our role-based intuitions. Note that all the similarity notions studied earlier have structural equivalence as the limiting case of maximum similarity. So they are still based on the idea that <em>nodes are similar to the extent they connect to the same others</em>.</p>
<p>We can generalize this idea (to deal with the doctor/patient role problem) in the following way: <em>nodes are similar to the extent they connect to similar others</em>, with the restriction that we can only use endogenous (structural connectivity) information—like with structural equivalence or common-neighbor approaches—to define everyone’s similarity (no exogenous attribute stuff).</p>
<p>As <span class="citation" data-cites="jeh_widom02">Jeh and Widom (<a href="#ref-jeh_widom02" role="doc-biblioref">2002</a>)</span> note, this approach does lead to a coherent generalization of the idea of similarity for nodes in graphs because we can just define similarity <em>recursively</em> and iterate through the graph until the similarity scores stop changing.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> More specifically, they propose to measure the similarity between two nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> at each time-step in the iteration using the formula:</p>
<p><span class="math display">\[\begin{equation}
   s_{ij}(t) = \frac{\alpha}{d_i d_j} \sum_{k \in N(i)} \sum_{l \in N(j)} s_{kl}(t-1)
\end{equation}\]</span></p>
<p>So the similarity between two nodes at step <span class="math inline">\(t\)</span> is just the sum of the pairwise similarities between each of their neighbors (computed in the previous step, <span class="math inline">\(t-1\)</span>), weighted by the ratio of a free parameter <span class="math inline">\(\alpha\)</span> (a number between zero and one) to the product of their degrees (to take a weighted average).</p>
<p>This measure nicely captures the idea that nodes are similar to the extent they both connect to people who are themselves similar. Note that it doesn’t matter whether these neighbors are shared between the two nodes (the summation occurs over each pair of nodes in <span class="math inline">\(p\)</span> + <span class="math inline">\(q\)</span> versus <span class="math inline">\(p\)</span> + <span class="math inline">\(r\)</span> as defined earlier) or whether the set of neighbors are themselves neighbors, which deals with the doctor/patient problem.</p>
<p>A function that implements this idea looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>   SimRank.in <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">C =</span> <span class="fl">0.8</span>, <span class="at">iter =</span> <span class="dv">10</span>) {</span>
<span id="cb23-2"><a href="#cb23-2"></a>      d <span class="ot">&lt;-</span> <span class="fu">colSums</span>(A)</span>
<span id="cb23-3"><a href="#cb23-3"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb23-4"><a href="#cb23-4"></a>      S <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n)</span>
<span id="cb23-5"><a href="#cb23-5"></a>      <span class="fu">rownames</span>(S) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb23-6"><a href="#cb23-6"></a>      <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb23-7"><a href="#cb23-7"></a>      m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>      <span class="cf">while</span>(m <span class="sc">&lt;</span> iter) {</span>
<span id="cb23-9"><a href="#cb23-9"></a>          <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb23-10"><a href="#cb23-10"></a>               <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb23-11"><a href="#cb23-11"></a>                    <span class="cf">if</span> (i <span class="sc">&lt;</span> j) {</span>
<span id="cb23-12"><a href="#cb23-12"></a>                        a <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[, i] <span class="sc">==</span> <span class="dv">1</span>)) </span>
<span id="cb23-13"><a href="#cb23-13"></a>                        b <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[, j] <span class="sc">==</span> <span class="dv">1</span>)) </span>
<span id="cb23-14"><a href="#cb23-14"></a>                        Sij <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-15"><a href="#cb23-15"></a>                        <span class="cf">for</span> (k <span class="cf">in</span> a) {</span>
<span id="cb23-16"><a href="#cb23-16"></a>                           <span class="cf">for</span> (l <span class="cf">in</span> b) {</span>
<span id="cb23-17"><a href="#cb23-17"></a>                              Sij <span class="ot">&lt;-</span> Sij <span class="sc">+</span> S[k, l] <span class="co">#i's similarity to j</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>                           }</span>
<span id="cb23-19"><a href="#cb23-19"></a>                        }</span>
<span id="cb23-20"><a href="#cb23-20"></a>                        S[i, j] <span class="ot">&lt;-</span> C<span class="sc">/</span>(d[i] <span class="sc">*</span> d[j]) <span class="sc">*</span> Sij</span>
<span id="cb23-21"><a href="#cb23-21"></a>                        S[j, i] <span class="ot">&lt;-</span> C<span class="sc">/</span>(d[i] <span class="sc">*</span> d[j]) <span class="sc">*</span> Sij</span>
<span id="cb23-22"><a href="#cb23-22"></a>                    }</span>
<span id="cb23-23"><a href="#cb23-23"></a>               }</span>
<span id="cb23-24"><a href="#cb23-24"></a>          }</span>
<span id="cb23-25"><a href="#cb23-25"></a>         m <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb23-26"><a href="#cb23-26"></a>      }</span>
<span id="cb23-27"><a href="#cb23-27"></a>   <span class="fu">return</span>(S)</span>
<span id="cb23-28"><a href="#cb23-28"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that this function calculates <code>SimRank</code> using each node’s in-neighbors (this doesn’t matter if the graph is undirected).</p>
<p>Let’s try it out in the <em>Flintstones</em> graph using <span class="math inline">\(\alpha = 0.95\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g.flint))</span>
<span id="cb24-2"><a href="#cb24-2"></a>   S <span class="ot">&lt;-</span> <span class="fu">SimRank.in</span>(A, <span class="fl">0.95</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a>   <span class="fu">round</span>(S[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                BAM-BAM BARNEY BETTY FELDSPAR FRED
BAM-BAM            1.00   0.46  0.47     0.52 0.47
BARNEY             0.46   1.00  0.47     0.45 0.48
BETTY              0.47   0.47  1.00     0.48 0.47
FELDSPAR           0.52   0.45  0.48     1.00 0.46
FRED               0.47   0.48  0.47     0.46 1.00
HEADMISTRESS       0.47   0.48  0.46     0.44 0.48
HERDMASTER         0.48   0.47  0.48     0.57 0.48
LAVA               0.48   0.47  0.47     0.49 0.48
LEACH              0.49   0.48  0.48     0.53 0.47
MORRIS             0.49   0.48  0.47     0.44 0.47
MRS SLATE          0.47   0.46  0.47     0.48 0.47
PEBBLES            0.51   0.47  0.48     0.53 0.48
PEBBLES BAM-BAM    0.49   0.48  0.48     0.48 0.48
PILTDOWN           0.47   0.48  0.47     0.52 0.48
POINDEXTER         0.47   0.47  0.48     0.51 0.47
PYRITE             0.47   0.48  0.47     0.52 0.48
SLATE              0.47   0.47  0.48     0.50 0.48
WILMA              0.47   0.47  0.48     0.48 0.47</code></pre>
</div>
</div>
<p>We can transform the generalized similarities to distances and plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb26-2"><a href="#cb26-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="similarity_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        BAM-BAM          BARNEY           BETTY        FELDSPAR            FRED 
              1               2               3               4               2 
   HEADMISTRESS      HERDMASTER            LAVA           LEACH          MORRIS 
              5               4               3               6               5 
      MRS SLATE         PEBBLES PEBBLES BAM-BAM        PILTDOWN      POINDEXTER 
              3               1               6               4               6 
         PYRITE           SLATE           WILMA 
              4               3               3 </code></pre>
</div>
</div>
<p>Which returns a somewhat different role partition than the metrics relying on structural equivalence. In the SimRank equivalence partition, <span class="math inline">\(\{Fred, Barney\}\)</span> are in their own standalone class, while <span class="math inline">\(\{Betty, Wilma, Slate, Mrs. Slate, Lava\}\)</span> appear as a separate cluster.</p>
</section>
<section id="global-similarity-indices" class="level2">
<h2 class="anchored" data-anchor-id="global-similarity-indices">Global Similarity Indices</h2>
<p>As we saw earlier, the most important ingredient of structural similarity measures between pairs of nodes is the number of common of neighbors (followed by the degrees of each node), and this quantity is given by the square of the adjacency matrix <span class="math inline">\(\mathbf{A}^2\)</span>. So we can say that this matrix gives us a basic similarity measure between nodes, namely, the common neighbors similarity:</p>
<p><span class="math display">\[
\mathbf{S} = \mathbf{A}^2
\]</span></p>
<p>Another way of seeing this is that a common neighbor defines a <em>path of length two</em> between a pair of nodes. So the number of common neighbors between two nodes is equivalent to the number of paths of length two between them. We are thus saying that the <em>similarity between two nodes increases as the number of paths of length two between them increases</em>, and that info is also recorded in the <span class="math inline">\(\mathbf{A}^2\)</span> matrix.</p>
<section id="the-local-path-similarity-index" class="level3">
<h3 class="anchored" data-anchor-id="the-local-path-similarity-index">The Local Path Similarity Index</h3>
<p>But if the similarity between node pairs increases in the number of paths of length two between them, wouldn’t nodes be even more similar if they also have a bunch of paths of length <em>three</em> between them?</p>
<p><span class="citation" data-cites="lu_etal09">Lü, Jin, and Zhou (<a href="#ref-lu_etal09" role="doc-biblioref">2009</a>)</span> asked themselves the same question and proposed the following as a similarity metric based on paths:</p>
<p><span class="math display">\[\begin{equation}
\mathbf{S} = \mathbf{A}^2 + \alpha \mathbf{A}^3
\end{equation}\]</span></p>
<p>This is the so-called <strong>local path similarity index</strong> <span class="citation" data-cites="lu_etal09">(<a href="#ref-lu_etal09" role="doc-biblioref">Lü, Jin, and Zhou 2009</a>)</span>. Obviously, structurally equivalent nodes will be counted as similar by this metric (lots of paths of length two between them) but also nodes indirectly connected by many paths of length three, but to a lesser extent given the discount parameter <span class="math inline">\(\alpha\)</span> (a number between zero and one).</p>
<p>A function that does this is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>   local.path <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">alpha =</span> <span class="fl">0.5</span>) {</span>
<span id="cb29-2"><a href="#cb29-2"></a>      A2 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A</span>
<span id="cb29-3"><a href="#cb29-3"></a>      S <span class="ot">&lt;-</span> A2 <span class="sc">+</span> alpha<span class="sc">*</span>(A2 <span class="sc">%*%</span> A)</span>
<span id="cb29-4"><a href="#cb29-4"></a>   <span class="fu">return</span>(S)</span>
<span id="cb29-5"><a href="#cb29-5"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s how the local path similarity looks in the <em>Flintstones</em> network:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g.flint))</span>
<span id="cb30-2"><a href="#cb30-2"></a>   S <span class="ot">&lt;-</span> <span class="fu">local.path</span>(A)</span>
<span id="cb30-3"><a href="#cb30-3"></a>   S[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         20.0   29.5  30.5      6.5 31.5         12.5        9.5 25.0
BARNEY          29.5   50.0  51.0     13.0 52.0         21.0       21.0 46.5
BETTY           30.5   51.0  52.0     11.0 53.0         24.0       18.0 46.0
FELDSPAR         6.5   13.0  11.0      3.0 13.5          4.5        5.0 10.0
FRED            31.5   52.0  53.0     13.5 55.0         21.5       21.5 47.5
HEADMISTRESS    12.5   21.0  24.0      4.5 21.5         13.0        6.5 21.5
HERDMASTER       9.5   21.0  18.0      5.0 21.5          6.5       10.0 17.0
LAVA            25.0   46.5  46.0     10.0 47.5         21.5       17.0 42.0
LEACH            9.5   15.5  16.0      3.5 17.5          7.5        5.5 15.5
MORRIS           8.5   13.0  15.5      2.5 13.0          8.0        3.5 12.5
             LEACH MORRIS
BAM-BAM        9.5    8.5
BARNEY        15.5   13.0
BETTY         16.0   15.5
FELDSPAR       3.5    2.5
FRED          17.5   13.0
HEADMISTRESS   7.5    8.0
HERDMASTER     5.5    3.5
LAVA          15.5   12.5
LEACH          6.0    4.0
MORRIS         4.0    6.0</code></pre>
</div>
</div>
<p>Of course as <span class="math inline">\(\alpha\)</span> approaches zero, then the local path measure reduces to the number of common neighbors, while numbers closer to one count paths of length three more.</p>
<p>Another thing people may wonder if why not keep going and add paths of length four:</p>
<p><span class="math display">\[\begin{equation}
\mathbf{S} = \mathbf{A}^2 + \alpha \mathbf{A}^3 + \alpha^2 \mathbf{A}^4
\end{equation}\]</span></p>
<p>Or paths of length whatever:</p>
<p><span class="math display">\[
\mathbf{S} = \mathbf{A}^2 + \alpha \mathbf{A}^3 + \alpha^2 \mathbf{A}^4 ... + \alpha^{k-2} \mathbf{A}^k
\]</span></p>
<p>Where <span class="math inline">\(k\)</span> is the length of the maximum path considered. <span class="citation" data-cites="lu_etal09">Lü, Jin, and Zhou (<a href="#ref-lu_etal09" role="doc-biblioref">2009</a>)</span> argue that these higher order paths don’t matter, so maybe we don’t have to worry about them.</p>
</section>
<section id="the-katz-similarity" class="level3">
<h3 class="anchored" data-anchor-id="the-katz-similarity">The Katz Similarity</h3>
<p>Another issue is that there was already an all-paths similarity measure in existence, one developed by the mathematical social scientist Leo <span class="citation" data-cites="katz53">Katz (<a href="#ref-katz53" role="doc-biblioref">1953</a>)</span> in the 1950s (!).</p>
<p>The basic idea was to use linear algebra tricks to solve:</p>
<p><span class="math display">\[
\mathbf{S} = \sum_{k=1}^{\infty} \alpha^k \mathbf{A}^k
\]</span></p>
<p>Which would theoretically count the <em>all</em> the paths of <em>all possible lengths</em> between two nodes while discounting the contribution of the longer paths in proportion to their length (as <span class="math inline">\(k\)</span> gets bigger, with <span class="math inline">\(\alpha\)</span> a number between zero and one, <span class="math inline">\(\alpha^k\)</span> gets smaller and smaller).</p>
<p>Linear algebra hocus-pocus (non-technical explainer <a href="https://olizardo.github.io/networks-textbook/lesson-sna-status.html#a-mathy-interlude">here</a>) turns the above infinite sum into the more tractable:</p>
<p><span class="math display">\[
\mathbf{S} = (\mathbf{I} - \alpha \mathbf{A})^{-1}
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{I}\)</span> is the <strong>identity matrix</strong> (a matrix of all zeros except that it has the number one in each diagonal cell) of the same dimensions as the original. Raising the result of the subtraction in parentheses to minus one indicates the <strong>matrix inverse</strong> operation (most matrices are invertible, unless they are weird).</p>
<p>A function to compute the <strong>Katz similarity</strong> between all node pairs looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>   katz.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(w) {</span>
<span id="cb32-2"><a href="#cb32-2"></a>      I <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">nrow</span>(w)) <span class="co">#creating identity matrix</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>      alpha <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">eigen</span>(w)<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1e-10</span> <span class="co">#reciprocal of first eigenvalue of adjacency matrix minus a tiny number</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>      S <span class="ot">&lt;-</span> <span class="fu">solve</span>(I <span class="sc">-</span> alpha <span class="sc">*</span> w) </span>
<span id="cb32-5"><a href="#cb32-5"></a>      <span class="fu">return</span>(S)</span>
<span id="cb32-6"><a href="#cb32-6"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function takes the network’s adjacency matrix (<code>w</code>) as input and returns the <strong>Katz similarity matrix</strong> (<code>S</code>) as output.</p>
<p>For technical reasons (e.g., guarantee that the infinite sum converges) we need to choose <span class="math inline">\(\alpha\)</span> to be a number larger than zero but smaller than the reciprocal of the first eigenvalue of the matrix. Here we just pick the reciprocal of the largest (first) eigenvalue minus a very small number (<span class="math inline">\(10^{-10}\)</span>).</p>
<p>Line 4 computes the actual Katz similarity using the native <code>R</code> function <code>solve</code> to find the relevant matrix inverse.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>In the <em>Flintstones</em> network the Katz similarity looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>   <span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>   S <span class="ot">&lt;-</span> <span class="fu">katz.sim</span>(A)</span>
<span id="cb33-3"><a href="#cb33-3"></a>   <span class="fu">round</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              BAM-BAM    BARNEY     BETTY FELDSPAR      FRED HEADMISTRESS
BAM-BAM      43912268  75530407  76630126 17269355  78596698     34072232
BARNEY       75530407 129914551 131806098 29703805 135188661     58605253
BETTY        76630126 131806098 133725188 30136290 137157000     59458542
FELDSPAR     17269355  29703805  30136290  6791511  30909683     13399569
FRED         78596698 135188661 137157000 30909683 140676885     60984437
HEADMISTRESS 34072232  58605253  59458542 13399569  60984437     26437192
HERDMASTER   28235263  48565494  49272605 11104068  50537096     21908193
LAVA         68595891 117986974 119704858 26976671 122776865     53224651
LEACH        24107266  41465215  42068946  9480652  43148569     18705214
MORRIS       21013980  36144672  36670936  8264157  37612029     16305084
             HERDMASTER      LAVA    LEACH   MORRIS
BAM-BAM        28235263  68595891 24107266 21013980
BARNEY         48565494 117986974 41465215 36144672
BETTY          49272605 119704858 42068946 36670936
FELDSPAR       11104068  26976671  9480652  8264157
FRED           50537096 122776865 43148569 37612029
HEADMISTRESS   21908193  53224651 18705214 16305084
HERDMASTER     18155067  44106651 15500794 13511834
LAVA           44106651 107154482 37658255 32826196
LEACH          15500794  37658255 13234577 11536403
MORRIS         13511834  32826196 11536403 10056129</code></pre>
</div>
</div>
<p>Which are pretty big numbers! Which makes sense, since these are estimates of <em>all</em> the paths of <em>any</em> length between every pair of nodes in the network. We can get more tractable figures by normalizing the matrix by its maximum:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>   S <span class="ot">&lt;-</span> S<span class="sc">/</span><span class="fu">max</span>(S)</span>
<span id="cb35-2"><a href="#cb35-2"></a>   <span class="fu">round</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         0.31   0.54  0.54     0.12 0.56         0.24       0.20 0.49
BARNEY          0.54   0.92  0.94     0.21 0.96         0.42       0.35 0.84
BETTY           0.54   0.94  0.95     0.21 0.97         0.42       0.35 0.85
FELDSPAR        0.12   0.21  0.21     0.05 0.22         0.10       0.08 0.19
FRED            0.56   0.96  0.97     0.22 1.00         0.43       0.36 0.87
HEADMISTRESS    0.24   0.42  0.42     0.10 0.43         0.19       0.16 0.38
HERDMASTER      0.20   0.35  0.35     0.08 0.36         0.16       0.13 0.31
LAVA            0.49   0.84  0.85     0.19 0.87         0.38       0.31 0.76
LEACH           0.17   0.29  0.30     0.07 0.31         0.13       0.11 0.27
MORRIS          0.15   0.26  0.26     0.06 0.27         0.12       0.10 0.23
             LEACH MORRIS
BAM-BAM       0.17   0.15
BARNEY        0.29   0.26
BETTY         0.30   0.26
FELDSPAR      0.07   0.06
FRED          0.31   0.27
HEADMISTRESS  0.13   0.12
HERDMASTER    0.11   0.10
LAVA          0.27   0.23
LEACH         0.09   0.08
MORRIS        0.08   0.07</code></pre>
</div>
</div>
<p>Which looks better. As we would expect, Fred is very similar to Barney and Betty. We can then do the standard hierarchical clustering to see how this similarity measure groups nodes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb37-2"><a href="#cb37-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="similarity_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        BAM-BAM          BARNEY           BETTY        FELDSPAR            FRED 
              1               2               2               3               2 
   HEADMISTRESS      HERDMASTER            LAVA           LEACH          MORRIS 
              4               4               5               3               3 
      MRS SLATE         PEBBLES PEBBLES BAM-BAM        PILTDOWN      POINDEXTER 
              1               1               6               6               6 
         PYRITE           SLATE           WILMA 
              6               5               5 </code></pre>
</div>
</div>
<p>The Katz similarity (correctly) assigns Fred, Barney, Betty, Wilma (along with Slate and Lava) to the same group, and puts the kids in a separate block.</p>
</section>
<section id="degree-weighted-katz-similarity-aka-leicht-holme-newman" class="level3">
<h3 class="anchored" data-anchor-id="degree-weighted-katz-similarity-aka-leicht-holme-newman">Degree-Weighted Katz Similarity (AKA Leicht-Holme-Newman)</h3>
<p><span class="citation" data-cites="leicht_etal06">Leicht, Holme, and Newman (<a href="#ref-leicht_etal06" role="doc-biblioref">2006</a>)</span> argue that the Katz approach is fine and dandy as a similarity measure, but note that is an unweighted index (like the raw number of common neighbors). This means that nodes with large degree will end up being “similar” to a bunch of other nodes in the graph, just because they have lots of paths of length whatever between them and those nodes.</p>
<p><span class="citation" data-cites="leicht_etal06">Leicht, Holme, and Newman (<a href="#ref-leicht_etal06" role="doc-biblioref">2006</a>)</span> propose a “fix” for this weakness in the Katz similarity, resulting in the matrix linear algebra equivalent of a degree-normalized similarity measure like the Jaccard or Cosine.</p>
<p>So instead of Katz they suggest we compute:</p>
<p><span class="math display">\[
\mathbf{S} = \mathbf{D}^{-1} \left( \frac{\alpha A}{\lambda_1} \right)^{-1} \mathbf{D}^{-1}
\]</span></p>
<p>Here <span class="math inline">\(\mathbf{D}\)</span> is a matrix containing the degrees of each node along the diagonal. The inverse of this matrix <span class="math inline">\(\mathbf{D}^{-1}\)</span> will contain the <em>reciprocal</em> of each degree <span class="math inline">\(1/k_i\)</span> along the diagonals. <span class="math inline">\(\lambda_1\)</span>, on the other hand, is just the first eigenvalue of the adjacency matrix.</p>
<p>So, the <strong>LHN Similarity</strong> is just the Katz similarity weighted by the degree of the sender and receiver node along each path, further discounting paths featuring high-degree nodes at either or both ends.</p>
<p>Which leads to the function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>   LHN.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">alpha =</span> <span class="fl">0.9</span>) {</span>
<span id="cb40-2"><a href="#cb40-2"></a>      D <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">diag</span>(<span class="fu">rowSums</span>(A))) <span class="co">#inverse of degree matrix</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>      lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A)<span class="sc">$</span>values[<span class="dv">1</span>] <span class="co">#first eigenvalue of adjacency matrix</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>      S <span class="ot">&lt;-</span> D <span class="sc">%*%</span> <span class="fu">solve</span>((alpha <span class="sc">*</span> A)<span class="sc">/</span>lambda) <span class="sc">%*%</span> D <span class="co">#LHN index</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>      <span class="fu">rownames</span>(S) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb40-6"><a href="#cb40-6"></a>      <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb40-7"><a href="#cb40-7"></a>      <span class="fu">return</span>(S)</span>
<span id="cb40-8"><a href="#cb40-8"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the <em>Flintstones</em> result:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">LHN.sim</span>(A)</span>
<span id="cb41-2"><a href="#cb41-2"></a>   <span class="fu">round</span>(S[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                BAM-BAM BARNEY BETTY FELDSPAR  FRED
BAM-BAM           -0.09   0.01  0.01    -0.16 -0.01
BARNEY             0.01  -0.02  0.00     0.11  0.01
BETTY              0.01   0.00 -0.04    -0.48  0.00
FELDSPAR          -0.16   0.11 -0.48    -2.55  0.25
FRED              -0.01   0.01  0.00     0.25 -0.01
HEADMISTRESS       0.20   0.05 -0.13    -2.96 -0.05
HERDMASTER         0.16   0.08  0.10     0.07 -0.07
LAVA               0.00  -0.02 -0.02    -0.42  0.02
LEACH             -0.27  -0.10  0.04     2.01  0.09
MORRIS            -0.25  -0.03  0.12     1.90  0.03
MRS SLATE         -0.05   0.01  0.04     0.74 -0.01
PEBBLES            0.19   0.01  0.01    -0.16 -0.01
PEBBLES BAM-BAM    0.03   0.00  0.03     0.16  0.00
PILTDOWN           0.00   0.00  0.00    -0.35  0.00
POINDEXTER         0.01   0.03  0.04     0.66 -0.02
PYRITE             0.00   0.00  0.00    -0.35  0.00
SLATE             -0.08  -0.01  0.04     0.91  0.01
WILMA              0.01   0.00  0.02     0.09  0.00</code></pre>
</div>
</div>
<p>Note that as <span class="citation" data-cites="leicht_etal06">Leicht, Holme, and Newman (<a href="#ref-leicht_etal06" role="doc-biblioref">2006</a>)</span> discuss, the entries in the <strong>LHN</strong> version of the similarity <span class="math inline">\(\mathbf{S}\)</span> can be either positive or negative. Negative entries are nodes that are <em>surprisingly</em> dissimilar given their degrees, and positive numbers indicating node pairs that are <em>surprisingly</em> similar. Numbers closer to zero are nodes that are neither similar nor dissimilar given their degrees.</p>
<p>Here we can see that Barney and Fred are actually not that similar to one another (after we take into account their very high degree) and that Barney is actually most similar to Feldspar (and Fred even more so).</p>
<p>Because the LHN similarities have negative and positive values, they already define a distance between nodes in the graph, like the correlation distance. So if we wanted to find blocks of actors using this similarity criterion, all we need to do is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(S)</span>
<span id="cb43-2"><a href="#cb43-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="similarity_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>   blocks <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">8</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        BAM-BAM          BARNEY           BETTY        FELDSPAR            FRED 
              1               2               1               3               2 
   HEADMISTRESS      HERDMASTER            LAVA           LEACH          MORRIS 
              4               5               1               6               7 
      MRS SLATE         PEBBLES PEBBLES BAM-BAM        PILTDOWN      POINDEXTER 
              8               1               2               1               8 
         PYRITE           SLATE           WILMA 
              1               8               2 </code></pre>
</div>
</div>
<p>It seems like this approach is geared towards finding smaller, more fine-grained clusters of similar actors in the data.</p>
</section>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<p>A more general (and shorter) version of the function to compute <code>SimRank</code> looks like this <span class="citation" data-cites="fouss_etal16">(partly based on <a href="#ref-fouss_etal16" role="doc-biblioref">Fouss, Saerens, and Shimbo 2016, 84</a>, algorithm 2.4)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>   SimRank <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">sigma =</span> <span class="fl">0.0001</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) {</span>
<span id="cb46-2"><a href="#cb46-2"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb46-3"><a href="#cb46-3"></a>      d <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">colSums</span>(A) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb46-4"><a href="#cb46-4"></a>      e <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, n, <span class="dv">1</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a>      Q <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(e) <span class="sc">%*%</span> A), n, n)</span>
<span id="cb46-6"><a href="#cb46-6"></a>      <span class="fu">diag</span>(Q) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(Q)</span>
<span id="cb46-7"><a href="#cb46-7"></a>      Q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> Q</span>
<span id="cb46-8"><a href="#cb46-8"></a>      Q[<span class="fu">is.nan</span>(Q)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>      diff <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>      k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>      K <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n)</span>
<span id="cb46-12"><a href="#cb46-12"></a>      <span class="cf">while</span>(diff <span class="sc">&gt;</span> sigma) {</span>
<span id="cb46-13"><a href="#cb46-13"></a>         K.old <span class="ot">&lt;-</span> K</span>
<span id="cb46-14"><a href="#cb46-14"></a>         K.p <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">t</span>(Q) <span class="sc">%*%</span> K <span class="sc">%*%</span> Q</span>
<span id="cb46-15"><a href="#cb46-15"></a>         K <span class="ot">&lt;-</span> K.p <span class="sc">-</span> <span class="fu">diag</span>(<span class="fu">as.vector</span>(<span class="fu">diag</span>(K.p)), n, n) <span class="sc">+</span> <span class="fu">diag</span>(d, n, n)</span>
<span id="cb46-16"><a href="#cb46-16"></a>         diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(K.old)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(K)))</span>
<span id="cb46-17"><a href="#cb46-17"></a>         k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb46-18"><a href="#cb46-18"></a>      }</span>
<span id="cb46-19"><a href="#cb46-19"></a>      <span class="fu">rownames</span>(K) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb46-20"><a href="#cb46-20"></a>      <span class="fu">colnames</span>(K) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb46-21"><a href="#cb46-21"></a>      <span class="fu">return</span>(K)</span>
<span id="cb46-22"><a href="#cb46-22"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-borgatti_everett92" class="csl-entry" role="doc-biblioentry">
Borgatti, Stephen P, and Martin G Everett. 1992. <span>“Notions of Position in Social Network Analysis.”</span> <em>Sociological Methodology</em> 22: 1–35.
</div>
<div id="ref-fouss_etal16" class="csl-entry" role="doc-biblioentry">
Fouss, François, Marco Saerens, and Masashi Shimbo. 2016. <em>Algorithms and Models for Network Data and Link Analysis</em>. Cambridge University Press.
</div>
<div id="ref-jeh_widom02" class="csl-entry" role="doc-biblioentry">
Jeh, Glen, and Jennifer Widom. 2002. <span>“Simrank: A Measure of Structural-Context Similarity.”</span> In <em>Proceedings of the Eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 538–43.
</div>
<div id="ref-katz53" class="csl-entry" role="doc-biblioentry">
Katz, Leo. 1953. <span>“A New Status Index Derived from Sociometric Analysis.”</span> <em>Psychometrika</em> 18 (1): 39–43.
</div>
<div id="ref-kleinberg99" class="csl-entry" role="doc-biblioentry">
Kleinberg, Jon M. 1999. <span>“Authoritative Sources in a Hyperlinked Environment.”</span> <em>Journal of the ACM (JACM)</em> 46 (5): 604–32.
</div>
<div id="ref-leicht_etal06" class="csl-entry" role="doc-biblioentry">
Leicht, Elizabeth A, Petter Holme, and Mark EJ Newman. 2006. <span>“Vertex Similarity in Networks.”</span> <em>Physical Review E—Statistical, Nonlinear, and Soft Matter Physics</em> 73 (2): 026120.
</div>
<div id="ref-lu_etal09" class="csl-entry" role="doc-biblioentry">
Lü, Linyuan, Ci-Hang Jin, and Tao Zhou. 2009. <span>“Similarity Index Based on Local Paths for Link Prediction of Complex Networks.”</span> <em>Phys. Rev. E</em> 80: 046122.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Note the similarity (heh, heh) between this idea and the various status ranking algorithms we discussed in the previous handout.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>See <a href="https://cran.r-project.org/web/packages/matlib/vignettes/inv-ex1.html">here</a> for an explainer of the matrix inverse in general and its computation in <code>R</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>