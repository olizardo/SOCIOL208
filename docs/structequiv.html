<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Role Equivalence and Structural Similarity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Role Equivalence and Structural Similarity">
<meta property="og:description" content="One of the earlier “proofs of concept” of the power of social network analysis came from demonstrating that you could formalize the fuzzy idea of “role” central to functionalist sociology and…">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Role Equivalence and Structural Similarity</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">Matrix Eigendecomposition</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Centrality and Prestige</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centrality.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Centrality Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-centrality.html" class="sidebar-item-text sidebar-link">Centrality in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pagerank.html" class="sidebar-item-text sidebar-link">PageRank Prestige Scoring</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hits.html" class="sidebar-item-text sidebar-link">Hubs and Authorities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Equivalence and Similarity</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link active">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-walk.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-similarity.html" class="sidebar-item-text sidebar-link">Similarity and Equivalence in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Communities and Clustering</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-community-ca.html" class="sidebar-item-text sidebar-link">Community Detection in Two-Mode Networks Using CA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-spectral.html" class="sidebar-item-text sidebar-link">Spectral Clustering of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Two-Mode Networks</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-basic.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-duality.html" class="sidebar-item-text sidebar-link">The Duality of Persons and Groups</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-reflections.html" class="sidebar-item-text sidebar-link">The Method of Reflections in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-fitness.html" class="sidebar-item-text sidebar-link">Fitness and Complexity in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-null.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link">Extracting the Backbone of Bipartite Projections Using Two-Mode Graph Ensembles</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Data Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loading.html" class="sidebar-item-text sidebar-link">Loading Network Data from a File</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-lists.html" class="sidebar-item-text sidebar-link">Handling Graph Objects in Lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subgraph-select.html" class="sidebar-item-text sidebar-link">Selecting a Subgraph Based on Edge Conditions</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#structural-equivalence" id="toc-structural-equivalence" class="nav-link active" data-scroll-target="#structural-equivalence">Structural Equivalence</a></li>
  <li><a href="#structural-equivalence-in-an-ideal-world" id="toc-structural-equivalence-in-an-ideal-world" class="nav-link" data-scroll-target="#structural-equivalence-in-an-ideal-world">Structural Equivalence in an Ideal World</a></li>
  <li><a href="#structural-equivalence-in-the-real-world" id="toc-structural-equivalence-in-the-real-world" class="nav-link" data-scroll-target="#structural-equivalence-in-the-real-world">Structural Equivalence in the Real World</a></li>
  <li><a href="#concor" id="toc-concor" class="nav-link" data-scroll-target="#concor">CONCOR</a></li>
  <li><a href="#structural-equivalence-in-directed-graphs" id="toc-structural-equivalence-in-directed-graphs" class="nav-link" data-scroll-target="#structural-equivalence-in-directed-graphs">Structural Equivalence in Directed Graphs</a></li>
  <li><a href="#structural-equivalence-in-multigraphs" id="toc-structural-equivalence-in-multigraphs" class="nav-link" data-scroll-target="#structural-equivalence-in-multigraphs">Structural Equivalence in Multigraphs</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/structequiv.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Role Equivalence and Structural Similarity</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>One of the earlier “proofs of concept” of the power of social network analysis came from demonstrating that you could formalize the fuzzy idea of “role” central to functionalist sociology and British social anthropology using the combined tools of graph theoretical and matrix representations of networks <span class="citation" data-cites="white_etal76">(<a href="#ref-white_etal76" role="doc-biblioref">White, Boorman, and Breiger 1976</a>)</span>.</p>
<p>This and other contemporaneous work <span class="citation" data-cites="breiger_etal75">(<a href="#ref-breiger_etal75" role="doc-biblioref">Breiger, Boorman, and Arabie 1975</a>)</span> set off an entire sub-tradition of data analysis of networks focused on the idea that one could <em>partition</em> the set of vertices in a graph into meaningful classes based on some mathematical (e.g., graph theoretic) criterion.</p>
<p>These classes would in turn would be isomorphic with the concept of role as <em>social position</em> and the classes thereby derived as indicating the number of such positions in the social structure under investigation as well as which actors belonged to which positions.</p>
<section id="structural-equivalence" class="level2">
<h2 class="anchored" data-anchor-id="structural-equivalence">Structural Equivalence</h2>
<p>The earliest work pursued simultaneously by analysts at Harvard <span class="citation" data-cites="white_etal76">(<a href="#ref-white_etal76" role="doc-biblioref">White, Boorman, and Breiger 1976</a>)</span> and Chicago <span class="citation" data-cites="burt76">(<a href="#ref-burt76" role="doc-biblioref">Burt 1976</a>)</span> relied on the idea of <strong>structural equivalence</strong>.</p>
<p>In a graph <span class="math inline">\(G = \{E, V\}\)</span> two nodes <span class="math inline">\(v_i, v_j\)</span> are structurally equivalent if they are connected to the same others in the network; that is, if <span class="math inline">\(N(v_i)\)</span> is the set of nodes adjacent to node <span class="math inline">\(v_i\)</span> and <span class="math inline">\(N(v_j)\)</span> is the set of nodes adjacent to node <span class="math inline">\(v_j\)</span>, then:</p>
<p><span class="math display">\[
   v_i \equiv v_j \iff N(v_i) = N(v_j)
\]</span></p>
<p>In a graph, an equivalence class <span class="math inline">\(C\)</span> is just a set of nodes that are structurally equivalent, such that if <span class="math inline">\(v_i \in C_i\)</span> and <span class="math inline">\(v_j \in C_i\)</span> then <span class="math inline">\(v_i \equiv v_j\)</span> for all pairs <span class="math inline">\((v_i, v_j) \in C_i\)</span>.</p>
<p>The partitioning of the vertex set into a set of equivalence classes <span class="math inline">\(\{C_1, C_2 \ldots C_k\}\)</span> as well as the adjacency relations between nodes in the same class and nodes in different classes defines the <strong>role structure</strong> of the network.</p>
</section>
<section id="structural-equivalence-in-an-ideal-world" class="level2">
<h2 class="anchored" data-anchor-id="structural-equivalence-in-an-ideal-world">Structural Equivalence in an Ideal World</h2>
<p>Let us illustrate these concepts. Consider the following toy graph:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-se" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="structequiv_files/figure-html/fig-se-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: A toy graph demonstrating structural equivalence.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>With associated adjacency matrix:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> A </th>
   <th style="text-align:center;"> B </th>
   <th style="text-align:center;"> C </th>
   <th style="text-align:center;"> D </th>
   <th style="text-align:center;"> E </th>
   <th style="text-align:center;"> F </th>
   <th style="text-align:center;"> G </th>
   <th style="text-align:center;"> H </th>
   <th style="text-align:center;"> I </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;border-top: 0.75px solid;"> A </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> B </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> C </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> D </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> E </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> F </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> G </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> H </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> I </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>A simple function to check for structural equivalence in the graph, relying on the native <code>R</code> function <code>setequal</code> would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   check.equiv <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>      n <span class="ot">&lt;-</span> <span class="fu">vcount</span>(x)</span>
<span id="cb1-3"><a href="#cb1-3"></a>      v <span class="ot">&lt;-</span> <span class="fu">V</span>(x)<span class="sc">$</span>name</span>
<span id="cb1-4"><a href="#cb1-4"></a>      E <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb1-5"><a href="#cb1-5"></a>      <span class="cf">for</span> (i <span class="cf">in</span> v) {</span>
<span id="cb1-6"><a href="#cb1-6"></a>         <span class="cf">for</span> (j <span class="cf">in</span> v) {</span>
<span id="cb1-7"><a href="#cb1-7"></a>            <span class="cf">if</span> (i <span class="sc">!=</span> j <span class="sc">&amp;</span> E[<span class="fu">which</span>(v <span class="sc">==</span> j), <span class="fu">which</span>(v <span class="sc">==</span> i)] <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb1-8"><a href="#cb1-8"></a>               N.i <span class="ot">&lt;-</span> <span class="fu">neighbors</span>(x, i)</span>
<span id="cb1-9"><a href="#cb1-9"></a>               N.j <span class="ot">&lt;-</span> <span class="fu">neighbors</span>(x, j)</span>
<span id="cb1-10"><a href="#cb1-10"></a>               <span class="cf">if</span> (<span class="fu">are_adjacent</span>(x, i, j) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-11"><a href="#cb1-11"></a>                  N.i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">names</span>(N.i), i)</span>
<span id="cb1-12"><a href="#cb1-12"></a>                  N.j <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">names</span>(N.j), j)</span>
<span id="cb1-13"><a href="#cb1-13"></a>                  } <span class="co">#end sub-if</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>               <span class="cf">if</span> (<span class="fu">setequal</span>(N.i, N.j) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-15"><a href="#cb1-15"></a>                  E[<span class="fu">which</span>(v <span class="sc">==</span> i), <span class="fu">which</span>(v <span class="sc">==</span> j)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>                  E[<span class="fu">which</span>(v <span class="sc">==</span> j), <span class="fu">which</span>(v <span class="sc">==</span> i)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>                  } <span class="co">#end sub-if</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>               } <span class="co">#end main if</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>            } <span class="co">#end j loop</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>         } <span class="co">#end i loop</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>      <span class="fu">rownames</span>(E) <span class="ot">&lt;-</span> v</span>
<span id="cb1-22"><a href="#cb1-22"></a>      <span class="fu">colnames</span>(E) <span class="ot">&lt;-</span> v</span>
<span id="cb1-23"><a href="#cb1-23"></a>   <span class="fu">return</span>(E)</span>
<span id="cb1-24"><a href="#cb1-24"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function creates an empty “equivalence” matrix <span class="math inline">\(\mathbf{E}\)</span> in line 4, loops through each pair of nodes in the graph in lines 5-20. The main condition restricts the checking to nodes that are not the same or have not yet to be found to be equivalent (line 7). Lines 8-9 extract the node neighborhoods using the <code>igraph</code> function <code>neighbors</code>.</p>
<p>Lines 10-13 check to see if the pair of nodes that are being checked for equivalence are themselves adjacent. If they are indeed adjacent (the conditional in line 10 is <code>TRUE</code>) then we need to use the so-called <strong>closed neighborhood</strong> of <span class="math inline">\(v_i\)</span> and <span class="math inline">\(v_j\)</span>, written <span class="math inline">\(N[v_i], N[v_j]\)</span>, to do the equivalence check, or otherwise we get the wrong answer.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>The equivalence check is done in line 14 using the native <code>R</code> function <code>setequal</code>. This function takes two inputs (e.g., two vectors) and will return a value of <code>TRUE</code> if the elements in the first vector are the same as the elements in the second vector. In that case we update the matrix <span class="math inline">\(\mathbf{E}\)</span> accordingly.</p>
<p>After writing our function, we can then type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   Equiv <span class="ot">&lt;-</span> <span class="fu">check.equiv</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the resulting equivalence matrix <span class="math inline">\(\mathbf{E}\)</span> corresponding to the graph in <a href="#fig-se">Figure&nbsp;1</a> is:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> A </th>
   <th style="text-align:center;"> B </th>
   <th style="text-align:center;"> C </th>
   <th style="text-align:center;"> D </th>
   <th style="text-align:center;"> E </th>
   <th style="text-align:center;"> F </th>
   <th style="text-align:center;"> G </th>
   <th style="text-align:center;"> H </th>
   <th style="text-align:center;"> I </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;border-top: 0.75px solid;"> A </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> B </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> C </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> D </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> E </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> F </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> G </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> H </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> I </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>In this matrix, there is a 1 in the corresponding cell if the row node is structurally equivalent to the column node.</p>
<p>One thing we can do with this matrix is <em>re-order</em> the rows and columns, so that rows(columns) corresponding to nodes that are “adjacent” in the equivalence relation appear next to one another in the matrix.</p>
<p>To do that we can use the <code>corrMatOrder</code> function from the <code>corrplot</code> package, designed to work with correlation matrices, but works with any matrix of values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>   <span class="co">#install.packages("corrplot")</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>   <span class="fu">library</span>(corrplot)</span>
<span id="cb3-3"><a href="#cb3-3"></a>   SE.ord <span class="ot">&lt;-</span> <span class="fu">corrMatOrder</span>(Equiv, <span class="at">order =</span> <span class="st">"hclust"</span>, <span class="at">hclust.method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>   SE.ord</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 4 5 8 9 1 7 2 3</code></pre>
</div>
</div>
<p>The <code>corrplot</code> function <code>corrMatorder</code> takes a matrix as input and returns a vector of reordered values of the rows(columns) as output. We use a hierarchical clustering algorithm using Ward’s method to do the job.</p>
<p>We can see that the new re-ordered vector has the previous row(column) 6 in fist position, 4 at second, five at third, 8 at fourth, and so forth.;</p>
<p>We can then re-order rows and columns of the old equivalence matrix using this new ordering by typing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>   Equiv <span class="ot">&lt;-</span> Equiv[SE.ord, SE.ord]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting re-ordered matrix looks like:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> F </th>
   <th style="text-align:center;"> D </th>
   <th style="text-align:center;"> E </th>
   <th style="text-align:center;"> H </th>
   <th style="text-align:center;"> I </th>
   <th style="text-align:center;"> A </th>
   <th style="text-align:center;"> G </th>
   <th style="text-align:center;"> B </th>
   <th style="text-align:center;"> C </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;border-top: 0.75px solid;"> F </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-top: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> D </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;border-bottom: 3px solid;"> E </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> H </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;border-bottom: 3px solid;"> I </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> A </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;border-bottom: 3px solid;"> G </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-bottom: 3px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> B </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 0.75px solid;border-left: 0.75px solid;"> C </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;border-bottom: 0.75px solid;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Once the equivalence matrix is re-ordered we can see that sets of structurally equivalent nodes in <a href="#fig-se">Figure&nbsp;1</a>, appear clustered along the diagonals. This type of re-arranged matrix is said to be in <strong>block-diagonal</strong> form (e.g., non-zero entries clustered along the diagonals).</p>
<p>Even more interestingly, we can do the same re-arranging on the original adjacency matrix, to reveal:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> F </th>
   <th style="text-align:center;"> D </th>
   <th style="text-align:center;"> E </th>
   <th style="text-align:center;"> H </th>
   <th style="text-align:center;"> I </th>
   <th style="text-align:center;"> A </th>
   <th style="text-align:center;"> G </th>
   <th style="text-align:center;"> B </th>
   <th style="text-align:center;"> C </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> F </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> D </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 3px solid;"> E </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> H </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 3px solid;"> I </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> A </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;border-bottom: 3px solid;"> G </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 3px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> B </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> C </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;border-right: 3px solid;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;border-right: 3px solid;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>This is called a <strong>blocked adjacency matrix</strong>. As you can see, once the structural equivalence relations in the network are revealed by permuting the rows and columns, the adjacency matrix shows an orderly pattern.</p>
<p>The way to interpret the blocked adjacency matrix is as follows:</p>
<ul>
<li><p>The <strong>block diagonals</strong> of the matrix reveal the <em>intra-block</em> relations between sets of structurally equivalent nodes. If the block diagonal is empty–called a <strong>zero block</strong>–it means that set of structurally equivalent nodes does not connect with one another directly. If it has ones–called a <strong>one block</strong>–it it means that members of that set of structurally equivalent nodes are also neighbors.</p></li>
<li><p>The <strong>off diagonal blocks</strong> reveals the <em>inter-block</em> adjacency relations between different clusters of structurally equivalent nodes. If an off-diagonal block is a one-block, it means that members of block <span class="math inline">\(C_i\)</span> send ties to members of block <span class="math inline">\(C_j\)</span>. If and off diagonal block is a zero-block, it means that members of block <span class="math inline">\(C_i\)</span> avoid associating with members of block <span class="math inline">\(C_j\)</span>.</p></li>
</ul>
<p>So if:</p>
<p><span class="math display">\[
C_1 = \{D, E, F\}
\]</span></p>
<p><span class="math display">\[
C_2 = \{H, I\}
\]</span></p>
<p><span class="math display">\[
C_3 = \{A, G\}
\]</span></p>
<p><span class="math display">\[
C_4 = \{B, C\}
\]</span></p>
<p>Then we can see that:</p>
<ul>
<li><p>Members of <span class="math inline">\(C_1\)</span> connect with members of <span class="math inline">\(C_2\)</span> and <span class="math inline">\(C_4\)</span> but not among themselves.</p></li>
<li><p>Members of <span class="math inline">\(C_2\)</span> connect among themselves and with <span class="math inline">\(C_1\)</span>.</p></li>
<li><p>Members of <span class="math inline">\(C_3\)</span> connect among themselves and with <span class="math inline">\(C_4\)</span>.</p></li>
<li><p>Members of <span class="math inline">\(C_4\)</span> connect with <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_3\)</span> but avoid associating with their own block.</p></li>
</ul>
<p>These intra and inter-block relations can then be represented in the reduced <strong>image matrix</strong>:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> C_1 </th>
   <th style="text-align:center;"> C_2 </th>
   <th style="text-align:center;"> C_3 </th>
   <th style="text-align:center;"> C_4 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> C_1 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-top: 0.75px solid;border-right: 0.75px solid;"> C_2 </td>
   <td style="text-align:center;border-top: 0.75px solid;border-right: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-top: 0.75px solid;border-right: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-top: 0.75px solid;border-right: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-top: 0.75px solid;border-right: 0.75px solid;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-right: 0.75px solid;"> C_3 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-right: 0.75px solid;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;border-bottom: 0.75px solid;border-right: 0.75px solid;"> C_4 </td>
   <td style="text-align:center;border-bottom: 0.75px solid;border-right: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 0.75px solid;border-right: 0.75px solid;"> 0 </td>
   <td style="text-align:center;border-bottom: 0.75px solid;border-right: 0.75px solid;"> 1 </td>
   <td style="text-align:center;border-bottom: 0.75px solid;border-right: 0.75px solid;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Which reveals a more economical representation of the system based on structural equivalence.</p>
</section>
<section id="structural-equivalence-in-the-real-world" class="level2">
<h2 class="anchored" data-anchor-id="structural-equivalence-in-the-real-world">Structural Equivalence in the Real World</h2>
<p>Of course, in real data, it is very unlikely that two nodes will meet the exact mathematical criterion of structural equivalence. They might have three out of five, or eight out of nine common neighbors but would still get a big zero in the <span class="math inline">\(\mathbf{E}\)</span> defined using our strict function.</p>
<p>So, a lot of role analysis in real networks follows instead searches for a <em>near cousin</em> to structural equivalence. This leads us to the large class of <strong>distance</strong> and <strong>similarity</strong> metrics, and the task is to pick one such that structural equivalence falls off as a special case of the given metric.</p>
<p>For random reasons, early work in social network analysis focused on <strong>distance metrics</strong>, while more recent work inspired by network science focuses on <strong>similarity metrics</strong>. The end goal is the same though; to cluster nodes in a graph such that those in the same class are the most structurally similar to one another.</p>
<p>Let us, therefore, begin with the distance approach. Here the goal is simply to pick a distance metric <span class="math inline">\(d\)</span> with a well defined minimum <span class="math inline">\(d_{min}\)</span> or maximum value <span class="math inline">\(d_{max}\)</span>, such that:</p>
<p><span class="math display">\[
   v_i \equiv v_j \iff d(v_i, v_j) = d_{min} \lor d(v_i, v_j) = d_{max}
\]</span></p>
<p>Where whether we pick the maximum or minimum value depends on the particularities of the measure <span class="math inline">\(d\)</span>.</p>
<p>We then populate the <span class="math inline">\(\mathbf{E}\)</span> matrix with the values of <span class="math inline">\(d\)</span> for each pair of nodes <span class="math inline">\((v_i, v_j)\)</span>, do some kind of clustering on the matrix, and use our clusters assignments to re-arrange the original adjacency matrix to find our blocks, and so forth.</p>
<p>A very obvious candidate for <span class="math inline">\(d\)</span> is the <strong>Euclidean Distance</strong> <span class="citation" data-cites="burt76">(<a href="#ref-burt76" role="doc-biblioref">Burt 1976</a>)</span>:</p>
<p><span class="math display">\[
   d_{i,j} = \sqrt{\sum_{k \neq i,j} (a_{ik} - a_{jk})^2}
\]</span></p>
<p>Where <span class="math inline">\(a_{ik}\)</span> and <span class="math inline">\(a_{jk}\)</span> are the corresponding entries in the graph’s adjacency matrix <span class="math inline">\(\mathbf{A}\)</span>. The minimum for this measure is <span class="math inline">\(d_{min} = 0\)</span>, so this is the value we should find for structurally equivalent nodes.</p>
<p>A function that does this for any graph is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   d.euclid <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>      A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(x))</span>
<span id="cb6-3"><a href="#cb6-3"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb6-4"><a href="#cb6-4"></a>      E <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb6-5"><a href="#cb6-5"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb6-6"><a href="#cb6-6"></a>         <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb6-7"><a href="#cb6-7"></a>            <span class="cf">if</span> (i <span class="sc">&lt;</span> j <span class="sc">&amp;</span> i <span class="sc">!=</span> j) {</span>
<span id="cb6-8"><a href="#cb6-8"></a>               d.ij <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>               <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb6-10"><a href="#cb6-10"></a>                  <span class="cf">if</span> (k <span class="sc">!=</span> i <span class="sc">&amp;</span> k <span class="sc">!=</span> j) {</span>
<span id="cb6-11"><a href="#cb6-11"></a>                     d.ij <span class="ot">&lt;-</span> d.ij <span class="sc">+</span> (A[i,k] <span class="sc">-</span> A[j,k])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>                     }</span>
<span id="cb6-13"><a href="#cb6-13"></a>                  }</span>
<span id="cb6-14"><a href="#cb6-14"></a>               E[i,j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d.ij)</span>
<span id="cb6-15"><a href="#cb6-15"></a>               E[j,i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d.ij)</span>
<span id="cb6-16"><a href="#cb6-16"></a>            }</span>
<span id="cb6-17"><a href="#cb6-17"></a>         }</span>
<span id="cb6-18"><a href="#cb6-18"></a>      }</span>
<span id="cb6-19"><a href="#cb6-19"></a>   <span class="fu">rownames</span>(E) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb6-20"><a href="#cb6-20"></a>   <span class="fu">colnames</span>(E) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb6-21"><a href="#cb6-21"></a>   <span class="fu">return</span>(E)</span>
<span id="cb6-22"><a href="#cb6-22"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we can try it out with our toy graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>   E <span class="ot">&lt;-</span> <span class="fu">d.euclid</span>(g)</span>
<span id="cb7-2"><a href="#cb7-2"></a>   <span class="fu">round</span>(E, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C   D   E   F   G   H   I
A 0.0 2.0 2.0 1.7 1.7 1.7 0.0 2.6 2.6
B 2.0 0.0 0.0 2.6 2.6 2.6 2.0 1.7 1.7
C 2.0 0.0 0.0 2.6 2.6 2.6 2.0 1.7 1.7
D 1.7 2.6 2.6 0.0 0.0 0.0 1.7 2.0 2.0
E 1.7 2.6 2.6 0.0 0.0 0.0 1.7 2.0 2.0
F 1.7 2.6 2.6 0.0 0.0 0.0 1.7 2.0 2.0
G 0.0 2.0 2.0 1.7 1.7 1.7 0.0 2.6 2.6
H 2.6 1.7 1.7 2.0 2.0 2.0 2.6 0.0 0.0
I 2.6 1.7 1.7 2.0 2.0 2.0 2.6 0.0 0.0</code></pre>
</div>
</div>
<p>And it looks like indeed it detected the structurally equivalent nodes in the graph. We can see it clearly by re-ordering the rows and columns according to our known ordering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>   E <span class="ot">&lt;-</span> E[SE.ord, SE.ord]</span>
<span id="cb9-2"><a href="#cb9-2"></a>   <span class="fu">round</span>(E, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    F   D   E   H   I   A   G   B   C
F 0.0 0.0 0.0 2.0 2.0 1.7 1.7 2.6 2.6
D 0.0 0.0 0.0 2.0 2.0 1.7 1.7 2.6 2.6
E 0.0 0.0 0.0 2.0 2.0 1.7 1.7 2.6 2.6
H 2.0 2.0 2.0 0.0 0.0 2.6 2.6 1.7 1.7
I 2.0 2.0 2.0 0.0 0.0 2.6 2.6 1.7 1.7
A 1.7 1.7 1.7 2.6 2.6 0.0 0.0 2.0 2.0
G 1.7 1.7 1.7 2.6 2.6 0.0 0.0 2.0 2.0
B 2.6 2.6 2.6 1.7 1.7 2.0 2.0 0.0 0.0
C 2.6 2.6 2.6 1.7 1.7 2.0 2.0 0.0 0.0</code></pre>
</div>
</div>
<p>Here the block-diagonals of the matrix contain zeroes because the <span class="math inline">\(d\)</span> is a distance function with a minimum of zero. If we wanted it to contain ones instead we would normalize:</p>
<p><span class="math display">\[
   d^* = 1-\left(\frac{d}{max(d)}\right)
\]</span></p>
<p>Which would give us:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>   E.norm <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> E<span class="sc">/</span><span class="fu">max</span>(E)</span>
<span id="cb11-2"><a href="#cb11-2"></a>   <span class="fu">round</span>(E.norm, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    F   D   E   H   I   A   G   B   C
F 1.0 1.0 1.0 0.2 0.2 0.3 0.3 0.0 0.0
D 1.0 1.0 1.0 0.2 0.2 0.3 0.3 0.0 0.0
E 1.0 1.0 1.0 0.2 0.2 0.3 0.3 0.0 0.0
H 0.2 0.2 0.2 1.0 1.0 0.0 0.0 0.3 0.3
I 0.2 0.2 0.2 1.0 1.0 0.0 0.0 0.3 0.3
A 0.3 0.3 0.3 0.0 0.0 1.0 1.0 0.2 0.2
G 0.3 0.3 0.3 0.0 0.0 1.0 1.0 0.2 0.2
B 0.0 0.0 0.0 0.3 0.3 0.2 0.2 1.0 1.0
C 0.0 0.0 0.0 0.3 0.3 0.2 0.2 1.0 1.0</code></pre>
</div>
</div>
<p>As noted, a distance function defines a <em>clustering</em> on the nodes, and the results of the clustering generate our blocks. In <code>R</code> we can use the functions <code>dist</code> and <code>hclust</code> to do the job:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   E <span class="ot">&lt;-</span> <span class="fu">dist</span>(E) <span class="co">#transforming E to a dist object</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(E, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="structequiv_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which are our original clusters of structurally equivalent nodes!</p>
<p>Let’s see how this would work in real data. Let’s take the <em>Flintstones</em> (film) co-appearance network as an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb14-2"><a href="#cb14-2"></a>   g.flint <span class="ot">&lt;-</span> movie_267</span>
<span id="cb14-3"><a href="#cb14-3"></a>   g.flint <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.flint, <span class="fu">degree</span>(g.flint) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>   E <span class="ot">&lt;-</span> <span class="fu">d.euclid</span>(g.flint)</span>
<span id="cb14-5"><a href="#cb14-5"></a>   E <span class="ot">&lt;-</span> <span class="fu">dist</span>(E) <span class="co">#transforming E to a dist object</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(E, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>   <span class="co">#install.packages("dendextend")</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>   <span class="fu">library</span>(dendextend) <span class="co">#nice dendrogram plotting</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>   dend <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(h.res) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10"></a>      <span class="fu">color_branches</span>(<span class="at">k =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11"></a>      <span class="fu">color_labels</span>(<span class="at">k =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12"></a>      <span class="fu">set</span>(<span class="st">"labels_cex"</span>, <span class="fl">0.65</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13"></a>      <span class="fu">set</span>(<span class="st">"branches_lwd"</span>, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-14"><a href="#cb14-14"></a>      plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="structequiv_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The <em>Flintstones</em> is a film based on a family, and families are the prototypes of <em>social roles</em> in networks, so if structural equivalence gets at roles, then it should recover known kin roles here, and indeed it does to some extent. One cluster is the focal parents separated into “moms” and “dads” roles, and another has the kids.</p>
<p>After we have our clustering, we may wish to extract the structurally equivalent blocks from the hierarchical clustering results. To do that, we need to <em>cut</em> the dendrogram at a height that will produce a given number of clusters. Of course because hierarchical clustering is agglomerative, it begins with all nodes in the same cluster and ends with all nodes in a single cluster. So a reasonable solution is some (relatively) small number of clusters <span class="math inline">\(k\)</span> such that <span class="math inline">\(1 &gt; k &lt; n\)</span> that is, some number larger than one but smaller than the number of nodes in the graph.</p>
<p>Choosing the number of clusters after a hierarchical clustering is not a well-defined problem, so you have to use a combination of pragmatic and domain-specific knowledge criteria to decide. Here, it looks like four blocks provides enough resolution and substantive interpretability so let’s do that. To do the job we use a function from the <code>dendextend</code> package we used above to draw our pretty colored dendrogram data viz, called <code>cutree</code> which as its name implies cuts the dendrogram at a height that produces the required number of classes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        BAM-BAM          BARNEY           BETTY        FELDSPAR            FRED 
              1               2               2               3               2 
   HEADMISTRESS      HERDMASTER            LAVA           LEACH          MORRIS 
              4               3               2               1               4 
      MRS SLATE         PEBBLES PEBBLES BAM-BAM        PILTDOWN      POINDEXTER 
              4               1               1               3               4 
         PYRITE           SLATE           WILMA 
              3               2               2 </code></pre>
</div>
</div>
<p>Note that the result is a <strong>named vector</strong> with the node labels as the names and a value of <span class="math inline">\(k\)</span> for each node, where <span class="math inline">\(k\)</span> indicates the class of that node. For instance, <span class="math inline">\(\{Barney, Betty, Fred, Lava, Slate, Wilma\}\)</span> all belong to <span class="math inline">\(k = 2\)</span>. Remember this is a purely <strong>nominal</strong> classification so the order of the numbers doesn’t matter.</p>
</section>
<section id="concor" class="level2">
<h2 class="anchored" data-anchor-id="concor">CONCOR</h2>
<p>The other (perhaps less obvious) way of defining a distance between nodes in the network based on their connectivity patterns to other nodes is the <strong>correlation distance</strong>:</p>
<p><span class="math display">\[
    d_{i,j} =
    \frac{
    \sum_{i \neq k}
    (a_{ki} - \overline{a}_{i}) \times
    \sum_{j \neq k}
    (a_{kj} - \overline{a}_{j})
    }
    {
    \sqrt{
    \sum_{i \neq k}
    (a_{ki} - \overline{a}_{i})^2 \times
    \sum_{j \neq k}
    (a_{kj} - \overline{a}_{j})^2
        }
    }
\]</span></p>
<p>A more involved but still meaningful formula compared of the Euclidean distance. Here <span class="math inline">\(\overline{a}_{i}\)</span> is the <em>column mean</em> of the entries of node <span class="math inline">\(i\)</span> in the affiliation matrix.</p>
<p>So the correlation distance is the ratio of the covariance of the column vectors corresponding to each node in the adjacency matrix and the product of their standard deviations.</p>
<p>The correlation distance between nodes in our toy network is given by simply typing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb17-2"><a href="#cb17-2"></a>   C <span class="ot">&lt;-</span> <span class="fu">cor</span>(m)</span>
<span id="cb17-3"><a href="#cb17-3"></a>   <span class="fu">round</span>(C, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A     B     C     D     E     F     G     H     I
A  1.00 -0.32 -0.32  0.32  0.32  0.32  0.50 -0.63 -0.63
B -0.32  1.00  1.00 -1.00 -1.00 -1.00 -0.32  0.35  0.35
C -0.32  1.00  1.00 -1.00 -1.00 -1.00 -0.32  0.35  0.35
D  0.32 -1.00 -1.00  1.00  1.00  1.00  0.32 -0.35 -0.35
E  0.32 -1.00 -1.00  1.00  1.00  1.00  0.32 -0.35 -0.35
F  0.32 -1.00 -1.00  1.00  1.00  1.00  0.32 -0.35 -0.35
G  0.50 -0.32 -0.32  0.32  0.32  0.32  1.00 -0.63 -0.63
H -0.63  0.35  0.35 -0.35 -0.35 -0.35 -0.63  1.00  0.55
I -0.63  0.35  0.35 -0.35 -0.35 -0.35 -0.63  0.55  1.00</code></pre>
</div>
</div>
<p>Which gives the Pearson product moment correlation of each pair of columns in the adjacency matrix.</p>
<p>The key thing that was noticed by <span class="citation" data-cites="breiger_etal75">Breiger, Boorman, and Arabie (<a href="#ref-breiger_etal75" role="doc-biblioref">1975</a>)</span> is that we can <em>iterate</em> this process, and compute <em>correlation distances of correlation distances</em> between nodes in the graph. If we do this for our toy network a few (e.g., three) times we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   C1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(C)</span>
<span id="cb19-2"><a href="#cb19-2"></a>   C2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(C1)</span>
<span id="cb19-3"><a href="#cb19-3"></a>   C3 <span class="ot">&lt;-</span> <span class="fu">cor</span>(C2)</span>
<span id="cb19-4"><a href="#cb19-4"></a>   <span class="fu">round</span>(C3, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A  B  C  D  E  F  G  H  I
A  1 -1 -1  1  1  1  1 -1 -1
B -1  1  1 -1 -1 -1 -1  1  1
C -1  1  1 -1 -1 -1 -1  1  1
D  1 -1 -1  1  1  1  1 -1 -1
E  1 -1 -1  1  1  1  1 -1 -1
F  1 -1 -1  1  1  1  1 -1 -1
G  1 -1 -1  1  1  1  1 -1 -1
H -1  1  1 -1 -1 -1 -1  1  1
I -1  1  1 -1 -1 -1 -1  1  1</code></pre>
</div>
</div>
<p>Interestingly the positive correlations converge to 1.0 and the negative correlations converge to -1.0!</p>
<p>If we sort the rows and columns of the new matrix according to these values, we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>   C.ord <span class="ot">&lt;-</span> <span class="fu">corrMatOrder</span>(C3, <span class="at">order =</span> <span class="st">"hclust"</span>, <span class="at">hclust.method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>   C3 <span class="ot">&lt;-</span> C3[C.ord, C.ord]</span>
<span id="cb21-3"><a href="#cb21-3"></a>   <span class="fu">round</span>(C3, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   B  C  H  I  F  D  E  A  G
B  1  1  1  1 -1 -1 -1 -1 -1
C  1  1  1  1 -1 -1 -1 -1 -1
H  1  1  1  1 -1 -1 -1 -1 -1
I  1  1  1  1 -1 -1 -1 -1 -1
F -1 -1 -1 -1  1  1  1  1  1
D -1 -1 -1 -1  1  1  1  1  1
E -1 -1 -1 -1  1  1  1  1  1
A -1 -1 -1 -1  1  1  1  1  1
G -1 -1 -1 -1  1  1  1  1  1</code></pre>
</div>
</div>
<p>Aha! The iterated correlations seems to have split the matrix into two <strong>blocks</strong> <span class="math inline">\(C_1 = \{G, F, D, A, G\}\)</span> and <span class="math inline">\(C_2 = \{I, H, B, C\}\)</span>. Each of the blocks is composed of two sub-blocks that we know are structurally equivalent from our previous analysis.</p>
<p>A function implementing this method of iterated correlation distances until convergence looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>   con.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-2"><a href="#cb23-2"></a>      C <span class="ot">&lt;-</span> x</span>
<span id="cb23-3"><a href="#cb23-3"></a>      <span class="cf">while</span> (<span class="fu">mean</span>(<span class="fu">abs</span>(C)) <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb23-4"><a href="#cb23-4"></a>         C <span class="ot">&lt;-</span> <span class="fu">cor</span>(C)</span>
<span id="cb23-5"><a href="#cb23-5"></a>         }</span>
<span id="cb23-6"><a href="#cb23-6"></a>      b1 <span class="ot">&lt;-</span> C[, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>      b2 <span class="ot">&lt;-</span> <span class="sc">!</span>b1</span>
<span id="cb23-8"><a href="#cb23-8"></a>      <span class="fu">return</span>(<span class="fu">list</span>(x[, b1, <span class="at">drop =</span> <span class="cn">FALSE</span>], x[, b2, <span class="at">drop =</span> <span class="cn">FALSE</span>]))</span>
<span id="cb23-9"><a href="#cb23-9"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function takes a graph’s adjacency matrix as input, creates a copy of the adjacency matrix in line 2 (to be put through the iterated correlations meat grinder). The three-line (3-5) <code>while</code> loop goes through the iterated correlations (stopping when the matrix is full of ones). Then the resulting two blocks are returned as the columns of a couple of matrices stored in a list in line 8.</p>
<p>For instance, to use our example above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   <span class="fu">con.cor</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
  A D E F G
A 0 0 0 0 1
B 1 1 1 1 1
C 1 1 1 1 1
D 0 0 0 0 0
E 0 0 0 0 0
F 0 0 0 0 0
G 1 0 0 0 0
H 0 1 1 1 0
I 0 1 1 1 0

[[2]]
  B C H I
A 1 1 0 0
B 0 0 0 0
C 0 0 0 0
D 1 1 1 1
E 1 1 1 1
F 1 1 1 1
G 1 1 0 0
H 0 0 0 1
I 0 0 1 0</code></pre>
</div>
</div>
<p>The columns of these two matrices are the two blocks we found before. Of course, to implement this method as a <em>divisive</em> clustering algorithm, what we want is to split these two blocks into two finer grained blocks, by iterative correlations of the columns of these two sub-matrices (to reveal two further sub-matrices each) and thus find our original four structurally equivalent groups.</p>
<p>The following function–simplified and adapted from <a href="https://rdrr.io/github/aslez/concoR/src/R/concoR.R">Adam Slez’s work</a>—which includes the <code>con.cor</code> function shown earlier inside of it, will do it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>  blocks <span class="ot">&lt;-</span> <span class="cf">function</span>(g, <span class="at">s =</span> <span class="dv">2</span>) {</span>
<span id="cb26-2"><a href="#cb26-2"></a>     A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb26-3"><a href="#cb26-3"></a>     B <span class="ot">&lt;-</span> <span class="fu">list</span>(A)</span>
<span id="cb26-4"><a href="#cb26-4"></a>     <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>s) {</span>
<span id="cb26-5"><a href="#cb26-5"></a>       B <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(B, con.cor), <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a>       }</span>
<span id="cb26-7"><a href="#cb26-7"></a>     <span class="fu">return</span>(<span class="fu">lapply</span>(B, colnames))</span>
<span id="cb26-8"><a href="#cb26-8"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function takes the graph as input and returns a list of column names containing the structurally equivalent blocks as output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>   <span class="fu">blocks</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "A" "G"

[[2]]
[1] "D" "E" "F"

[[3]]
[1] "B" "C"

[[4]]
[1] "H" "I"</code></pre>
</div>
</div>
<p>Which are the original structurally equivalent classes. The argument <code>s</code> controls the number of splits. When it is equal to one, the function produces two blocks, and when it is equal to two it produces four blocks, when it is equal to three, six blocks, and so on.</p>
<p>This is the algorithm called CONCOR <span class="citation" data-cites="breiger_etal75">(<a href="#ref-breiger_etal75" role="doc-biblioref">Breiger, Boorman, and Arabie 1975</a>)</span>, short for <strong>con</strong>vergence of iterate <strong>cor</strong>relations, and can be used to cluster the rows(columns) of any valued square data matrix.</p>
<p>For instance, if we wanted to split the <em>Flintstones</em> network into four blocks we would proceed as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>   g.flint <span class="ot">&lt;-</span> movie_267</span>
<span id="cb29-2"><a href="#cb29-2"></a>   g.flint <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.flint, <span class="fu">degree</span>(g.flint) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>   <span class="fu">blocks</span>(g.flint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "BAM-BAM"    "BETTY"      "PEBBLES"    "POINDEXTER" "WILMA"     

[[2]]
[1] "FELDSPAR"   "HERDMASTER" "LAVA"       "PILTDOWN"   "PYRITE"    
[6] "SLATE"     

[[3]]
[1] "BARNEY"          "FRED"            "LEACH"           "PEBBLES BAM-BAM"

[[4]]
[1] "HEADMISTRESS" "MORRIS"       "MRS SLATE"   </code></pre>
</div>
</div>
<p>Which is similar to the results we got from the Euclidean distance method, except that now the children are put in the same blocks as the moms.</p>
<p>We could then visualize the results as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>   <span class="co">#install.packages("ggcorrplot")</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>   <span class="fu">library</span>(ggcorrplot)</span>
<span id="cb31-3"><a href="#cb31-3"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g.flint))</span>
<span id="cb31-4"><a href="#cb31-4"></a>   ord <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">blocks</span>(g.flint, <span class="dv">2</span>))</span>
<span id="cb31-5"><a href="#cb31-5"></a>   A <span class="ot">&lt;-</span> A[ord, ord]</span>
<span id="cb31-6"><a href="#cb31-6"></a>   p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(A, <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"black"</span>)) </span>
<span id="cb31-7"><a href="#cb31-7"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb31-8"><a href="#cb31-8"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-9"><a href="#cb31-9"></a>                  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-10"><a href="#cb31-10"></a>                  )</span>
<span id="cb31-11"><a href="#cb31-11"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">5.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">5.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-13"><a href="#cb31-13"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">11.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-14"><a href="#cb31-14"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">11.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-15"><a href="#cb31-15"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-16"><a href="#cb31-16"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">15.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb31-17"><a href="#cb31-17"></a>   p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="structequiv_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which is just a tile plot of the original adjacency matrix (adjacent cells in black) with rows and columns re-ordered according to the four-block solution and <code>ggplot</code> vertical and horizontal lines highlighting the boundaries of the blocked matrix.</p>
<p>As you can see, characters with similar patterns of scene co-appearances (like Barney and Fred) are drawn next to one another, revealing the larger “roles” in the network.</p>
</section>
<section id="structural-equivalence-in-directed-graphs" class="level2">
<h2 class="anchored" data-anchor-id="structural-equivalence-in-directed-graphs">Structural Equivalence in Directed Graphs</h2>
<p>Like before, the main complication introduced by the directed case is the “doubling” of the relations considered.</p>
<p>In the Euclidean distance case, we have to decide whether we want to compute two set of distances between nodes, one based on the in-distance vectors and the other on the out-distance vectors, and the two sets of hierarchical clustering partitions.</p>
<p>Another approach is simply to combine both according to the formula:</p>
<p><span class="math display">\[
   d_{i,j} = \sqrt{
                  \sum_{k \neq i,j} (a_{ik} - a_{jk})^2 +
                  \sum_{k \neq i,j} (a_{ki} - a_{kj})^2
                  }
\]</span></p>
<p>Which just computes the Euclidean distances between nodes using both in and out neighbors. Here nodes would be structurally equivalent only if they have the same set of in and out-neighbors. This would mean changing line 11 in the function <code>d.euclid</code> above with the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>   d.ij <span class="ot">&lt;-</span> d.ij <span class="sc">+</span> ((A[i,k] <span class="sc">-</span> A[j,k])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (A[k,i] <span class="sc">-</span> A[k,j])<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This way, distances are computed on both the row and columns of the directed graph’s adjacency matrix.</p>
<p>If we are using the correlation distance approach in a directed graph, then the main trick is to <em>stack</em> the original adjacency matrix against its transpose, and then compute the correlation distance on the columns of the stacked matrices, which by definition combines information in incoming and outgoing ties.</p>
<p>Let’s see a brief example. Let’s load up the Krackhardt’s high-tech managers data on advice relations and look at the adjacency matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>   g <span class="ot">&lt;-</span> ht_advice</span>
<span id="cb33-2"><a href="#cb33-2"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb33-3"><a href="#cb33-3"></a>   A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    0    1    0    1    0    0    0    1    0     0     0     0     0
 [2,]    0    0    0    0    0    1    1    0    0     0     0     0     0
 [3,]    1    1    0    1    0    1    1    1    1     1     1     1     0
 [4,]    1    1    0    0    0    1    0    1    0     1     1     1     0
 [5,]    1    1    0    0    0    1    1    1    0     1     1     0     1
 [6,]    0    0    0    0    0    0    0    0    0     0     0     0     0
 [7,]    0    1    0    0    0    1    0    0    0     0     1     1     0
 [8,]    0    1    0    1    0    1    1    0    0     1     1     0     0
 [9,]    1    1    0    0    0    1    1    1    0     1     1     1     0
[10,]    1    1    1    1    1    0    0    1    0     0     1     0     1
[11,]    1    1    0    0    0    0    1    0    0     0     0     0     0
[12,]    0    0    0    0    0    0    1    0    0     0     0     0     0
[13,]    1    1    0    0    1    0    0    0    1     0     0     0     0
[14,]    0    1    0    0    0    0    1    0    0     0     0     0     0
[15,]    1    1    1    1    1    1    1    1    1     1     1     1     1
[16,]    1    1    0    0    0    0    0    0    0     1     0     0     0
[17,]    1    1    0    1    0    0    1    0    0     0     0     0     0
[18,]    1    1    1    1    1    0    1    1    1     1     1     0     1
[19,]    1    1    1    0    1    0    1    0    0     1     1     0     0
[20,]    1    1    0    0    0    1    0    1    0     0     1     1     0
[21,]    0    1    1    1    0    1    1    1    0     0     0     1     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]
 [1,]     0     0     1     0     1     0     0     1
 [2,]     0     0     0     0     0     0     0     1
 [3,]     1     0     0     1     1     0     1     1
 [4,]     0     0     1     1     1     0     1     1
 [5,]     1     0     1     1     1     1     1     1
 [6,]     0     0     0     0     0     0     0     1
 [7,]     1     0     0     1     1     0     0     1
 [8,]     0     0     0     0     1     0     0     1
 [9,]     1     0     1     1     1     0     0     1
[10,]     0     1     1     1     1     1     1     0
[11,]     0     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0     1
[13,]     1     0     0     0     1     0     0     0
[14,]     0     0     0     0     1     0     0     1
[15,]     1     0     1     1     1     1     1     1
[16,]     0     0     0     0     1     0     0     0
[17,]     0     0     0     0     0     0     0     1
[18,]     1     1     1     0     0     1     1     1
[19,]     1     1     0     0     1     0     1     0
[20,]     1     1     1     1     1     0     0     1
[21,]     1     0     0     1     1     0     1     0</code></pre>
</div>
</div>
<p>Recall that <a href="https://rdrr.io/github/schochastics/networkdata/man/ht_advice.html">in these data</a> a tie goes <em>from</em> an advice seeker <em>to</em> an advisor. So the standard correlation distance on the columns computes the in-correlation, or structural equivalence based on incoming ties (two managers are equivalent if they are nominated as advisors by the same others).</p>
<p>We may also be interested in the out-correlation, that is structural equivalence based on out-going ties. Here two managers are structurally equivalent is they seek advice from the same others. This information is contained in the transpose of the original adjacency matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>   A.t <span class="ot">&lt;-</span> <span class="fu">t</span>(A)</span>
<span id="cb35-2"><a href="#cb35-2"></a>   A.t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    0    0    1    1    1    0    0    0    1     1     1     0     1
 [2,]    1    0    1    1    1    0    1    1    1     1     1     0     1
 [3,]    0    0    0    0    0    0    0    0    0     1     0     0     0
 [4,]    1    0    1    0    0    0    0    1    0     1     0     0     0
 [5,]    0    0    0    0    0    0    0    0    0     1     0     0     1
 [6,]    0    1    1    1    1    0    1    1    1     0     0     0     0
 [7,]    0    1    1    0    1    0    0    1    1     0     1     1     0
 [8,]    1    0    1    1    1    0    0    0    1     1     0     0     0
 [9,]    0    0    1    0    0    0    0    0    0     0     0     0     1
[10,]    0    0    1    1    1    0    0    1    1     0     0     0     0
[11,]    0    0    1    1    1    0    1    1    1     1     0     0     0
[12,]    0    0    1    1    0    0    1    0    1     0     0     0     0
[13,]    0    0    0    0    1    0    0    0    0     1     0     0     0
[14,]    0    0    1    0    1    0    1    0    1     0     0     0     1
[15,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[16,]    1    0    0    1    1    0    0    0    1     1     0     0     0
[17,]    0    0    1    1    1    0    1    0    1     1     0     0     0
[18,]    1    0    1    1    1    0    1    1    1     1     0     0     1
[19,]    0    0    0    0    1    0    0    0    0     1     0     0     0
[20,]    0    0    1    1    1    0    0    0    0     1     0     0     0
[21,]    1    1    1    1    1    1    1    1    1     0     0     1     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]
 [1,]     0     1     1     1     1     1     1     0
 [2,]     1     1     1     1     1     1     1     1
 [3,]     0     1     0     0     1     1     0     1
 [4,]     0     1     0     1     1     0     0     1
 [5,]     0     1     0     0     1     1     0     0
 [6,]     0     1     0     0     0     0     1     1
 [7,]     1     1     0     1     1     1     0     1
 [8,]     0     1     0     0     1     0     1     1
 [9,]     0     1     0     0     1     0     0     0
[10,]     0     1     1     0     1     1     0     0
[11,]     0     1     0     0     1     1     1     0
[12,]     0     1     0     0     0     0     1     1
[13,]     0     1     0     0     1     0     0     0
[14,]     0     1     0     0     1     1     1     1
[15,]     0     0     0     0     1     1     1     0
[16,]     0     1     0     0     1     0     1     0
[17,]     0     1     0     0     0     0     1     1
[18,]     1     1     1     0     0     1     1     1
[19,]     0     1     0     0     1     0     0     0
[20,]     0     1     0     0     1     1     0     1
[21,]     1     1     0     1     1     0     1     0</code></pre>
</div>
</div>
<p>Correlating the columns of this matrix would thus give us the out-correlation distance based on advice seeking relations.</p>
<p>“Stacking” is a way to combine both in and out-going ties and compute a single distance based on both. It just means that we literally bind the rows of the firs matrix and its transpose:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>   A.stack <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A, A.t)</span>
<span id="cb37-2"><a href="#cb37-2"></a>   A.stack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    0    1    0    1    0    0    0    1    0     0     0     0     0
 [2,]    0    0    0    0    0    1    1    0    0     0     0     0     0
 [3,]    1    1    0    1    0    1    1    1    1     1     1     1     0
 [4,]    1    1    0    0    0    1    0    1    0     1     1     1     0
 [5,]    1    1    0    0    0    1    1    1    0     1     1     0     1
 [6,]    0    0    0    0    0    0    0    0    0     0     0     0     0
 [7,]    0    1    0    0    0    1    0    0    0     0     1     1     0
 [8,]    0    1    0    1    0    1    1    0    0     1     1     0     0
 [9,]    1    1    0    0    0    1    1    1    0     1     1     1     0
[10,]    1    1    1    1    1    0    0    1    0     0     1     0     1
[11,]    1    1    0    0    0    0    1    0    0     0     0     0     0
[12,]    0    0    0    0    0    0    1    0    0     0     0     0     0
[13,]    1    1    0    0    1    0    0    0    1     0     0     0     0
[14,]    0    1    0    0    0    0    1    0    0     0     0     0     0
[15,]    1    1    1    1    1    1    1    1    1     1     1     1     1
[16,]    1    1    0    0    0    0    0    0    0     1     0     0     0
[17,]    1    1    0    1    0    0    1    0    0     0     0     0     0
[18,]    1    1    1    1    1    0    1    1    1     1     1     0     1
[19,]    1    1    1    0    1    0    1    0    0     1     1     0     0
[20,]    1    1    0    0    0    1    0    1    0     0     1     1     0
[21,]    0    1    1    1    0    1    1    1    0     0     0     1     0
[22,]    0    0    1    1    1    0    0    0    1     1     1     0     1
[23,]    1    0    1    1    1    0    1    1    1     1     1     0     1
[24,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[25,]    1    0    1    0    0    0    0    1    0     1     0     0     0
[26,]    0    0    0    0    0    0    0    0    0     1     0     0     1
[27,]    0    1    1    1    1    0    1    1    1     0     0     0     0
[28,]    0    1    1    0    1    0    0    1    1     0     1     1     0
[29,]    1    0    1    1    1    0    0    0    1     1     0     0     0
[30,]    0    0    1    0    0    0    0    0    0     0     0     0     1
[31,]    0    0    1    1    1    0    0    1    1     0     0     0     0
[32,]    0    0    1    1    1    0    1    1    1     1     0     0     0
[33,]    0    0    1    1    0    0    1    0    1     0     0     0     0
[34,]    0    0    0    0    1    0    0    0    0     1     0     0     0
[35,]    0    0    1    0    1    0    1    0    1     0     0     0     1
[36,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[37,]    1    0    0    1    1    0    0    0    1     1     0     0     0
[38,]    0    0    1    1    1    0    1    0    1     1     0     0     0
[39,]    1    0    1    1    1    0    1    1    1     1     0     0     1
[40,]    0    0    0    0    1    0    0    0    0     1     0     0     0
[41,]    0    0    1    1    1    0    0    0    0     1     0     0     0
[42,]    1    1    1    1    1    1    1    1    1     0     0     1     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]
 [1,]     0     0     1     0     1     0     0     1
 [2,]     0     0     0     0     0     0     0     1
 [3,]     1     0     0     1     1     0     1     1
 [4,]     0     0     1     1     1     0     1     1
 [5,]     1     0     1     1     1     1     1     1
 [6,]     0     0     0     0     0     0     0     1
 [7,]     1     0     0     1     1     0     0     1
 [8,]     0     0     0     0     1     0     0     1
 [9,]     1     0     1     1     1     0     0     1
[10,]     0     1     1     1     1     1     1     0
[11,]     0     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0     1
[13,]     1     0     0     0     1     0     0     0
[14,]     0     0     0     0     1     0     0     1
[15,]     1     0     1     1     1     1     1     1
[16,]     0     0     0     0     1     0     0     0
[17,]     0     0     0     0     0     0     0     1
[18,]     1     1     1     0     0     1     1     1
[19,]     1     1     0     0     1     0     1     0
[20,]     1     1     1     1     1     0     0     1
[21,]     1     0     0     1     1     0     1     0
[22,]     0     1     1     1     1     1     1     0
[23,]     1     1     1     1     1     1     1     1
[24,]     0     1     0     0     1     1     0     1
[25,]     0     1     0     1     1     0     0     1
[26,]     0     1     0     0     1     1     0     0
[27,]     0     1     0     0     0     0     1     1
[28,]     1     1     0     1     1     1     0     1
[29,]     0     1     0     0     1     0     1     1
[30,]     0     1     0     0     1     0     0     0
[31,]     0     1     1     0     1     1     0     0
[32,]     0     1     0     0     1     1     1     0
[33,]     0     1     0     0     0     0     1     1
[34,]     0     1     0     0     1     0     0     0
[35,]     0     1     0     0     1     1     1     1
[36,]     0     0     0     0     1     1     1     0
[37,]     0     1     0     0     1     0     1     0
[38,]     0     1     0     0     0     0     1     1
[39,]     1     1     1     0     0     1     1     1
[40,]     0     1     0     0     1     0     0     0
[41,]     0     1     0     0     1     1     0     1
[42,]     1     1     0     1     1     0     1     0</code></pre>
</div>
</div>
<p>Note that this matrix has the same number of columns as the original adjacency matrix and double the number of rows. This doesn’t matter since the correlation distance works on the columns, meaning that it will return a matrix of the same dimensions as the original:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>   <span class="fu">round</span>(<span class="fu">cor</span>(A.stack), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7] [,8]  [,9] [,10] [,11] [,12]
 [1,]  1.00  0.43  0.00  0.09  0.09  0.22  0.14 0.37  0.13  0.25  0.37  0.22
 [2,]  0.43  1.00 -0.19  0.00 -0.19  0.49  0.24 0.38 -0.15 -0.24  0.51  0.52
 [3,]  0.00 -0.19  1.00  0.52  0.62 -0.24  0.19 0.33  0.57  0.00  0.03 -0.03
 [4,]  0.09  0.00  0.52  1.00  0.43 -0.03  0.29 0.33  0.57  0.10  0.03 -0.03
 [5,]  0.09 -0.19  0.62  0.43  1.00 -0.35  0.00 0.14  0.67  0.20  0.03 -0.15
 [6,]  0.22  0.49 -0.24 -0.03 -0.35  1.00  0.27 0.36 -0.16  0.00  0.50  0.74
 [7,]  0.14  0.24  0.19  0.29  0.00  0.27  1.00 0.19  0.24 -0.05  0.10  0.06
 [8,]  0.37  0.38  0.33  0.33  0.14  0.36  0.19 1.00  0.27  0.01  0.41  0.49
 [9,]  0.13 -0.15  0.57  0.57  0.67 -0.16  0.24 0.27  1.00  0.07  0.03  0.04
[10,]  0.25 -0.24  0.00  0.10  0.20  0.00 -0.05 0.01  0.07  1.00  0.24 -0.11
[11,]  0.37  0.51  0.03  0.03  0.03  0.50  0.10 0.41  0.03  0.24  1.00  0.49
[12,]  0.22  0.52 -0.03 -0.03 -0.15  0.74  0.06 0.49  0.04 -0.11  0.49  1.00
[13,]  0.17 -0.11  0.36  0.14  0.25 -0.08  0.11 0.19  0.22  0.17  0.32 -0.16
[14,]  0.47  0.51  0.13  0.03  0.13  0.50  0.30 0.51  0.24  0.03  0.57  0.62
[15,] -0.08 -0.48  0.63  0.25  0.63 -0.47 -0.19 0.07  0.42  0.18 -0.10 -0.25
[16,]  0.38  0.21  0.14  0.24  0.14  0.22  0.00 0.62  0.12  0.15  0.56  0.18
[17,]  0.37  0.40  0.13  0.03 -0.07  0.61  0.00 0.61  0.03  0.03  0.68  0.74
[18,]  0.06  0.11 -0.03 -0.14  0.09  0.21 -0.45 0.15 -0.11  0.28  0.28  0.29
[19,] -0.08 -0.25  0.38  0.18  0.38 -0.22 -0.05 0.26  0.30  0.28  0.21 -0.15
[20,]  0.28  0.00  0.52  0.52  0.43  0.08  0.38 0.33  0.57  0.29  0.24  0.08
[21,]  0.02  0.10 -0.04  0.06 -0.23  0.24  0.29 0.18  0.05 -0.02  0.24  0.17
      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]
 [1,]  0.17  0.47 -0.08  0.38  0.37  0.06 -0.08  0.28  0.02
 [2,] -0.11  0.51 -0.48  0.21  0.40  0.11 -0.25  0.00  0.10
 [3,]  0.36  0.13  0.63  0.14  0.13 -0.03  0.38  0.52 -0.04
 [4,]  0.14  0.03  0.25  0.24  0.03 -0.14  0.18  0.52  0.06
 [5,]  0.25  0.13  0.63  0.14 -0.07  0.09  0.38  0.43 -0.23
 [6,] -0.08  0.50 -0.47  0.22  0.61  0.21 -0.22  0.08  0.24
 [7,]  0.11  0.30 -0.19  0.00  0.00 -0.45 -0.05  0.38  0.29
 [8,]  0.19  0.51  0.07  0.62  0.61  0.15  0.26  0.33  0.18
 [9,]  0.22  0.24  0.42  0.12  0.03 -0.11  0.30  0.57  0.05
[10,]  0.17  0.03  0.18  0.15  0.03  0.28  0.28  0.29 -0.02
[11,]  0.32  0.57 -0.10  0.56  0.68  0.28  0.21  0.24  0.24
[12,] -0.16  0.62 -0.25  0.18  0.74  0.29 -0.15  0.08  0.17
[13,]  1.00  0.20  0.26  0.51  0.20  0.05  0.63  0.36 -0.02
[14,]  0.20  1.00 -0.10  0.34  0.57  0.16  0.11  0.24  0.14
[15,]  0.26 -0.10  1.00  0.02 -0.10  0.08  0.34  0.25 -0.18
[16,]  0.51  0.34  0.02  1.00  0.45  0.11  0.41  0.24  0.17
[17,]  0.20  0.57 -0.10  0.45  1.00  0.40  0.11  0.24  0.14
[18,]  0.05  0.16  0.08  0.11  0.40  1.00  0.18 -0.03 -0.32
[19,]  0.63  0.11  0.34  0.41  0.11  0.18  1.00  0.28 -0.03
[20,]  0.36  0.24  0.25  0.24  0.24 -0.03  0.28  1.00 -0.04
[21,] -0.02  0.14 -0.18  0.17  0.14 -0.32 -0.03 -0.04  1.00</code></pre>
</div>
</div>
<p>And we would then do a blockmodel based on these distances:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>   blocks2 <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">s =</span> <span class="dv">2</span>) {</span>
<span id="cb41-2"><a href="#cb41-2"></a>     <span class="fu">colnames</span>(A) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(A) <span class="co">#use only if the original matrix has no names</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>     B <span class="ot">&lt;-</span> <span class="fu">list</span>(A)</span>
<span id="cb41-4"><a href="#cb41-4"></a>     <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>s) {</span>
<span id="cb41-5"><a href="#cb41-5"></a>       B <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(B, con.cor), <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-6"><a href="#cb41-6"></a>       }</span>
<span id="cb41-7"><a href="#cb41-7"></a>     <span class="fu">return</span>(<span class="fu">lapply</span>(B, colnames))</span>
<span id="cb41-8"><a href="#cb41-8"></a>   }</span>
<span id="cb41-9"><a href="#cb41-9"></a>   <span class="fu">blocks2</span>(A.stack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] "1"  "2"  "6"  "8"  "11" "12" "14" "16" "17" "18"

[[2]]
[1] "7"  "21"

[[3]]
[1] "3"  "4"  "5"  "9"  "15" "20"

[[4]]
[1] "10" "13" "19"</code></pre>
</div>
</div>
</section>
<section id="structural-equivalence-in-multigraphs" class="level2">
<h2 class="anchored" data-anchor-id="structural-equivalence-in-multigraphs">Structural Equivalence in Multigraphs</h2>
<p>Note that we would apply the same trick if we wanted to do a blockmodel based on multiple relations like friendship <em>and</em> advice. Here’s a blockmodel based on the stacked matrices of incoming ties of both types:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>   A.f <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(ht_friends))</span>
<span id="cb43-2"><a href="#cb43-2"></a>   A.stack <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A, A.f)</span>
<span id="cb43-3"><a href="#cb43-3"></a>   <span class="fu">blocks2</span>(A.stack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "1"  "3"  "5"  "14" "15" "20"

[[2]]
[1] "4"  "9"  "13" "19"

[[3]]
[1] "2"  "8"  "12" "16" "17" "18"

[[4]]
[1] "6"  "7"  "10" "11" "21"</code></pre>
</div>
</div>
<p>And one combining incoming and outgoing friendship and advice ties:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>   A.stack <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A, A.t, A.f, <span class="fu">t</span>(A.f))</span>
<span id="cb45-2"><a href="#cb45-2"></a>   <span class="fu">blocks2</span>(A.stack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "1"  "2"  "8"  "12" "16" "21"

[[2]]
[1] "6"  "11" "14" "17"

[[3]]
[1] "3"  "4"  "5"  "7"  "9"  "20"

[[4]]
[1] "10" "13" "15" "18" "19"</code></pre>
</div>
</div>
<p>Note that here the stacked matrix has four sub-matrices: (1) Incoming advice, (2) outgoing advice, (3) incoming friendship, and (4) Outgoing friendship.</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-breiger_etal75" class="csl-entry" role="doc-biblioentry">
Breiger, Ronald L, Scott A Boorman, and Phipps Arabie. 1975. <span>“An Algorithm for Clustering Relational Data with Applications to Social Network Analysis and Comparison with Multidimensional Scaling.”</span> <em>Journal of Mathematical Psychology</em> 12 (3): 328–83.
</div>
<div id="ref-burt76" class="csl-entry" role="doc-biblioentry">
Burt, Ronald S. 1976. <span>“Positions in Networks.”</span> <em>Social Forces</em> 55 (1): 93–122.
</div>
<div id="ref-white_etal76" class="csl-entry" role="doc-biblioentry">
White, Harrison C, Scott A Boorman, and Ronald L Breiger. 1976. <span>“Social Structure from Multiple Networks. I. Blockmodels of Roles and Positions.”</span> <em>American Journal of Sociology</em> 81 (4): 730–80.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The closed neighborhood of a node is that which includes nodes adjacent to it and the node itself.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>