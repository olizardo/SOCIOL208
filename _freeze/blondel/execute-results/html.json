{
  "hash": "c332cc8075fd20f6a4ce8ec65bf0cf9f",
  "result": {
    "markdown": "---\ntitle: \"Role Similarity Across Graphs\"\nexecute: \n  eval: true\n  echo: true\n  output: true\n  warning: false\n  message: false\nformat: \n   html:\n      code-line-numbers: true\n---\n\n\nSometimes we may want to figure out how similar a given node's position in one social network is to that of another node in a *different* network. This calls for a method that could allow us to compare how similar a node in one graph is to *other nodes* in *another graph*. \n\nA particularly interesting version of this problem arises when we have information on the same set of nodes across different set of relations. In that case, we may be interested in answering the question as to whether nodes occupy similar or dissimilar positions across the networks defined by the different relations. \n\n@blondel_etal04 describe an approach that can help us make headway on this problem. They use a similar iterative procedure that we saw can be used to compute [prestige scores](prestige.qmd) from directed graphs (like [PageRank](pagerank.qmd) and [HITS](hits.qmd)) but this time to *compute [similarity](gensim.qmd)* scores between *pairs* of nodes *across* graphs. \n\nThe idea, just like with prestige scoring, is that the two set of nodes in each graph start with the same set of similarity scores, and then we update them as we traverse the connectivity structure of the two graphs. \n\nSo let's say the adjacency matrix of the first graph is $\\mathbf{A}$ and that of the second graph is $\\mathbf{B}$. The first graph has $n_A$ number of nodes and the corresponding quantity in the second graph is $n_B$ our target similarity matrix $\\mathbf{Z}$, comparing the node sets in the two graphs, will therefore be of dimensions $n_B \\times n_A$. \n\nWe initialize $z_{ij}(0) = 1$ for all $i$ and $j$; that is, $\\mathbf{Z}(0)$ is a matrix full of ones. At each time step subsequent to that, we fill up the $\\mathbf{Z}$ matrix with new values according to:\n\n$$ \n   \\mathbf{Z}(t + 1) = \\mathbf{B}\\mathbf{Z(t)}\\mathbf{A}^T + \\mathbf{B}^T\\mathbf{Z(t)}\\mathbf{A}\n$$ {#eq-blondel}\n\nTo ensure convergence, we then normalize the $\\mathbf{Z}$ matrix after every update using our trusty Euclidean (Frobenius) norm:\n\n$$\n\\mathbf{Z}(t) = \\frac{\\mathbf{Z}(t)}{||\\mathbf{Z}(t)||_2}\n$$\n\nWhere:\n\n$$\n||\\mathbf{Z}(t)||_2 = \\sqrt{\\sum_i \\sum_j z_{ij}(t)^2}\n$$\n\n## Computing Node Similarities Across Different Graphs \n\nLet us see how this would work with real data. We will compare two subgraphs of the larger `law_advice` network [@lazega01] from the `networkdata` package. This is a directed *advice-seeking* network so a node goes *from* advisee to adviser. \n\nWe create two subgraphs. One composed of older male partners (aged fifty or older) and the other composed of the women in the firm (both partners and associates). They look like this:\n\n\n::: {.cell layout-ncol=\"1\"}\n::: {.cell-output-display}\n![Older Men Partners](blondel_files/figure-html/unnamed-chunk-1-1.png){width=768}\n:::\n\n::: {.cell-output-display}\n![Women Lawyers](blondel_files/figure-html/unnamed-chunk-1-2.png){width=768}\n:::\n:::\n\n\nA function to compute the **Blondel similarity** as described in @eq-blondel can be written as:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   blondel.sim <- function(a, b) {\n      if(is.null(rownames(a)) == TRUE) {rownames(a) <- 1:nrow(a)} #checking if matrix has row names\n      if(is.null(colnames(a)) == TRUE) {colnames(a) <- 1:ncol(a)} #checking if matrix has column names\n      if(is.null(rownames(b)) == TRUE) {rownames(b) <- 1:nrow(b)} #checking if matrix has row names\n      if(is.null(colnames(b)) == TRUE) {colnames(b) <- 1:ncol(b)} #checking if matrix has column names\n      z <- matrix(1, nrow(b), nrow(a)) #initializing similarity matrix to all ones matrix\n      rownames(z) <- rownames(b) #naming rows of similarity matrix\n      colnames(z) <- rownames(a) #naming columns of similarity matrix\n      d <- 1 #initializing  delta\n      d.o <- 2 #initializing comparison delta\n      m <- 1 #initializing iteration counter\n      while (d != d.o | m %% 2 != 0) { #do while the previous delta is different from the current delta and the iteration is odd\n         z.o <- z #initializing old similarity matrix\n         d.o <- d\n         z <- (b %*% z.o %*% t(a)) + (t(b) %*% z.o %*% a) #blondel et al. similarity equation\n         z <- z/norm(z, type = \"F\") #normalizing similarity matrix\n         d <- abs(sum(abs(z)) - sum(abs(z.o))) #updating delta\n         m <- m + 1 #updating \n         }\n      for(j in 1:ncol(z)) {z[, j] <- z[, j]/max(z[, j])} #normalizing converged matrix by column max\n   return(z) #return similarity matrix\n   }\n```\n:::\n\n\nWhich is modeled after our status game function but instead of computing a vector of scores we are populating a whole matrix!\n\nThe basic task is to figure out which nodes from the first matrix are most similar to which nodes from the second. That is, given these two networks can be identify actors who play similar roles in each?\n\nAnd here are the results presented in tabular form:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   library(kableExtra)\n   A <- as.matrix(as_adjacency_matrix(g1))\n   B <- as.matrix(as_adjacency_matrix(g2))\n   K <- blondel.sim(A, B) \n   kbl(K, align = \"c\", format = \"html\", \n   row.names = TRUE, digits = 2) %>% \n      column_spec(1, bold = TRUE) %>% \n      kable_styling(full_width = TRUE,\n                     bootstrap_options = c(\"hover\", \"condensed\", \"responsive\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> 1 </th>\n   <th style=\"text-align:center;\"> 2 </th>\n   <th style=\"text-align:center;\"> 3 </th>\n   <th style=\"text-align:center;\"> 4 </th>\n   <th style=\"text-align:center;\"> 5 </th>\n   <th style=\"text-align:center;\"> 6 </th>\n   <th style=\"text-align:center;\"> 7 </th>\n   <th style=\"text-align:center;\"> 8 </th>\n   <th style=\"text-align:center;\"> 9 </th>\n   <th style=\"text-align:center;\"> 10 </th>\n   <th style=\"text-align:center;\"> 11 </th>\n   <th style=\"text-align:center;\"> 12 </th>\n   <th style=\"text-align:center;\"> 13 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0.25 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.48 </td>\n   <td style=\"text-align:center;\"> 0.45 </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n   <td style=\"text-align:center;\"> 0.30 </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n   <td style=\"text-align:center;\"> 0.25 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2 </td>\n   <td style=\"text-align:center;\"> 0.39 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.27 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 3 </td>\n   <td style=\"text-align:center;\"> 0.64 </td>\n   <td style=\"text-align:center;\"> 0.63 </td>\n   <td style=\"text-align:center;\"> 0.54 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n   <td style=\"text-align:center;\"> 0.67 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.63 </td>\n   <td style=\"text-align:center;\"> 0.56 </td>\n   <td style=\"text-align:center;\"> 0.58 </td>\n   <td style=\"text-align:center;\"> 0.51 </td>\n   <td style=\"text-align:center;\"> 0.55 </td>\n   <td style=\"text-align:center;\"> 0.51 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 4 </td>\n   <td style=\"text-align:center;\"> 0.65 </td>\n   <td style=\"text-align:center;\"> 0.66 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.26 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.71 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.63 </td>\n   <td style=\"text-align:center;\"> 0.60 </td>\n   <td style=\"text-align:center;\"> 0.59 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.58 </td>\n   <td style=\"text-align:center;\"> 0.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 5 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.99 </td>\n   <td style=\"text-align:center;\"> 0.73 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 6 </td>\n   <td style=\"text-align:center;\"> 0.66 </td>\n   <td style=\"text-align:center;\"> 0.67 </td>\n   <td style=\"text-align:center;\"> 0.56 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.71 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.65 </td>\n   <td style=\"text-align:center;\"> 0.64 </td>\n   <td style=\"text-align:center;\"> 0.62 </td>\n   <td style=\"text-align:center;\"> 0.53 </td>\n   <td style=\"text-align:center;\"> 0.62 </td>\n   <td style=\"text-align:center;\"> 0.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 7 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 8 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.31 </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.26 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.30 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.31 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 9 </td>\n   <td style=\"text-align:center;\"> 0.49 </td>\n   <td style=\"text-align:center;\"> 0.44 </td>\n   <td style=\"text-align:center;\"> 0.88 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n   <td style=\"text-align:center;\"> 0.40 </td>\n   <td style=\"text-align:center;\"> 0.63 </td>\n   <td style=\"text-align:center;\"> 0.96 </td>\n   <td style=\"text-align:center;\"> 0.50 </td>\n   <td style=\"text-align:center;\"> 0.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.31 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 0.73 </td>\n   <td style=\"text-align:center;\"> 0.89 </td>\n   <td style=\"text-align:center;\"> 0.89 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.91 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> 0.30 </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n   <td style=\"text-align:center;\"> 0.82 </td>\n   <td style=\"text-align:center;\"> 0.39 </td>\n   <td style=\"text-align:center;\"> 0.60 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 11 </td>\n   <td style=\"text-align:center;\"> 0.86 </td>\n   <td style=\"text-align:center;\"> 0.86 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.82 </td>\n   <td style=\"text-align:center;\"> 0.58 </td>\n   <td style=\"text-align:center;\"> 0.76 </td>\n   <td style=\"text-align:center;\"> 0.57 </td>\n   <td style=\"text-align:center;\"> 0.86 </td>\n   <td style=\"text-align:center;\"> 0.79 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.82 </td>\n   <td style=\"text-align:center;\"> 0.86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 12 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.18 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n   <td style=\"text-align:center;\"> 0.17 </td>\n   <td style=\"text-align:center;\"> 0.21 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n   <td style=\"text-align:center;\"> 0.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 13 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.42 </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.26 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.43 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n   <td style=\"text-align:center;\"> 0.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 14 </td>\n   <td style=\"text-align:center;\"> 0.18 </td>\n   <td style=\"text-align:center;\"> 0.17 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.35 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.17 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.23 </td>\n   <td style=\"text-align:center;\"> 0.35 </td>\n   <td style=\"text-align:center;\"> 0.19 </td>\n   <td style=\"text-align:center;\"> 0.27 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 15 </td>\n   <td style=\"text-align:center;\"> 0.40 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.39 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.40 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 16 </td>\n   <td style=\"text-align:center;\"> 0.53 </td>\n   <td style=\"text-align:center;\"> 0.51 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.99 </td>\n   <td style=\"text-align:center;\"> 0.87 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> 0.91 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.54 </td>\n   <td style=\"text-align:center;\"> 0.69 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.61 </td>\n   <td style=\"text-align:center;\"> 0.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 17 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.44 </td>\n   <td style=\"text-align:center;\"> 0.70 </td>\n   <td style=\"text-align:center;\"> 0.74 </td>\n   <td style=\"text-align:center;\"> 0.49 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.58 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.53 </td>\n   <td style=\"text-align:center;\"> 0.55 </td>\n   <td style=\"text-align:center;\"> 0.81 </td>\n   <td style=\"text-align:center;\"> 0.57 </td>\n   <td style=\"text-align:center;\"> 0.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 18 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.31 </td>\n   <td style=\"text-align:center;\"> 0.67 </td>\n   <td style=\"text-align:center;\"> 0.81 </td>\n   <td style=\"text-align:center;\"> 0.63 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.72 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.82 </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n   <td style=\"text-align:center;\"> 0.67 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe can see that node 5 in the older men partner's graph (a highly central node in terms of being an advice seeker) is most similar to node 9 in the women lawyer's graph (also a highly central node in terms of being an advice seeker). Node 11 in the older men partner's graph, on the other hand, who's mostly an advice-giver, is most similar to node 5 in the women lawyer's graph who's also the most central advicee-giver. So it looks like it works!\n\n## Equivalence to HITS\n\nOne neat thing that @blondel_etal04 show is that we can also take a network and compare it to ideal-typical small graphs and get scores for how much each node in the observed network resembles each of the nodes in the hypothetical ideal-typical structure. \n\nMore specifically, they show that if we can run their algorithm to compare any network to the following two-node graph:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   g <- make_empty_graph(2)\n   g <- add_edges(g, c(1,2))\n   V(g)$name <- c(\"Hub\", \"Authority\")\n   plot(g, \n        edge.arrow.size=1, \n        vertex.color=\"tan2\", \n        vertex.size=12, vertex.frame.color=\"lightgray\", \n        vertex.label.color=\"black\", vertex.label.cex=1.5, \n        vertex.label.dist=-3)\n```\n\n::: {.cell-output-display}\n![](blondel_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nIn which case, the result \"similarity\" scores, will be equivalent to the Hub and Authority scores! \n\nWe can check that this is the case for the women's lawyers advice graph:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   A <- as.matrix(as_adjacency_matrix(g))\n   B <- as.matrix(as_adjacency_matrix(g2))\n   K <- blondel.sim(A, B)\n   tab <- cbind(K, Hub.Score = round(hits_scores(g2)$hub, 4), \n         Auth.Score = round(hits_scores(g2)$authority, 4))\n   kbl(tab, align = \"c\", format = \"html\", row.names = TRUE, digits = 2) %>% \n      column_spec(1, bold = TRUE) %>% \n      kable_styling(full_width = TRUE,\n                     bootstrap_options = c(\"hover\", \"condensed\", \"responsive\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> Hub </th>\n   <th style=\"text-align:center;\"> Authority </th>\n   <th style=\"text-align:center;\"> Hub.Score </th>\n   <th style=\"text-align:center;\"> Auth.Score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 3 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.60 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.60 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 4 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.78 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 5 </td>\n   <td style=\"text-align:center;\"> 0.17 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.17 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 6 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.78 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 7 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 8 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 9 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.90 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.90 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 11 </td>\n   <td style=\"text-align:center;\"> 0.61 </td>\n   <td style=\"text-align:center;\"> 0.66 </td>\n   <td style=\"text-align:center;\"> 0.61 </td>\n   <td style=\"text-align:center;\"> 0.66 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 12 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.21 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 13 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 14 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 15 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.40 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 16 </td>\n   <td style=\"text-align:center;\"> 0.84 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.84 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 17 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 18 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe first two columns are the scores using the function to compute the Blondel et al. similarity to each of the two nodes in the Hub/Authority micro-graph and the third and fourth columns are the scores we get from the `igraph` function `hits scores`, which as we can see, are identical. \n\n## Computing a Brokerage Score\n\nOf course in a directed graph, there are more than two ideal typical \"roles.\" In addition to \"sender\" (Hub) or \"receiver\" (Authority) we may also have \"intermediaries\" or \"pass along\" nodes. We can thus get an \"intermediary\" score for each node by comparing any network to the following three-node graph:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   g <- make_empty_graph(3)\n   g <- add_edges(g, c(1,2, 2,3))\n   V(g)$name <- c(\"Hub\", \"Broker\", \"Authority\")\n   plot(g, \n        edge.arrow.size=1, \n        vertex.color=\"tan2\", \n        vertex.size=12, vertex.frame.color=\"lightgray\", \n        vertex.label.color=\"black\", vertex.label.cex=1.5, \n        vertex.label.dist=2)\n```\n\n::: {.cell-output-display}\n![](blondel_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nHere are the results for the women lawyers graph:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   A <- as.matrix(as_adjacency_matrix(g))\n   B <- as.matrix(as_adjacency_matrix(g2))\n   K <- blondel.sim(A, B)\n   kbl(K, align = \"c\", format = \"html\", row.names = TRUE, digits = 2) %>% \n      column_spec(1, bold = TRUE) %>% \n      kable_styling(full_width = TRUE,\n                     bootstrap_options = c(\"hover\", \"condensed\", \"responsive\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> Hub </th>\n   <th style=\"text-align:center;\"> Broker </th>\n   <th style=\"text-align:center;\"> Authority </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2 </td>\n   <td style=\"text-align:center;\"> 0.13 </td>\n   <td style=\"text-align:center;\"> 0.35 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 3 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 4 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.49 </td>\n   <td style=\"text-align:center;\"> 0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 5 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.90 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 6 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.51 </td>\n   <td style=\"text-align:center;\"> 0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 7 </td>\n   <td style=\"text-align:center;\"> 0.13 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 8 </td>\n   <td style=\"text-align:center;\"> 0.25 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 9 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.82 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.99 </td>\n   <td style=\"text-align:center;\"> 0.69 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 11 </td>\n   <td style=\"text-align:center;\"> 0.54 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 12 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 13 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 0.41 </td>\n   <td style=\"text-align:center;\"> 0.30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 14 </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 15 </td>\n   <td style=\"text-align:center;\"> 0.13 </td>\n   <td style=\"text-align:center;\"> 0.42 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 16 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.87 </td>\n   <td style=\"text-align:center;\"> 0.25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 17 </td>\n   <td style=\"text-align:center;\"> 0.78 </td>\n   <td style=\"text-align:center;\"> 0.58 </td>\n   <td style=\"text-align:center;\"> 0.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 18 </td>\n   <td style=\"text-align:center;\"> 0.96 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.13 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nColumns one and three gives us versions of the Hub and Authority scores (respectively), but column two now gives us a \"score\" for how much the row node resembles and intermediary (or broker) in the network. We can see that the \"purest\" broker in the women's advice network is node 11. \n\n",
    "supporting": [
      "blondel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}