<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Graph Ensembles in Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Graph Ensembles in Networks">
<meta property="og:description" content="As we saw in the graph ensemble lesson, there are many approaches to randomizing the structure of one-mode networks when the aim is to create graph ensembles preserving selected properties.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Graph Ensembles in Networks</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centrality.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-walk.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-mode.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige-two-mode.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Handouts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#two-mode-erdos-renyi-model" id="toc-two-mode-erdos-renyi-model" class="nav-link active" data-scroll-target="#two-mode-erdos-renyi-model">Two-Mode Erdos-Renyi Model</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/tm-null.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Graph Ensembles in Networks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As we saw in the <a href="./swap.html">graph ensemble lesson</a>, there are many approaches to randomizing the structure of one-mode networks when the aim is to create <strong>graph ensembles</strong> preserving selected properties. These ensembles, in turn, can be used to do <strong>null hypothesis testing</strong> in networks.</p>
<p>Not surprisingly, a similar suite of techniques exist for the two-mode case, but until recently various approaches were scattered (and reduplicated) across a bunch of literatures in social network analysis, ecology, network physics, and computer science <span class="citation" data-cites="neal_etal24">(<a href="#ref-neal_etal24" role="doc-biblioref">Neal et al. 2024</a>)</span>.</p>
<section id="two-mode-erdos-renyi-model" class="level2">
<h2 class="anchored" data-anchor-id="two-mode-erdos-renyi-model">Two-Mode Erdos-Renyi Model</h2>
<p>Like with one-mode networks, the simplest null model for two-mode networks is one that preserves the number of nodes and the number of edges. This model, like we saw before, also preserves anything that is a function of these two-quantities. In the two-mode case, this is the bipartite graph’s <strong>density</strong> and the average degrees of the nodes in each mode (recall that two-mode networks have two average degrees). This is thus a two-mode version of the <strong>Erdos-Renyi</strong> null model.</p>
<p>Let’s load up the <em>Southern Women</em> (SW) data and see how it works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   A <span class="ot">&lt;-</span> <span class="fu">as_biadjacency_matrix</span>(southern_women)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s compute some basic network statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   d <span class="ot">&lt;-</span> <span class="fu">sum</span>(A)<span class="sc">/</span>(<span class="fu">nrow</span>(A)<span class="sc">*</span><span class="fu">ncol</span>(A)) <span class="co">#density</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>   ad.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(A)) <span class="co">#average degree of people</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>   ad.g <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">colSums</span>(A)) <span class="co">#average degree of groups</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>   d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3531746</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>   ad.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.944444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   ad.g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.357143</code></pre>
</div>
</div>
<p>We can see that the density of the SW network is <span class="math inline">\(d=\)</span> 0.35, the average degree of people <span class="math inline">\(\bar{k_p}=\)</span> 4.94 and the average degree of groups <span class="math inline">\(\bar{k_g}=\)</span> 6.36.</p>
<p>Now, let’s compute something on this network, like the <strong>degree correlation</strong> between people and groups, answering the question: Do people with lots of memberships tend to join larger groups?</p>
<p>First let’s create an edge list data frame with the incident nodes’ degrees and compute the correlation between the respective degrees:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   v.a <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(A)</span>
<span id="cb8-2"><a href="#cb8-2"></a>   rn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(A), <span class="fu">ncol</span>(A))</span>
<span id="cb8-3"><a href="#cb8-3"></a>   cn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(A), <span class="at">each =</span> <span class="fu">nrow</span>(A))</span>
<span id="cb8-4"><a href="#cb8-4"></a>   rd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rowSums</span>(A), <span class="fu">ncol</span>(A))</span>
<span id="cb8-5"><a href="#cb8-5"></a>   cd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">colSums</span>(A), <span class="at">each =</span> <span class="fu">nrow</span>(A))</span>
<span id="cb8-6"><a href="#cb8-6"></a>   d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p =</span> rn,  <span class="at">c =</span> cn, <span class="at">e =</span> v.a, <span class="at">rd =</span>  rd, <span class="at">cd =</span> cd)</span>
<span id="cb8-7"><a href="#cb8-7"></a>   <span class="fu">cor</span>(d[d<span class="sc">$</span>e <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span>rd, d[d<span class="sc">$</span>e <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span>cd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2783186</code></pre>
</div>
</div>
<p>Which is negative, suggesting degree <strong>anti-correlation</strong> in this network (people with lots of memberships tend to belong to smaller groups).</p>
<p>Is this value statistically significant net of the network density? To find out, we need to create a <strong>two-mode graph ensemble</strong> of networks with the same density, number of persons, and number of groups as SW.</p>
<p>A simple approach goes like this. First, let’s create a vectorized version of the adjacency matrix and assign a number from 1:<span class="math inline">\(M\)</span> (where <span class="math inline">\(M = |P| \times |G|\)</span>, the number of cells in the biadjacency matrix) to each value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>   v.a <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(A)</span>
<span id="cb10-2"><a href="#cb10-2"></a>   M <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)<span class="sc">*</span><span class="fu">ncol</span>(A)</span>
<span id="cb10-3"><a href="#cb10-3"></a>   <span class="fu">names</span>(v.a) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>M</span>
<span id="cb10-4"><a href="#cb10-4"></a>   v.a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
  1   1   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1 
 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 
  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   1 
 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 
  1   1   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   1   1   0 
 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 
  0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   1   1   1   1   0 
 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 
  1   0   0   0   0   0   0   0   0   0   1   1   1   1   0   1   1   1   0   0 
101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 
  0   0   0   1   0   0   0   0   0   1   1   1   1   0   1   0   1   1   0   0 
121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  1   1   1   0   0   0   1   1   1   1   0   1   1   1   1   1   1   1   1   0 
141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 
  1   1   0   0   1   0   1   0   0   0   0   1   1   1   1   1   1   1   0   1 
161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 
  1   1   0   0   0   0   0   0   0   0   0   0   1   1   1   1   1   0   0   0 
181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 
  0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   1   1   0   0 
201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 
  0   0   0   0   0   0   0   1   1   1   1   1   1   0   0   0   0   0   0   0 
221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 
  0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   0   0   0   0 
241 242 243 244 245 246 247 248 249 250 251 252 
  0   0   0   0   0   1   1   1   0   0   0   0 </code></pre>
</div>
</div>
<p>Now we can just permute the labels of the vector, and re-order them to generate a new biadjacency matrix <code>A.perm</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>   s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>M)</span>
<span id="cb12-2"><a href="#cb12-2"></a>   v.perm <span class="ot">&lt;-</span> v.a</span>
<span id="cb12-3"><a href="#cb12-3"></a>   <span class="fu">names</span>(v.perm) <span class="ot">&lt;-</span> s</span>
<span id="cb12-4"><a href="#cb12-4"></a>   v.perm <span class="ot">&lt;-</span> v.perm[<span class="fu">names</span>(v.a)] <span class="co">#reordering vector</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>   A.perm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(v.perm, <span class="at">nrow =</span> <span class="fu">nrow</span>(A)) <span class="co">#creating permuted biadjacency matrix</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>   <span class="fu">rownames</span>(A.perm) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb12-7"><a href="#cb12-7"></a>   <span class="fu">colnames</span>(A.perm) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb12-8"><a href="#cb12-8"></a>   A.perm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          6/27 3/2 4/12 9/26 2/25 5/19 3/15 9/16 4/8 6/10 2/23 4/7 11/21 8/3
EVELYN       1   0    0    0    1    0    0    0   0    0    0   0     1   0
LAURA        0   1    1    0    1    0    1    1   0    0    0   0     0   0
THERESA      0   1    1    0    1    1    0    0   0    0    0   0     0   0
BRENDA       0   0    0    0    0    1    0    0   0    0    0   0     0   0
CHARLOTTE    0   0    0    0    0    0    0    0   0    0    1   0     1   1
FRANCES      0   0    1    1    0    0    1    0   0    1    1   0     1   0
ELEANOR      1   1    1    1    0    1    1    0   1    0    1   1     1   1
PEARL        1   1    1    1    0    0    0    0   0    0    0   0     0   0
RUTH         1   0    0    0    0    0    0    0   0    1    0   1     1   0
VERNE        0   1    0    0    0    0    0    0   0    1    0   1     0   0
MYRNA        1   0    1    0    0    0    0    0   0    1    1   0     0   1
KATHERINE    0   0    0    0    1    0    1    1   1    0    1   0     1   0
SYLVIA       1   0    1    1    0    1    1    1   0    0    0   0     0   0
NORA         0   1    1    0    1    0    1    1   0    0    0   0     1   1
HELEN        0   1    0    0    1    1    0    1   1    0    1   0     0   1
DOROTHY      0   0    0    0    1    0    0    1   1    1    0   0     1   1
OLIVIA       1   0    0    0    1    0    0    1   0    0    0   0     0   0
FLORA        0   0    0    1    1    0    0    1   0    0    1   1     0   0</code></pre>
</div>
</div>
<p>We can verify that <code>A.perm</code> has the same basic network statistics as <code>A</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   d <span class="ot">&lt;-</span> <span class="fu">sum</span>(A.perm)<span class="sc">/</span>(<span class="fu">nrow</span>(A.perm)<span class="sc">*</span><span class="fu">ncol</span>(A.perm)) <span class="co">#density</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>   ad.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(A.perm)) <span class="co">#average degree of people</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>   ad.g <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">colSums</span>(A.perm)) <span class="co">#average degree of groups</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>   d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3531746</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>   ad.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.944444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>   ad.g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.357143</code></pre>
</div>
</div>
<p>But <em>not</em> the same degree distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   <span class="fu">rowSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        8         7         8         7         4         4         4         3 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         4         4         6         7         8         5         2 
   OLIVIA     FLORA 
        2         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   <span class="fu">rowSums</span>(A.perm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        3         5         4         1         3         6        11         4 
     RUTH     VERNE     MYRNA KATHERINE    SYLVIA      NORA     HELEN   DOROTHY 
        4         3         5         6         6         7         7         6 
   OLIVIA     FLORA 
        3         5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   <span class="fu">colSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    3     3     6     4     8     8    10    14    12     5     4     6     3 
  8/3 
    3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>   <span class="fu">colSums</span>(A.perm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    7     7     8     5     9     5     6     8     4     5     7     4     8 
  8/3 
    6 </code></pre>
</div>
</div>
<p>We can now package the two-mode permutation steps into a function called <code>tm.perm</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>   tm.perm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb28-2"><a href="#cb28-2"></a>      z <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)<span class="sc">*</span><span class="fu">ncol</span>(x)</span>
<span id="cb28-3"><a href="#cb28-3"></a>      l <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span>z)</span>
<span id="cb28-4"><a href="#cb28-4"></a>      s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>z)</span>
<span id="cb28-5"><a href="#cb28-5"></a>      v <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(x)</span>
<span id="cb28-6"><a href="#cb28-6"></a>      <span class="fu">names</span>(v) <span class="ot">&lt;-</span> s</span>
<span id="cb28-7"><a href="#cb28-7"></a>      v <span class="ot">&lt;-</span> v[l]</span>
<span id="cb28-8"><a href="#cb28-8"></a>      w <span class="ot">&lt;-</span> <span class="fu">matrix</span>(v, <span class="at">nrow =</span> <span class="fu">nrow</span>(x))</span>
<span id="cb28-9"><a href="#cb28-9"></a>      <span class="fu">rownames</span>(w) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(x)</span>
<span id="cb28-10"><a href="#cb28-10"></a>      <span class="fu">colnames</span>(w) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(x)</span>
<span id="cb28-11"><a href="#cb28-11"></a>      <span class="fu">return</span>(w)</span>
<span id="cb28-12"><a href="#cb28-12"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And generate an Erdos-Renyi graph ensemble for the SW data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>   <span class="fu">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>   G <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>, <span class="fu">tm.perm</span>(A), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then package the steps above into a two-mode degree correlation function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>   tm.deg.corr <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>      d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">e =</span> <span class="fu">as.vector</span>(x), </span>
<span id="cb30-3"><a href="#cb30-3"></a>                      <span class="at">rd =</span> <span class="fu">rep</span>(<span class="fu">rowSums</span>(x), <span class="fu">ncol</span>(x)), </span>
<span id="cb30-4"><a href="#cb30-4"></a>                      <span class="at">cd =</span> <span class="fu">rep</span>(<span class="fu">colSums</span>(x), <span class="at">each =</span> <span class="fu">nrow</span>(x)))</span>
<span id="cb30-5"><a href="#cb30-5"></a>      <span class="fu">return</span>(<span class="fu">cor</span>(d[d<span class="sc">$</span>e <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span>rd, d[d<span class="sc">$</span>e <span class="sc">==</span> <span class="dv">1</span>, ]<span class="sc">$</span>cd))</span>
<span id="cb30-6"><a href="#cb30-6"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And compute it across our ensemble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>   corrs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(G, tm.deg.corr)</span>
<span id="cb31-2"><a href="#cb31-2"></a>   corrs[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="co">#first hundred entries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  0.0760021893 -0.1348203679 -0.1694265983  0.0718510150 -0.0600115860
  [6] -0.2374190808  0.0237031449  0.1173741356 -0.0260733311  0.1416253809
 [11]  0.1184189968 -0.0289596593 -0.0730215167  0.0095106371 -0.1964173575
 [16]  0.1596845191 -0.1355133618  0.0180448467 -0.1087077279 -0.1046313791
 [21]  0.0811773307 -0.1700579702 -0.1683615931 -0.0879076569 -0.1708282944
 [26] -0.1234216407 -0.1222169590 -0.1752430252 -0.0771362047  0.0374001159
 [31] -0.3363039453 -0.0215314138 -0.1361914116  0.0236148748  0.0904123313
 [36]  0.0854149823 -0.1092669645 -0.0968902488  0.0655271276  0.0839894527
 [41] -0.1372253130 -0.0250088463 -0.0752489834 -0.0646135286 -0.0050636524
 [46] -0.1434413069  0.0394530627 -0.0294602605  0.0621823678  0.0452125858
 [51]  0.1488401015 -0.1589331412 -0.0150605405 -0.1804322595  0.0553501794
 [56] -0.1313982596 -0.1601437081 -0.0834589259 -0.0318101556 -0.0418927041
 [61] -0.1673209567 -0.0781911355 -0.0237342903 -0.0468442301 -0.1678850228
 [66] -0.1131891529 -0.1385607565 -0.0370619914 -0.1153888854 -0.2140948633
 [71] -0.0023642670 -0.0620337449 -0.0435028327  0.0480923464  0.0542443957
 [76] -0.0877253584 -0.0246771154  0.0005149925  0.1174570125 -0.1311654686
 [81] -0.0993590626 -0.0003062831  0.0357750520 -0.1040233078 -0.2628413829
 [86] -0.1411546883 -0.0616393144  0.0397847088 -0.2262041963 -0.1711172380
 [91] -0.0729372910 -0.0718569434 -0.2789671901 -0.1370995229  0.0519466480
 [96] -0.0714731685 -0.0634881474 -0.0203817674 -0.0830534979  0.0228451012</code></pre>
</div>
</div>
<p>So let’s see how our observed value stacks up in the grand scheme:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>   <span class="fu">library</span>(ggplot2)</span>
<span id="cb33-2"><a href="#cb33-2"></a>   p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(corrs, <span class="dv">2</span>)), <span class="fu">aes</span>(<span class="at">x =</span> corrs))</span>
<span id="cb33-3"><a href="#cb33-3"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.015</span>, <span class="at">stat =</span> <span class="st">"bin"</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">tm.deg.corr</span>(A), </span>
<span id="cb33-5"><a href="#cb33-5"></a>                       <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">1</span>, </span>
<span id="cb33-7"><a href="#cb33-7"></a>                       <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>)</span>
<span id="cb33-8"><a href="#cb33-8"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Q by Level"</span>, <span class="at">y =</span> <span class="st">"Freq."</span>)</span>
<span id="cb33-9"><a href="#cb33-9"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb33-10"><a href="#cb33-10"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="sc">-</span><span class="fl">0.05</span>, <span class="at">y=</span><span class="dv">47</span>, <span class="at">label=</span> <span class="st">"Zero Point"</span>, <span class="at">color =</span> <span class="st">"purple"</span>)</span>
<span id="cb33-11"><a href="#cb33-11"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="sc">-</span><span class="fl">0.23</span>, <span class="at">y=</span><span class="dv">47</span>, <span class="at">label=</span> <span class="st">"Obs. Value"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb33-12"><a href="#cb33-12"></a>   p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-null_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which looks close to the tail end of the negative spectrum. We can compute the value that corresponds to the 99th percentile of the assortativity distribution from the ensemble and then see if what observe is below that value (corresponding to <span class="math inline">\(p &lt; 0.01\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>   <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      99% 
0.1489135 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>   <span class="fu">tm.deg.corr</span>(A) <span class="sc">&lt;</span> <span class="fu">quantile</span>(corrs, <span class="at">probs =</span> <span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 99% 
TRUE </code></pre>
</div>
</div>
<p>Which is definitely true in this null graph ensemble, suggesting that degree anti-correlation is present in the SW data, net of density.</p>
<p>As before, if we wanted a more stringent two-tailed we would need to create a vector with the <em>absolute value</em> of the two-mode degree correlation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>   <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(corrs))(<span class="fu">abs</span>(<span class="fu">tm.deg.corr</span>(A)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01</code></pre>
</div>
</div>
<p>Which is stil statistically significant at conventional levels.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-neal_etal24" class="csl-entry" role="doc-biblioentry">
Neal, Zachary P, Annabell Cadieux, Diego Garlaschelli, Nicholas J Gotelli, Fabio Saracco, Tiziano Squartini, Shade T Shutters, Werner Ulrich, Guanyang Wang, and Giovanni Strona. 2024. <span>“Pattern Detection in Bipartite Networks: A Review of Terminology, Applications, and Methods.”</span> <em>PLOS Complex Systems</em> 1 (2): e0000010.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>