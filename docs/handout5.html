<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Vertex Similarity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Vertex Similarity">
<meta property="og:description" content="As we noted in the role equivalence handout, for odd reasons, classical approaches to structural similarity in networks used distance based approaches but did not measure similarity directly.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Vertex Similarity</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Handouts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout1.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inoutdegdist.html" class="sidebar-item-text sidebar-link">Graph Degree Metrics in Directed Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout2.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout3.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout4.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout5.html" class="sidebar-item-text sidebar-link active">Vertex Similarity</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#basic-ingredients-of-vertex-similarity-metrics" id="toc-basic-ingredients-of-vertex-similarity-metrics" class="nav-link active" data-scroll-target="#basic-ingredients-of-vertex-similarity-metrics">Basic Ingredients of Vertex Similarity Metrics</a></li>
  <li><a href="#normalized-similarity-metrics" id="toc-normalized-similarity-metrics" class="nav-link" data-scroll-target="#normalized-similarity-metrics">Normalized Similarity Metrics</a></li>
  <li><a href="#similarity-and-structural-equivalence" id="toc-similarity-and-structural-equivalence" class="nav-link" data-scroll-target="#similarity-and-structural-equivalence">Similarity and Structural Equivalence</a></li>
  <li><a href="#generalized-similarities" id="toc-generalized-similarities" class="nav-link" data-scroll-target="#generalized-similarities">Generalized Similarities</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/handout5.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Vertex Similarity</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As we noted in the role equivalence handout, for odd reasons, classical approaches to structural similarity in networks used <em>distance</em> based approaches but did not measure similarity directly. More recent approaches from network and information science prefer to define vertex similarity using direct similarity measures based on local structural characteristics, like node neighborhoods.</p>
<p>Mathematically, similarity is a less stringent (but also less well-defined) relation between pairs of nodes in a graph than distance, so it can be easier to work with in most applications.</p>
<p>For instance, similarity is required to be symmetric (<span class="math inline">\(s_{ij} = s_{ji}\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>) and most metrics have reasonable bounds (e.g., 0 for least similar and 1.0 for maximally similar). Given such a bounded similarity we can get to <em>dissimilarity</em> by subtracting one: <span class="math inline">\(d_{ij} = 1 - s_{ij}\)</span></p>
<section id="basic-ingredients-of-vertex-similarity-metrics" class="level2">
<h2 class="anchored" data-anchor-id="basic-ingredients-of-vertex-similarity-metrics">Basic Ingredients of Vertex Similarity Metrics</h2>
<p>Consider two nodes and the set of nodes that are the immediate neighbors to each. In this case, most vertex similarity measures will make use of three pieces of information:</p>
<ol type="1">
<li><p>The number of common neighbors <span class="math inline">\(p\)</span>.</p></li>
<li><p>The number of actors <span class="math inline">\(q\)</span> who are connected to node <span class="math inline">\(i\)</span> but not to node <span class="math inline">\(j\)</span>.</p></li>
<li><p>The number of actors <span class="math inline">\(r\)</span> who are connected to node <span class="math inline">\(j\)</span> but not to node <span class="math inline">\(i\)</span>.</p></li>
</ol>
<p>In the simplest case of the binary undirected graph then these are given by:</p>
<p><span class="math display">\[
   p = \sum_{k = 1}^{n} a_{ik} a_{jk}
\]</span></p>
<p><span class="math display">\[
   q = \sum_{k = 1}^{n} a_{ik} (1 - a_{jk})
\]</span></p>
<p><span class="math display">\[
   r = \sum_{k = 1}^{n} (1- a_{ik}) a_{jk}
\]</span></p>
<p>In matrix form:</p>
<p><span class="math display">\[
   \mathbf{A}(p) = \mathbf{A} \mathbf{A}
\]</span></p>
<p><span class="math display">\[
   \mathbf{A}(q) = \mathbf{A} (1 - \mathbf{A})
\]</span></p>
<p><span class="math display">\[
   \mathbf{A}(r) = (1 - \mathbf{A}) \mathbf{A}
\]</span></p>
<p>Let’s look at an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   g.flint <span class="ot">&lt;-</span> movie_267</span>
<span id="cb1-4"><a href="#cb1-4"></a>   g.flint <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.flint, <span class="fu">degree</span>(g.flint) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g.flint))</span>
<span id="cb1-6"><a href="#cb1-6"></a>   A.p <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A <span class="co">#common neighbors matrix</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>   A.q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="co">#neighbors of i not connected to j</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>   A.r <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">%*%</span> A <span class="co">#neighbors of j not connected to i</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>   A.p[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM            6      4     5        2    5            2          2    5
BARNEY             4     13     9        1   11            5          3    7
BETTY              5      9    13        2    9            3          4    8
FELDSPAR           2      1     2        2    1            0          2    2
FRED               5     11     9        1   14            4          3    9
HEADMISTRESS       2      5     3        0    4            5          0    3
HERDMASTER         2      3     4        2    3            0          4    4
LAVA               5      7     8        2    9            3          4   11
LEACH              2      3     3        1    2            2          1    2
MORRIS             2      3     2        0    2            3          0    2
             LEACH MORRIS
BAM-BAM          2      2
BARNEY           3      3
BETTY            3      2
FELDSPAR         1      0
FRED             2      2
HEADMISTRESS     2      3
HERDMASTER       1      0
LAVA             2      2
LEACH            3      1
MORRIS           1      3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>   A.q[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM            0      2     1        4    1            4          4    1
BARNEY             9      0     4       12    2            8         10    6
BETTY              8      4     0       11    4           10          9    5
FELDSPAR           0      1     0        0    1            2          0    0
FRED               9      3     5       13    0           10         11    5
HEADMISTRESS       3      0     2        5    1            0          5    2
HERDMASTER         2      1     0        2    1            4          0    0
LAVA               6      4     3        9    2            8          7    0
LEACH              1      0     0        2    1            1          2    1
MORRIS             1      0     1        3    1            0          3    1
             LEACH MORRIS
BAM-BAM          4      4
BARNEY          10     10
BETTY           10     11
FELDSPAR         1      2
FRED            12     12
HEADMISTRESS     3      2
HERDMASTER       3      4
LAVA             9      9
LEACH            0      2
MORRIS           2      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>   A.r[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM            0      9     8        0    9            3          2    6
BARNEY             2      0     4        1    3            0          1    4
BETTY              1      4     0        0    5            2          0    3
FELDSPAR           4     12    11        0   13            5          2    9
FRED               1      2     4        1    0            1          1    2
HEADMISTRESS       4      8    10        2   10            0          4    8
HERDMASTER         4     10     9        0   11            5          0    7
LAVA               1      6     5        0    5            2          0    0
LEACH              4     10    10        1   12            3          3    9
MORRIS             4     10    11        2   12            2          4    9
             LEACH MORRIS
BAM-BAM          1      1
BARNEY           0      0
BETTY            0      1
FELDSPAR         2      3
FRED             1      1
HEADMISTRESS     1      0
HERDMASTER       2      3
LAVA             1      1
LEACH            0      2
MORRIS           2      0</code></pre>
</div>
</div>
<p>Note that while <span class="math inline">\(\mathbf{A}(p)\)</span> is necessarily symmetric, neither <span class="math inline">\(q\)</span> nor <span class="math inline">\(r\)</span> have to be. Barney has many more neighbors that Bam-Bam is not connected to than vice versa. Also note that the <span class="math inline">\(\mathbf{A}(r)\)</span> matrix is just the transpose of the <span class="math inline">\(\mathbf{A}(q)\)</span> matrix in the undirected case.</p>
<p>So the most obvious measure of similarity between two nodes is simply the number of common neighbors <span class="citation" data-cites="leicht_etal06">(<a href="#ref-leicht_etal06" role="doc-biblioref">Leicht, Holme, and Newman 2006</a>)</span>:</p>
<p><span class="math display">\[
   s_{ij} = p_{ij}
\]</span></p>
<p>We have already seen a version of this in the directed case when talking about the HITS algorithm <span class="citation" data-cites="kleinberg99">(<a href="#ref-kleinberg99" role="doc-biblioref">Kleinberg 1999</a>)</span>, which computes a spectral (eigenvector-based) ranking based on the matrices of common in and out-neighbors in a directed graph.</p>
<p><span class="math display">\[
   p^{in} = \sum_{k = 1}^{n} a_{ki} a_{kj}
\]</span></p>
<p><span class="math display">\[
   p^{out} = \sum_{k = 1}^{n} a_{ik} a_{jk}
\]</span></p>
<p>Which in matrix form is:</p>
<p><span class="math display">\[
   \mathbf{A}(p^{out}) = \mathbf{A}^T \mathbf{A}
\]</span></p>
<p><span class="math display">\[
   \mathbf{A}(p^{in}) = \mathbf{A} \mathbf{A}^T
\]</span></p>
<p>In this case, similarity can be measured <em>either</em> by the number of common in-neighbors or the number of common out-neighbors.</p>
<p>If the network under consideration is a (directed) <strong>citation network</strong> with nodes being papers and links between papers defined as a citation from paper <span class="math inline">\(i\)</span> to paper <span class="math inline">\(j\)</span>, then the number of <em>common in-neighbors</em> between two papers is their <strong>co-citation</strong> similarity (the number of other papers that cite both papers), and the number of <em>common out-neighbors</em> is their <strong>bibliographic coupling</strong> similarity (the overlap in their list of references).</p>
<p>One problem with using unbounded quantities like the sheer number of common (in or out) neighbors to define node similarity is that they are only limited by the number of nodes in the network <span class="citation" data-cites="leicht_etal06">(<a href="#ref-leicht_etal06" role="doc-biblioref">Leicht, Holme, and Newman 2006</a>)</span>. Thus, an actor with many neighbors will end up having lots of other neighbors in common with lots of other nodes, which will mean we would count them as “similar” to almost everyone.</p>
</section>
<section id="normalized-similarity-metrics" class="level2">
<h2 class="anchored" data-anchor-id="normalized-similarity-metrics">Normalized Similarity Metrics</h2>
<p>Normalized similarity metrics deal with this issue by adjusting the raw similarity based on <span class="math inline">\(p\)</span> using the number of non-shared neighbors <span class="math inline">\(q\)</span> and <span class="math inline">\(r\)</span>.</p>
<p>The two most popular versions of normalized vertex similarity scores are the <strong>Jaccard index</strong> and the <strong>cosine coefficient</strong>.</p>
<p>The Jacccard index is given by:</p>
<p><span class="math display">\[
   s_{ij} = \frac{p}{p + q + r}
\]</span></p>
<p>Which is the ratio of the size of the <em>intersection</em> of the neighborhoods of the two nodes (number of common neighbors) divided by the size of the <em>union</em> of the two neighborhoods.</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>   J <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (A.p <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb7-2"><a href="#cb7-2"></a>   <span class="fu">round</span>(J[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         1.00   0.27  0.36     0.33 0.33         0.22       0.25 0.42
BARNEY          0.27   1.00  0.53     0.07 0.69         0.38       0.21 0.41
BETTY           0.36   0.53  1.00     0.15 0.50         0.20       0.31 0.50
FELDSPAR        0.33   0.07  0.15     1.00 0.07         0.00       0.50 0.18
FRED            0.33   0.69  0.50     0.07 1.00         0.27       0.20 0.56
HEADMISTRESS    0.22   0.38  0.20     0.00 0.27         1.00       0.00 0.23
HERDMASTER      0.25   0.21  0.31     0.50 0.20         0.00       1.00 0.36
LAVA            0.42   0.41  0.50     0.18 0.56         0.23       0.36 1.00
LEACH           0.29   0.23  0.23     0.25 0.13         0.33       0.17 0.17
MORRIS          0.29   0.23  0.14     0.00 0.13         0.60       0.00 0.17
             LEACH MORRIS
BAM-BAM       0.29   0.29
BARNEY        0.23   0.23
BETTY         0.23   0.14
FELDSPAR      0.25   0.00
FRED          0.13   0.13
HEADMISTRESS  0.33   0.60
HERDMASTER    0.17   0.00
LAVA          0.17   0.17
LEACH         1.00   0.20
MORRIS        0.20   1.00</code></pre>
</div>
</div>
<p>Here showing that Barney is more similar to Fred and Betty than he is to Bam-Bam.</p>
<p>The cosine coefficient is given by:</p>
<p><span class="math display">\[
   s_{ij} = \frac{p}{\sqrt{p + q} \sqrt{p + r}}
\]</span></p>
<p>Which is the ratio of the number of common neighbors divided by the product of the square root of the degrees of each node, since <span class="math inline">\(p\)</span> + <span class="math inline">\(q\)</span> is the degree of node <span class="math inline">\(i\)</span> and <span class="math inline">\(p\)</span> + <span class="math inline">\(r\)</span> is the degree of node <span class="math inline">\(j\)</span>.</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>   C <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (<span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.q) <span class="sc">*</span> <span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.r))</span>
<span id="cb9-2"><a href="#cb9-2"></a>   <span class="fu">round</span>(C[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         1.00   0.45  0.57     0.58 0.55         0.37       0.41 0.62
BARNEY          0.45   1.00  0.69     0.20 0.82         0.62       0.42 0.59
BETTY           0.57   0.69  1.00     0.39 0.67         0.37       0.55 0.67
FELDSPAR        0.58   0.20  0.39     1.00 0.19         0.00       0.71 0.43
FRED            0.55   0.82  0.67     0.19 1.00         0.48       0.40 0.73
HEADMISTRESS    0.37   0.62  0.37     0.00 0.48         1.00       0.00 0.40
HERDMASTER      0.41   0.42  0.55     0.71 0.40         0.00       1.00 0.60
LAVA            0.62   0.59  0.67     0.43 0.73         0.40       0.60 1.00
LEACH           0.47   0.48  0.48     0.41 0.31         0.52       0.29 0.35
MORRIS          0.47   0.48  0.32     0.00 0.31         0.77       0.00 0.35
             LEACH MORRIS
BAM-BAM       0.47   0.47
BARNEY        0.48   0.48
BETTY         0.48   0.32
FELDSPAR      0.41   0.00
FRED          0.31   0.31
HEADMISTRESS  0.52   0.77
HERDMASTER    0.29   0.00
LAVA          0.35   0.35
LEACH         1.00   0.33
MORRIS        0.33   1.00</code></pre>
</div>
</div>
<p>Showing results similar (pun intended) to those obtained using the Jaccard index.</p>
<p>A less commonly used option is the <strong>Dice Coefficient</strong> given by:</p>
<p><span class="math display">\[
   s_{ij} = \frac{2p}{2p + q + r}
\]</span></p>
<p>Which is given by the ratio of the number of <em>twice</em> the number of common neighbors divided by twice the same quantity plus the sum of the non-shared neighbors (and thus a variation of the Jaccard measure).</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>   D <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb11-2"><a href="#cb11-2"></a>   <span class="fu">round</span>(D[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         1.00   0.42  0.53     0.50 0.50         0.36       0.40 0.59
BARNEY          0.42   1.00  0.69     0.13 0.81         0.56       0.35 0.58
BETTY           0.53   0.69  1.00     0.27 0.67         0.33       0.47 0.67
FELDSPAR        0.50   0.13  0.27     1.00 0.12         0.00       0.67 0.31
FRED            0.50   0.81  0.67     0.12 1.00         0.42       0.33 0.72
HEADMISTRESS    0.36   0.56  0.33     0.00 0.42         1.00       0.00 0.38
HERDMASTER      0.40   0.35  0.47     0.67 0.33         0.00       1.00 0.53
LAVA            0.59   0.58  0.67     0.31 0.72         0.38       0.53 1.00
LEACH           0.44   0.38  0.38     0.40 0.24         0.50       0.29 0.29
MORRIS          0.44   0.38  0.25     0.00 0.24         0.75       0.00 0.29
             LEACH MORRIS
BAM-BAM       0.44   0.44
BARNEY        0.38   0.38
BETTY         0.38   0.25
FELDSPAR      0.40   0.00
FRED          0.24   0.24
HEADMISTRESS  0.50   0.75
HERDMASTER    0.29   0.00
LAVA          0.29   0.29
LEACH         1.00   0.33
MORRIS        0.33   1.00</code></pre>
</div>
</div>
<p>Once again, showing results comparable to the previous.</p>
<p>Note, that all three of these pairwise measures of similarity are bounded between zero and one, with nodes being maximally similar to themselves and with pairs of distinct nodes being maximally similar when they have the same set of neighbors (e.g., they are structurally equivalent).</p>
<p><span class="citation" data-cites="leicht_etal06">Leicht, Holme, and Newman (<a href="#ref-leicht_etal06" role="doc-biblioref">2006</a>)</span> introduce a variation on the theme of normalized structural similarity scores. Their point is that maybe we should care about nodes that are <em>surprisingly</em> similar given some suitable null model. They propose the <strong>configuration model</strong> as such a null model. This model takes a graph with the same degree distribution as the original but with connections formed at random as reference.</p>
<p>The <strong>LHN similarity index</strong> (for Leicht, Holme, and Newman) is then given by:</p>
<p><span class="math display">\[
s_{ij} = \frac{p}{(p + q)(p + r)}
\]</span></p>
<p>Which can be seen as a variation of the cosine similarity defined earlier.</p>
<p>In our example, this would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   D <span class="ot">&lt;-</span> A.p <span class="sc">/</span> ((A.p <span class="sc">+</span> A.q) <span class="sc">*</span> (A.p <span class="sc">+</span> A.r))</span>
<span id="cb13-2"><a href="#cb13-2"></a>   <span class="fu">round</span>(D[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             BAM-BAM BARNEY BETTY FELDSPAR FRED HEADMISTRESS HERDMASTER LAVA
BAM-BAM         0.17   0.05  0.06     0.17 0.06         0.07       0.08 0.08
BARNEY          0.05   0.08  0.05     0.04 0.06         0.08       0.06 0.05
BETTY           0.06   0.05  0.08     0.08 0.05         0.05       0.08 0.06
FELDSPAR        0.17   0.04  0.08     0.50 0.04         0.00       0.25 0.09
FRED            0.06   0.06  0.05     0.04 0.07         0.06       0.05 0.06
HEADMISTRESS    0.07   0.08  0.05     0.00 0.06         0.20       0.00 0.05
HERDMASTER      0.08   0.06  0.08     0.25 0.05         0.00       0.25 0.09
LAVA            0.08   0.05  0.06     0.09 0.06         0.05       0.09 0.09
LEACH           0.11   0.08  0.08     0.17 0.05         0.13       0.08 0.06
MORRIS          0.11   0.08  0.05     0.00 0.05         0.20       0.00 0.06
             LEACH MORRIS
BAM-BAM       0.11   0.11
BARNEY        0.08   0.08
BETTY         0.08   0.05
FELDSPAR      0.17   0.00
FRED          0.05   0.05
HEADMISTRESS  0.13   0.20
HERDMASTER    0.08   0.00
LAVA          0.06   0.06
LEACH         0.33   0.11
MORRIS        0.11   0.33</code></pre>
</div>
</div>
<p>Which, once again, produces similar results to what we found before. Note, however, that the LHN is not naturally maximal for self-similar nodes.</p>
</section>
<section id="similarity-and-structural-equivalence" class="level2">
<h2 class="anchored" data-anchor-id="similarity-and-structural-equivalence">Similarity and Structural Equivalence</h2>
<p>All normalized similarity measures bounded between zero and one (like Jaccard, Cosine, and Dice) also define a <em>distance</em> on each pair of nodes which is equal to one minus the similarity. So the <strong>cosine distance</strong> between two nodes is one minus the cosine similarity, and so on for the Jaccard and Dice indexes.</p>
<p>Because they define distances, this also means that these approaches can be used to find approximately structurally equivalent classes of nodes in a graph just like we did with the Euclidean and correlation distances.</p>
<p>For instance, consider our toy graph from before with four structurally equivalent sets of nodes:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A toy graph demonstrating structural equivalence.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The cosine similarity matrix for this graph is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb15-2"><a href="#cb15-2"></a>   A.p <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A </span>
<span id="cb15-3"><a href="#cb15-3"></a>   A.q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> (<span class="dv">1</span> <span class="sc">-</span> A) </span>
<span id="cb15-4"><a href="#cb15-4"></a>   A.r <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">%*%</span> A </span>
<span id="cb15-5"><a href="#cb15-5"></a>   C <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (<span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.q) <span class="sc">*</span> <span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.r))</span>
<span id="cb15-6"><a href="#cb15-6"></a>   <span class="fu">round</span>(C, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     A    B    C    D    E    F    G    H    I
A 1.00 0.26 0.26 0.58 0.58 0.58 0.67 0.00 0.00
B 0.26 1.00 1.00 0.00 0.00 0.00 0.26 0.67 0.67
C 0.26 1.00 1.00 0.00 0.00 0.00 0.26 0.67 0.67
D 0.58 0.00 0.00 1.00 1.00 1.00 0.58 0.25 0.25
E 0.58 0.00 0.00 1.00 1.00 1.00 0.58 0.25 0.25
F 0.58 0.00 0.00 1.00 1.00 1.00 0.58 0.25 0.25
G 0.67 0.26 0.26 0.58 0.58 0.58 1.00 0.00 0.00
H 0.00 0.67 0.67 0.25 0.25 0.25 0.00 1.00 0.75
I 0.00 0.67 0.67 0.25 0.25 0.25 0.00 0.75 1.00</code></pre>
</div>
</div>
<p>Note that structurally equivalent nodes have similarity scores equal to 1.0. In this case, the distance matrix is given by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   D <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And a hierarchical clustering on this matrix reveals the structurally equivalent classes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(D) </span>
<span id="cb18-2"><a href="#cb18-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="handout5_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can package all that we said before into a handy function that takes a graph as input and returns all three normalized similarity metrics as output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   vertex.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-2"><a href="#cb19-2"></a>      A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(x))</span>
<span id="cb19-3"><a href="#cb19-3"></a>      A.p <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A </span>
<span id="cb19-4"><a href="#cb19-4"></a>      A.q <span class="ot">&lt;-</span> A <span class="sc">%*%</span> (<span class="dv">1</span> <span class="sc">-</span> A) </span>
<span id="cb19-5"><a href="#cb19-5"></a>      A.r <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">%*%</span> A </span>
<span id="cb19-6"><a href="#cb19-6"></a>      J <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (A.p <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb19-7"><a href="#cb19-7"></a>      C <span class="ot">&lt;-</span> A.p <span class="sc">/</span> (<span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.q) <span class="sc">*</span> <span class="fu">sqrt</span>(A.p <span class="sc">+</span> A.r))</span>
<span id="cb19-8"><a href="#cb19-8"></a>      D <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> A.p) <span class="sc">+</span> A.q <span class="sc">+</span> A.r)</span>
<span id="cb19-9"><a href="#cb19-9"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">J =</span> J, <span class="at">C =</span> C, <span class="at">D =</span> D))</span>
<span id="cb19-10"><a href="#cb19-10"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the <em>Flintstones</em> network, we could then find structurally equivalent blocks from the similarity analysis as follows (using Cosine):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   g.flint <span class="ot">&lt;-</span> movie_267</span>
<span id="cb20-2"><a href="#cb20-2"></a>   g.flint <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.flint, <span class="fu">degree</span>(g.flint) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> <span class="fu">vertex.sim</span>(g.flint)<span class="sc">$</span>C)</span>
<span id="cb20-4"><a href="#cb20-4"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="handout5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="generalized-similarities" class="level2">
<h2 class="anchored" data-anchor-id="generalized-similarities">Generalized Similarities</h2>
<p>So far, we have defined distances and similarities mainly as a function of the number of shared neighbors between two nodes. Structural equivalence is an idealized version of this, obtaining whenever people share exactly the same set of neighbors.</p>
<p>Yet, similarities based on local neighborhood information only have been criticized (e.g., by <span class="citation" data-cites="borgatti_everett92">Borgatti and Everett (<a href="#ref-borgatti_everett92" role="doc-biblioref">1992</a>)</span>) for not quite capturing the sociological intuition behind the idea of a <em>role</em> which is usually what they are deployed for. That is, two doctors don’t occupy the same role because they treat the <em>same</em> set of patients (in fact, this would be weird); instead, the set of doctors occupy the same role to the extent they treat a set of actors in the same (or similar) role: Namely, patients, regardless of whether those actors are literally the same or not.</p>
<p>This worry led social network analysts to try to generalize the concept of structural equivalence using less stringent algebraic definition, resulting in something of a proliferation of different equivalences such as <strong>automorphic</strong> or <strong>regular equivalence</strong> <span class="citation" data-cites="borgatti_everett92">(<a href="#ref-borgatti_everett92" role="doc-biblioref">Borgatti and Everett 1992</a>)</span>.</p>
<p>Unfortunately, none of this work led (unlike the work on structural equivalence) to useful or actionable tools for data analysis, with some even concluding that some definitions of equivalence (like regular equivalence) are unlikely to be found in any interesting substantive setting.</p>
<p>A better approach here is to use the more relaxed notion of similarity like we did above to come up with a more general definition that can capture our role-based intuitions. Note that all the similarity notions studied earlier have structural equivalence as the limiting case of maximum similarity. So they are still based on the idea that <em>nodes are similar to the extent they connect to the same others</em>.</p>
<p>We can generalize this idea (to deal with the doctor/patient role problem) in the following way: <em>nodes are similar to the extent they connect to similar others</em>, with the restriction that we can only use endogenous (structural connectivity) information—like with structural equivalence or common-neighbor approaches—to define everyone’s similarity (no exogenous attribute stuff).</p>
<p>As <span class="citation" data-cites="jeh_widom02">Jeh and Widom (<a href="#ref-jeh_widom02" role="doc-biblioref">2002</a>)</span> note, this approach does lead to a coherent generalization of the idea of similarity for nodes in graphs because we can just define similarity <em>recursively</em> and iterate through the graph until the similarity scores stop changing.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>More specifically, they propose to measure the similarity between two nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> at each time-step in the iteration using the formula:</p>
<p><span class="math display">\[\begin{equation}
   s_{ij} = \frac{\alpha}{d_i d_j} \sum_{k \in N(i)} \sum_{l \in N(j)} s_{kl}
\end{equation}\]</span></p>
<p>So the similarity between two nodes is just the sum of the pairwise similarities between each of their neighbors (computed in the previous step), weighted by the ratio of a free parameter <span class="math inline">\(\alpha\)</span> (a number between zero and one) to the product of their degrees (to take a weighted average).</p>
<p>This measure nicely captures the idea that nodes are similar to the extent they both connect to people who are themselves similar. Note that it doesn’t matter whether these neighbors are shared between the two nodes (the summation occurs over each pair of nodes in <span class="math inline">\(p\)</span> + <span class="math inline">\(q\)</span> versus <span class="math inline">\(p\)</span> + <span class="math inline">\(r\)</span> as defined earlier) or whether the set of neighbors are themselves neighbors, which deals with the doctor/patient problem.</p>
<p>A function that implements this idea looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>   SimRank.in <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">C =</span> <span class="fl">0.8</span>, <span class="at">iter =</span> <span class="dv">10</span>) {</span>
<span id="cb21-2"><a href="#cb21-2"></a>      d <span class="ot">&lt;-</span> <span class="fu">colSums</span>(A)</span>
<span id="cb21-3"><a href="#cb21-3"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb21-4"><a href="#cb21-4"></a>      S <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n)</span>
<span id="cb21-5"><a href="#cb21-5"></a>      <span class="fu">rownames</span>(S) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb21-6"><a href="#cb21-6"></a>      <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb21-7"><a href="#cb21-7"></a>      m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>      <span class="cf">while</span>(m <span class="sc">&lt;</span> iter) {</span>
<span id="cb21-9"><a href="#cb21-9"></a>          <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb21-10"><a href="#cb21-10"></a>               <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb21-11"><a href="#cb21-11"></a>                    <span class="cf">if</span> (i <span class="sc">&lt;</span> j) {</span>
<span id="cb21-12"><a href="#cb21-12"></a>                        a <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[, i] <span class="sc">==</span> <span class="dv">1</span>)) </span>
<span id="cb21-13"><a href="#cb21-13"></a>                        b <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[, j] <span class="sc">==</span> <span class="dv">1</span>)) </span>
<span id="cb21-14"><a href="#cb21-14"></a>                        Sij <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>                        <span class="cf">for</span> (k <span class="cf">in</span> a) {</span>
<span id="cb21-16"><a href="#cb21-16"></a>                           <span class="cf">for</span> (l <span class="cf">in</span> b) {</span>
<span id="cb21-17"><a href="#cb21-17"></a>                              Sij <span class="ot">&lt;-</span> Sij <span class="sc">+</span> S[k, l] <span class="co">#i's similarity to j</span></span>
<span id="cb21-18"><a href="#cb21-18"></a>                           }</span>
<span id="cb21-19"><a href="#cb21-19"></a>                        }</span>
<span id="cb21-20"><a href="#cb21-20"></a>                        S[i, j] <span class="ot">&lt;-</span> C<span class="sc">/</span>(d[i] <span class="sc">*</span> d[j]) <span class="sc">*</span> Sij</span>
<span id="cb21-21"><a href="#cb21-21"></a>                        S[j, i] <span class="ot">&lt;-</span> C<span class="sc">/</span>(d[i] <span class="sc">*</span> d[j]) <span class="sc">*</span> Sij</span>
<span id="cb21-22"><a href="#cb21-22"></a>                    }</span>
<span id="cb21-23"><a href="#cb21-23"></a>               }</span>
<span id="cb21-24"><a href="#cb21-24"></a>          }</span>
<span id="cb21-25"><a href="#cb21-25"></a>         m <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb21-26"><a href="#cb21-26"></a>      }</span>
<span id="cb21-27"><a href="#cb21-27"></a>   <span class="fu">return</span>(S)</span>
<span id="cb21-28"><a href="#cb21-28"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that this function calculates <code>SimRank</code> using each node’s in-neighbors (it doesn’t matter if the graph is undirected).</p>
<p>Let’s try it out in the <em>Flintstones</em> graph using <span class="math inline">\(\alpha = 0.95\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g.flint))</span>
<span id="cb22-2"><a href="#cb22-2"></a>   S <span class="ot">&lt;-</span> <span class="fu">SimRank.in</span>(A, <span class="fl">0.95</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>   <span class="fu">round</span>(S[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                BAM-BAM BARNEY BETTY FELDSPAR FRED
BAM-BAM            1.00   0.46  0.47     0.52 0.47
BARNEY             0.46   1.00  0.47     0.45 0.48
BETTY              0.47   0.47  1.00     0.48 0.47
FELDSPAR           0.52   0.45  0.48     1.00 0.46
FRED               0.47   0.48  0.47     0.46 1.00
HEADMISTRESS       0.47   0.48  0.46     0.44 0.48
HERDMASTER         0.48   0.47  0.48     0.57 0.48
LAVA               0.48   0.47  0.47     0.49 0.48
LEACH              0.49   0.48  0.48     0.53 0.47
MORRIS             0.49   0.48  0.47     0.44 0.47
MRS SLATE          0.47   0.46  0.47     0.48 0.47
PEBBLES            0.51   0.47  0.48     0.53 0.48
PEBBLES BAM-BAM    0.49   0.48  0.48     0.48 0.48
PILTDOWN           0.47   0.48  0.47     0.52 0.48
POINDEXTER         0.47   0.47  0.48     0.51 0.47
PYRITE             0.47   0.48  0.47     0.52 0.48
SLATE              0.47   0.47  0.48     0.50 0.48
WILMA              0.47   0.47  0.48     0.48 0.47</code></pre>
</div>
</div>
<p>We can transform the generalized similarities to distances and plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb24-2"><a href="#cb24-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="handout5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which returns an intuitive role partition.</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-borgatti_everett92" class="csl-entry" role="doc-biblioentry">
Borgatti, Stephen P, and Martin G Everett. 1992. <span>“Notions of Position in Social Network Analysis.”</span> <em>Sociological Methodology</em> 22: 1–35.
</div>
<div id="ref-jeh_widom02" class="csl-entry" role="doc-biblioentry">
Jeh, Glen, and Jennifer Widom. 2002. <span>“Simrank: A Measure of Structural-Context Similarity.”</span> In <em>Proceedings of the Eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 538–43.
</div>
<div id="ref-kleinberg99" class="csl-entry" role="doc-biblioentry">
Kleinberg, Jon M. 1999. <span>“Authoritative Sources in a Hyperlinked Environment.”</span> <em>Journal of the ACM (JACM)</em> 46 (5): 604–32.
</div>
<div id="ref-leicht_etal06" class="csl-entry" role="doc-biblioentry">
Leicht, Elizabeth A, Petter Holme, and Mark EJ Newman. 2006. <span>“Vertex Similarity in Networks.”</span> <em>Physical Review E—Statistical, Nonlinear, and Soft Matter Physics</em> 73 (2): 026120.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Note the similarity (heh, heh) between this idea and the various status ranking algorithms we discussed in the previous handout.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>