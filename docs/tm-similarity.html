<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Similarity and Equivalence in Two-Mode Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Similarity and Equivalence in Two-Mode Networks">
<meta property="og:description" content="Note that the one-mode projections can be considered unnormalized similarity matrices just like in the case of regular networks.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Similarity and Equivalence in Two-Mode Networks</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">Matrix Eigendecomposition</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Centrality and Prestige</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centrality.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Centrality Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-centrality.html" class="sidebar-item-text sidebar-link">Centrality in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pagerank.html" class="sidebar-item-text sidebar-link">PageRank Prestige Scoring</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hits.html" class="sidebar-item-text sidebar-link">Hubs and Authorities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Equivalence and Similarity</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-walk.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-similarity.html" class="sidebar-item-text sidebar-link active">Similarity and Equivalence in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Communities and Clustering</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-community-ca.html" class="sidebar-item-text sidebar-link">Community Detection in Two-Mode Networks Using CA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-spectral.html" class="sidebar-item-text sidebar-link">Spectral Clustering of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Two-Mode Networks</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-basic.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-duality.html" class="sidebar-item-text sidebar-link">The Duality of Persons and Groups</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-reflections.html" class="sidebar-item-text sidebar-link">The Method of Reflections in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-fitness.html" class="sidebar-item-text sidebar-link">Fitness and Complexity in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-null.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link">Extracting the Backbone of Bipartite Projections Using Two-Mode Graph Ensembles</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Data Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loading.html" class="sidebar-item-text sidebar-link">Loading Network Data from a File</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-lists.html" class="sidebar-item-text sidebar-link">Handling Graph Objects in Lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subgraph-select.html" class="sidebar-item-text sidebar-link">Selecting a Subgraph Based on Edge Conditions</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#normalized-vertex-similarity-metrics" id="toc-normalized-vertex-similarity-metrics" class="nav-link active" data-scroll-target="#normalized-vertex-similarity-metrics">Normalized Vertex Similarity Metrics</a></li>
  <li><a href="#structural-equivalence" id="toc-structural-equivalence" class="nav-link" data-scroll-target="#structural-equivalence">Structural Equivalence</a></li>
  <li><a href="#generalized-vertex-similarity" id="toc-generalized-vertex-similarity" class="nav-link" data-scroll-target="#generalized-vertex-similarity">Generalized Vertex Similarity</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/tm-similarity.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Similarity and Equivalence in Two-Mode Networks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="normalized-vertex-similarity-metrics" class="level2">
<h2 class="anchored" data-anchor-id="normalized-vertex-similarity-metrics">Normalized Vertex Similarity Metrics</h2>
<p>Note that the <a href="./tm-duality.html">one-mode projections</a> can be considered unnormalized similarity matrices <a href="./similarity.html">just like in the case of regular networks</a>. That means that if we have the degrees of nodes in each mode, we can transform this matrix into any of the <strong>normalized vertex similarity</strong> metrics we discussed before, including Jaccard, Cosine, Dice, LHN, and so on.</p>
<p>Let’s see how this would work in our trusty <em>Southern Women</em> dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   g <span class="ot">&lt;-</span> southern_women</span>
<span id="cb1-4"><a href="#cb1-4"></a>   A <span class="ot">&lt;-</span> <span class="fu">as_biadjacency_matrix</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Repackaging our vertex similarity function for the two-mode case, we have:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   vertex.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-2"><a href="#cb2-2"></a>      A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_biadjacency_matrix</span>(x))</span>
<span id="cb2-3"><a href="#cb2-3"></a>      M <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A) <span class="co">#number of persons</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>      N <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A) <span class="co">#number of groups</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>      p.d <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(A) <span class="co">#person degrees</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>      g.d <span class="ot">&lt;-</span> <span class="fu">colSums</span>(A) <span class="co">#group degrees</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>      P <span class="ot">&lt;-</span> A <span class="sc">%*%</span> <span class="fu">t</span>(A) <span class="co">#person projection</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>      G <span class="ot">&lt;-</span> <span class="fu">t</span>(A) <span class="sc">%*%</span> A <span class="co">#group projection</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>      J.p <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, M, M)</span>
<span id="cb2-10"><a href="#cb2-10"></a>      J.g <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N, N)</span>
<span id="cb2-11"><a href="#cb2-11"></a>      C.p <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, M, M)</span>
<span id="cb2-12"><a href="#cb2-12"></a>      C.g <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N, N)</span>
<span id="cb2-13"><a href="#cb2-13"></a>      D.p <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, M, M)</span>
<span id="cb2-14"><a href="#cb2-14"></a>      D.g <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N, N)</span>
<span id="cb2-15"><a href="#cb2-15"></a>      L.p <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, M, M)</span>
<span id="cb2-16"><a href="#cb2-16"></a>      L.g <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N, N)</span>
<span id="cb2-17"><a href="#cb2-17"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb2-18"><a href="#cb2-18"></a>         <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb2-19"><a href="#cb2-19"></a>            <span class="cf">if</span> (i <span class="sc">&lt;</span> j) {</span>
<span id="cb2-20"><a href="#cb2-20"></a>               J.p[i,j] <span class="ot">&lt;-</span> P[i,j]<span class="sc">/</span>(P[i,j] <span class="sc">+</span> p.d[i] <span class="sc">+</span> p.d[j])</span>
<span id="cb2-21"><a href="#cb2-21"></a>               J.p[j,i] <span class="ot">&lt;-</span> P[i,j]<span class="sc">/</span>(P[i,j] <span class="sc">+</span> p.d[i] <span class="sc">+</span> p.d[j])</span>
<span id="cb2-22"><a href="#cb2-22"></a>               C.p[i,j] <span class="ot">&lt;-</span> P[i,j]<span class="sc">/</span>(<span class="fu">sqrt</span>(p.d[i] <span class="sc">*</span> p.d[j]))</span>
<span id="cb2-23"><a href="#cb2-23"></a>               C.p[j,i] <span class="ot">&lt;-</span> P[i,j]<span class="sc">/</span>(<span class="fu">sqrt</span>(p.d[i] <span class="sc">*</span> p.d[j]))</span>
<span id="cb2-24"><a href="#cb2-24"></a>               D.p[i,j] <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>P[i,j])<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>P[i,j] <span class="sc">+</span> p.d[i] <span class="sc">+</span> p.d[j])</span>
<span id="cb2-25"><a href="#cb2-25"></a>               D.p[j,i] <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>P[i,j])<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>P[i,j] <span class="sc">+</span> p.d[i] <span class="sc">+</span> p.d[j])</span>
<span id="cb2-26"><a href="#cb2-26"></a>               L.p[i,j] <span class="ot">&lt;-</span> P[i,j]<span class="sc">/</span>(p.d[i] <span class="sc">*</span> p.d[j])</span>
<span id="cb2-27"><a href="#cb2-27"></a>               L.p[j,i] <span class="ot">&lt;-</span> P[i,j]<span class="sc">/</span>(p.d[i] <span class="sc">*</span> p.d[j])</span>
<span id="cb2-28"><a href="#cb2-28"></a>               }</span>
<span id="cb2-29"><a href="#cb2-29"></a>            }</span>
<span id="cb2-30"><a href="#cb2-30"></a>         }</span>
<span id="cb2-31"><a href="#cb2-31"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb2-32"><a href="#cb2-32"></a>         <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb2-33"><a href="#cb2-33"></a>            <span class="cf">if</span> (i <span class="sc">&lt;</span> j) {</span>
<span id="cb2-34"><a href="#cb2-34"></a>               J.g[i,j] <span class="ot">&lt;-</span> G[i,j]<span class="sc">/</span>(G[i,j] <span class="sc">+</span> g.d[i] <span class="sc">+</span> g.d[j])</span>
<span id="cb2-35"><a href="#cb2-35"></a>               J.g[j,i] <span class="ot">&lt;-</span> G[i,j]<span class="sc">/</span>(G[i,j] <span class="sc">+</span> g.d[i] <span class="sc">+</span> g.d[j])</span>
<span id="cb2-36"><a href="#cb2-36"></a>               C.g[i,j] <span class="ot">&lt;-</span> G[i,j]<span class="sc">/</span>(<span class="fu">sqrt</span>(g.d[i] <span class="sc">*</span> g.d[j]))</span>
<span id="cb2-37"><a href="#cb2-37"></a>               C.g[j,i] <span class="ot">&lt;-</span> G[i,j]<span class="sc">/</span>(<span class="fu">sqrt</span>(g.d[i] <span class="sc">*</span> g.d[j]))</span>
<span id="cb2-38"><a href="#cb2-38"></a>               D.g[i,j] <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>G[i,j])<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>G[i,j] <span class="sc">+</span> g.d[i] <span class="sc">+</span> g.d[j])</span>
<span id="cb2-39"><a href="#cb2-39"></a>               D.g[j,i] <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>G[i,j])<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>G[i,j] <span class="sc">+</span> g.d[i] <span class="sc">+</span> g.d[j])</span>
<span id="cb2-40"><a href="#cb2-40"></a>               L.g[i,j] <span class="ot">&lt;-</span> G[i,j]<span class="sc">/</span>(g.d[i] <span class="sc">*</span> g.d[j])</span>
<span id="cb2-41"><a href="#cb2-41"></a>               L.g[j,i] <span class="ot">&lt;-</span> G[i,j]<span class="sc">/</span>(g.d[i] <span class="sc">*</span> g.d[j])</span>
<span id="cb2-42"><a href="#cb2-42"></a>               }</span>
<span id="cb2-43"><a href="#cb2-43"></a>            }</span>
<span id="cb2-44"><a href="#cb2-44"></a>         }</span>
<span id="cb2-45"><a href="#cb2-45"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">J.p =</span> J.p, <span class="at">C.p =</span> C.p, <span class="at">D.p =</span> D.p, <span class="at">L.p =</span> L.p,</span>
<span id="cb2-46"><a href="#cb2-46"></a>                  <span class="at">J.g =</span> J.g, <span class="at">C.g =</span> C.g, <span class="at">D.g =</span> D.g, <span class="at">L.g =</span> L.g))</span>
<span id="cb2-47"><a href="#cb2-47"></a>      }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using this function to compute the Jaccard similarity between people yields:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>   J.p <span class="ot">&lt;-</span> <span class="fu">vertex.sim</span>(g)<span class="sc">$</span>J.p</span>
<span id="cb3-2"><a href="#cb3-2"></a>   <span class="fu">rownames</span>(J.p) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb3-3"><a href="#cb3-3"></a>   <span class="fu">colnames</span>(J.p) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb3-4"><a href="#cb3-4"></a>   <span class="fu">round</span>(J.p, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL RUTH
EVELYN      1.00  0.29    0.30   0.29      0.20    0.25    0.20  0.21 0.20
LAURA       0.29  1.00    0.29   0.30      0.21    0.27    0.27  0.17 0.21
THERESA     0.30  0.29    1.00   0.29      0.25    0.25    0.25  0.21 0.25
BRENDA      0.29  0.30    0.29   1.00      0.27    0.27    0.27  0.17 0.21
CHARLOTTE   0.20  0.21    0.25   0.27      1.00    0.20    0.20  0.00 0.20
FRANCES     0.25  0.27    0.25   0.27      0.20    1.00    0.27  0.22 0.20
ELEANOR     0.20  0.27    0.25   0.27      0.20    0.27    1.00  0.22 0.27
PEARL       0.21  0.17    0.21   0.17      0.00    0.22    0.22  1.00 0.22
RUTH        0.20  0.21    0.25   0.21      0.20    0.20    0.27  0.22 1.00
VERNE       0.14  0.15    0.20   0.15      0.11    0.11    0.20  0.22 0.27
MYRNA       0.14  0.08    0.14   0.08      0.00    0.11    0.11  0.22 0.20
KATHERINE   0.12  0.07    0.12   0.07      0.00    0.09    0.09  0.18 0.17
SYLVIA      0.12  0.12    0.17   0.12      0.08    0.08    0.15  0.17 0.21
NORA        0.11  0.12    0.16   0.12      0.08    0.08    0.14  0.15 0.14
HELEN       0.07  0.14    0.13   0.14      0.10    0.10    0.18  0.11 0.18
DOROTHY     0.17  0.10    0.17   0.10      0.00    0.14    0.14  0.29 0.25
OLIVIA      0.09  0.00    0.09   0.00      0.00    0.00    0.00  0.17 0.14
FLORA       0.09  0.00    0.09   0.00      0.00    0.00    0.00  0.17 0.14
          VERNE MYRNA KATHERINE SYLVIA NORA HELEN DOROTHY OLIVIA FLORA
EVELYN     0.14  0.14      0.12   0.12 0.11  0.07    0.17   0.09  0.09
LAURA      0.15  0.08      0.07   0.12 0.12  0.14    0.10   0.00  0.00
THERESA    0.20  0.14      0.12   0.17 0.16  0.13    0.17   0.09  0.09
BRENDA     0.15  0.08      0.07   0.12 0.12  0.14    0.10   0.00  0.00
CHARLOTTE  0.11  0.00      0.00   0.08 0.08  0.10    0.00   0.00  0.00
FRANCES    0.11  0.11      0.09   0.08 0.08  0.10    0.14   0.00  0.00
ELEANOR    0.20  0.11      0.09   0.15 0.14  0.18    0.14   0.00  0.00
PEARL      0.22  0.22      0.18   0.17 0.15  0.11    0.29   0.17  0.17
RUTH       0.27  0.20      0.17   0.21 0.14  0.18    0.25   0.14  0.14
VERNE      1.00  0.27      0.23   0.27 0.20  0.25    0.25   0.14  0.14
MYRNA      0.27  1.00      0.29   0.27 0.20  0.25    0.25   0.14  0.14
KATHERINE  0.23  0.29      1.00   0.32 0.26  0.21    0.20   0.11  0.11
SYLVIA     0.27  0.27      0.32   1.00 0.29  0.25    0.18   0.10  0.10
NORA       0.20  0.20      0.26   0.29 1.00  0.24    0.09   0.17  0.17
HELEN      0.25  0.25      0.21   0.25 0.24  1.00    0.12   0.12  0.12
DOROTHY    0.25  0.25      0.20   0.18 0.09  0.12    1.00   0.20  0.20
OLIVIA     0.14  0.14      0.11   0.10 0.17  0.12    0.20   1.00  0.33
FLORA      0.14  0.14      0.11   0.10 0.17  0.12    0.20   0.33  1.00</code></pre>
</div>
</div>
</section>
<section id="structural-equivalence" class="level2">
<h2 class="anchored" data-anchor-id="structural-equivalence">Structural Equivalence</h2>
<p>And, of course, once we have a similarity we can cluster nodes based on approximate structural equivalence by transforming proximities to distances:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span><span class="sc">-</span> J.p)</span>
<span id="cb5-2"><a href="#cb5-2"></a>   hc.p <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>   <span class="fu">plot</span>(hc.p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-similarity_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And for events:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   J.g <span class="ot">&lt;-</span> <span class="fu">vertex.sim</span>(g)<span class="sc">$</span>J.g</span>
<span id="cb6-2"><a href="#cb6-2"></a>   <span class="fu">rownames</span>(J.g) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb6-3"><a href="#cb6-3"></a>   <span class="fu">colnames</span>(J.g) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb6-4"><a href="#cb6-4"></a>   D <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span><span class="sc">-</span> J.g)</span>
<span id="cb6-5"><a href="#cb6-5"></a>   hc.g <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a>   <span class="fu">plot</span>(hc.g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-similarity_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can then derive cluster memberships for people and groups from the <code>hclust</code> object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>   <span class="fu">library</span>(dendextend)</span>
<span id="cb7-2"><a href="#cb7-2"></a>   clus.p <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">cutree</span>(hc.p, <span class="dv">4</span>)) <span class="co">#selecting four clusters for people</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>   clus.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        1         1         1         1         1         1         1         2 
     RUTH     VERNE   DOROTHY     MYRNA KATHERINE    SYLVIA      NORA     HELEN 
        2         2         2         3         3         3         3         3 
   OLIVIA     FLORA 
        4         4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>   clus.g <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">cutree</span>(hc.g, <span class="dv">3</span>)) <span class="co">#selecting three clusters for groups</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>   clus.g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10  2/23   4/7 11/21 
    1     1     1     1     1     1     2     2     2     3     3     3     3 
  8/3 
    3 </code></pre>
</div>
</div>
<p>And finally we can block the original affiliation matrix, as recommended by <span class="citation" data-cites="everett_borgatti13">Everett and Borgatti (<a href="#ref-everett_borgatti13" role="doc-biblioref">2013, 210</a>, table 5)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>   <span class="fu">library</span>(ggcorrplot)</span>
<span id="cb11-2"><a href="#cb11-2"></a>   p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(<span class="fu">t</span>(A[<span class="fu">names</span>(clus.p), <span class="fu">names</span>(clus.g)]), </span>
<span id="cb11-3"><a href="#cb11-3"></a>                   <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>)) </span>
<span id="cb11-4"><a href="#cb11-4"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb11-5"><a href="#cb11-5"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb11-6"><a href="#cb11-6"></a>                  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb11-7"><a href="#cb11-7"></a>                  )</span>
<span id="cb11-8"><a href="#cb11-8"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>) </span>
<span id="cb11-9"><a href="#cb11-9"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">7.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">11.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">16.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">6.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">9.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a>   p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-similarity_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which reveals a number of almost complete (one-blocks) and almost null (zero-blocks) in the social structure, with a reduced image matrix that looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>   <span class="fu">library</span>(kableExtra)</span>
<span id="cb12-2"><a href="#cb12-2"></a>   IM <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>   IM[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>   IM[<span class="dv">2</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>   IM[<span class="dv">3</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>   IM[<span class="dv">4</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>   <span class="fu">rownames</span>(IM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P.Block1"</span>, <span class="st">"P.Block2"</span>, <span class="st">"P.Block3"</span>, <span class="st">"P.Block4"</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a>   <span class="fu">colnames</span>(IM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"E.Block1"</span>, <span class="st">"E.Block2"</span>, <span class="st">"E.Block3"</span>)</span>
<span id="cb12-9"><a href="#cb12-9"></a>   <span class="fu">kbl</span>(IM, <span class="at">format =</span> <span class="st">"html"</span>, , <span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10"></a>      <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-11"><a href="#cb12-11"></a>      <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>                     <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> E.Block1 </th>
   <th style="text-align:center;"> E.Block2 </th>
   <th style="text-align:center;"> E.Block3 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> P.Block1 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> P.Block2 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> P.Block3 </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> P.Block4 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="generalized-vertex-similarity" class="level2">
<h2 class="anchored" data-anchor-id="generalized-vertex-similarity">Generalized Vertex Similarity</h2>
<p>Recall that vertex similarity works using the principle of <em>structural equivalence</em>: Two people are similar if the choose the <em>same</em> objects (groups), and two objects (groups) are similar if they are chosen by the <em>same</em> people.</p>
<p>We can, like we did in the one mode case, be after a more general version of similarity, which says that: Two people are similar if they choose <em>similar</em> (not necessarily the same) objects, and two objects are similar if they are chosen by <em>similar</em> (not necessarily the same) people.</p>
<p>This leads to the same problem setup that inspired the <strong>SimRank</strong> approach <span class="citation" data-cites="jeh_widom02">(<a href="#ref-jeh_widom02" role="doc-biblioref">Jeh and Widom 2002</a>)</span>.</p>
<p>A (longish) function to compute the SimRank similarity between nodes in a two mode network goes as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   TM.SimRank <span class="ot">&lt;-</span> <span class="cf">function</span>(A, <span class="at">C =</span> <span class="fl">0.8</span>, <span class="at">iter =</span> <span class="dv">10</span>) {</span>
<span id="cb13-2"><a href="#cb13-2"></a>        nr <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb13-3"><a href="#cb13-3"></a>        nc <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb13-4"><a href="#cb13-4"></a>        dr <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(A)</span>
<span id="cb13-5"><a href="#cb13-5"></a>        dc <span class="ot">&lt;-</span> <span class="fu">colSums</span>(A)</span>
<span id="cb13-6"><a href="#cb13-6"></a>        Sr <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, nr, nr) <span class="co">#baseline similarity: every node maximally similar to themselves</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>        Sc <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, nc, nc) <span class="co">#baseline similarity: every node maximally similar to themselves</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>        rn <span class="ot">&lt;-</span> <span class="fu">rownames</span>(A)</span>
<span id="cb13-9"><a href="#cb13-9"></a>        cn <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb13-10"><a href="#cb13-10"></a>        <span class="fu">rownames</span>(Sr) <span class="ot">&lt;-</span> rn</span>
<span id="cb13-11"><a href="#cb13-11"></a>        <span class="fu">colnames</span>(Sr) <span class="ot">&lt;-</span> rn</span>
<span id="cb13-12"><a href="#cb13-12"></a>        <span class="fu">rownames</span>(Sc) <span class="ot">&lt;-</span> cn</span>
<span id="cb13-13"><a href="#cb13-13"></a>        <span class="fu">colnames</span>(Sc) <span class="ot">&lt;-</span> cn</span>
<span id="cb13-14"><a href="#cb13-14"></a>        m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>        <span class="cf">while</span>(m <span class="sc">&lt;</span> iter) {</span>
<span id="cb13-16"><a href="#cb13-16"></a>             Sr.pre <span class="ot">&lt;-</span> Sr</span>
<span id="cb13-17"><a href="#cb13-17"></a>             Sc.pre <span class="ot">&lt;-</span> Sc</span>
<span id="cb13-18"><a href="#cb13-18"></a>             <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nr) {</span>
<span id="cb13-19"><a href="#cb13-19"></a>                  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nr) {</span>
<span id="cb13-20"><a href="#cb13-20"></a>                       <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb13-21"><a href="#cb13-21"></a>                            a <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[i, ] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#objects chosen by i</span></span>
<span id="cb13-22"><a href="#cb13-22"></a>                            b <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[j, ] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#objects chosen by j</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>                            Scij <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>                            <span class="cf">for</span> (k <span class="cf">in</span> a) {</span>
<span id="cb13-25"><a href="#cb13-25"></a>                                 <span class="cf">for</span> (l <span class="cf">in</span> b) {</span>
<span id="cb13-26"><a href="#cb13-26"></a>                                      Scij <span class="ot">&lt;-</span> Scij <span class="sc">+</span> Sc[k, l] <span class="co">#i's similarity to j</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>                                 }</span>
<span id="cb13-28"><a href="#cb13-28"></a>                            }</span>
<span id="cb13-29"><a href="#cb13-29"></a>                            Sr[i, j] <span class="ot">&lt;-</span> C<span class="sc">/</span>(dr[i] <span class="sc">*</span> dr[j]) <span class="sc">*</span> Scij</span>
<span id="cb13-30"><a href="#cb13-30"></a>                       }</span>
<span id="cb13-31"><a href="#cb13-31"></a>                  }</span>
<span id="cb13-32"><a href="#cb13-32"></a>             }</span>
<span id="cb13-33"><a href="#cb13-33"></a>             <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc) {</span>
<span id="cb13-34"><a href="#cb13-34"></a>                  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc) {</span>
<span id="cb13-35"><a href="#cb13-35"></a>                       <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb13-36"><a href="#cb13-36"></a>                            a <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[, i] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#people who chose object i</span></span>
<span id="cb13-37"><a href="#cb13-37"></a>                            b <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(A[, j] <span class="sc">==</span> <span class="dv">1</span>)) <span class="co">#people who chose object j</span></span>
<span id="cb13-38"><a href="#cb13-38"></a>                            Srij <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-39"><a href="#cb13-39"></a>                            <span class="cf">for</span> (k <span class="cf">in</span> a) {</span>
<span id="cb13-40"><a href="#cb13-40"></a>                                 <span class="cf">for</span> (l <span class="cf">in</span> b) {</span>
<span id="cb13-41"><a href="#cb13-41"></a>                                      Srij <span class="ot">&lt;-</span> Srij <span class="sc">+</span> Sr[k, l] <span class="co">#i's similarity to j</span></span>
<span id="cb13-42"><a href="#cb13-42"></a>                                 }</span>
<span id="cb13-43"><a href="#cb13-43"></a>                            }</span>
<span id="cb13-44"><a href="#cb13-44"></a>                            Sc[i, j] <span class="ot">&lt;-</span> C<span class="sc">/</span>(dc[i] <span class="sc">*</span> dc[j]) <span class="sc">*</span> Srij</span>
<span id="cb13-45"><a href="#cb13-45"></a>                       }</span>
<span id="cb13-46"><a href="#cb13-46"></a>                  }</span>
<span id="cb13-47"><a href="#cb13-47"></a>             }</span>
<span id="cb13-48"><a href="#cb13-48"></a>             m <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-49"><a href="#cb13-49"></a>        }</span>
<span id="cb13-50"><a href="#cb13-50"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Sr =</span> Sr, <span class="at">Sc =</span> Sc))</span>
<span id="cb13-51"><a href="#cb13-51"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function takes the biadjacency matrix <span class="math inline">\(\mathbf{A}\)</span> as input and returns two generalized relational similarity matrices: One for the people (row objects) and the other one for the groups (column objects).</p>
<p>Here’s how that would work in the SW data. First we compute the SimRank scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   sim.res <span class="ot">&lt;-</span> <span class="fu">TM.SimRank</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we peek inside the people similarity matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   <span class="fu">round</span>(sim.res<span class="sc">$</span>Sr[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          EVELYN LAURA THERESA BRENDA CHARLOTTE FRANCES ELEANOR PEARL  RUTH
EVELYN     1.000 0.267   0.262  0.266     0.259   0.275   0.248 0.255 0.237
LAURA      0.267 1.000   0.262  0.277     0.270   0.287   0.280 0.237 0.247
THERESA    0.262 0.262   1.000  0.262     0.273   0.270   0.264 0.254 0.256
BRENDA     0.266 0.277   0.262  1.000     0.290   0.287   0.279 0.235 0.246
CHARLOTTE  0.259 0.270   0.273  0.290     1.000   0.276   0.269 0.175 0.256
FRANCES    0.275 0.287   0.270  0.287     0.276   1.000   0.305 0.280 0.256
ELEANOR    0.248 0.280   0.264  0.279     0.269   0.305   1.000 0.279 0.294
PEARL      0.255 0.237   0.254  0.235     0.175   0.280   0.279 1.000 0.279
RUTH       0.237 0.247   0.256  0.246     0.256   0.256   0.294 0.279 1.000
VERNE      0.201 0.207   0.222  0.206     0.198   0.202   0.246 0.276 0.288
          VERNE
EVELYN    0.201
LAURA     0.207
THERESA   0.222
BRENDA    0.206
CHARLOTTE 0.198
FRANCES   0.202
ELEANOR   0.246
PEARL     0.276
RUTH      0.288
VERNE     1.000</code></pre>
</div>
</div>
<p>And the group similarity matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   <span class="fu">round</span>(sim.res<span class="sc">$</span>Sc[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  6/10
6/27 1.000 0.343 0.314 0.312 0.287 0.277 0.224 0.226 0.178 0.137
3/2  0.343 1.000 0.312 0.311 0.285 0.276 0.224 0.228 0.200 0.141
4/12 0.314 0.312 1.000 0.314 0.288 0.265 0.226 0.220 0.179 0.138
9/26 0.312 0.311 0.314 1.000 0.287 0.256 0.230 0.214 0.186 0.137
2/25 0.287 0.285 0.288 0.287 1.000 0.260 0.235 0.226 0.187 0.146
5/19 0.277 0.276 0.265 0.256 0.260 1.000 0.224 0.226 0.200 0.171
3/15 0.224 0.224 0.226 0.230 0.235 0.224 1.000 0.221 0.204 0.209
9/16 0.226 0.228 0.220 0.214 0.226 0.226 0.221 1.000 0.221 0.214
4/8  0.178 0.200 0.179 0.186 0.187 0.200 0.204 0.221 1.000 0.234
6/10 0.137 0.141 0.138 0.137 0.146 0.171 0.209 0.214 0.234 1.000</code></pre>
</div>
</div>
<p>Like before we can use these results to define two sets of distances:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   D.p <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> sim.res<span class="sc">$</span>Sr)</span>
<span id="cb19-2"><a href="#cb19-2"></a>   D.g <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> sim.res<span class="sc">$</span>Sc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Subject to hierarchical clustering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   hc.p <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D.p, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>   hc.g <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D.g, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>   <span class="fu">plot</span>(hc.p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-similarity_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   <span class="fu">plot</span>(hc.g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-similarity_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Get cluster memberships for people and groups from the <code>hclust</code> object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>   clus.p <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">cutree</span>(hc.p, <span class="dv">4</span>)) <span class="co">#selecting four clusters for people</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>   clus.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   EVELYN     LAURA   THERESA    BRENDA CHARLOTTE   FRANCES   ELEANOR     PEARL 
        1         1         1         1         1         1         1         2 
     RUTH     VERNE   DOROTHY     MYRNA KATHERINE    SYLVIA      NORA     HELEN 
        2         2         2         3         3         3         3         3 
   OLIVIA     FLORA 
        4         4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>   clus.g <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">cutree</span>(hc.g, <span class="dv">3</span>)) <span class="co">#selecting three clusters for groups</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>   clus.g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/27   3/2  4/12  9/26  2/25  5/19  3/15  9/16   4/8  2/23  6/10   4/7 11/21 
    1     1     1     1     1     1     2     2     2     2     3     3     3 
  8/3 
    3 </code></pre>
</div>
</div>
<p>And block the biadjacency matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>   p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(<span class="fu">t</span>(A[<span class="fu">names</span>(clus.p), <span class="fu">names</span>(clus.g)]), </span>
<span id="cb27-2"><a href="#cb27-2"></a>                   <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>)) </span>
<span id="cb27-3"><a href="#cb27-3"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb27-4"><a href="#cb27-4"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb27-5"><a href="#cb27-5"></a>                  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb27-6"><a href="#cb27-6"></a>                  )</span>
<span id="cb27-7"><a href="#cb27-7"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>) </span>
<span id="cb27-8"><a href="#cb27-8"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">7.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb27-9"><a href="#cb27-9"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">11.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb27-10"><a href="#cb27-10"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">16.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb27-11"><a href="#cb27-11"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">6.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb27-12"><a href="#cb27-12"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">10.5</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb27-13"><a href="#cb27-13"></a>   p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm-similarity_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that this block solution is similar (pun intended) but not <em>exactly</em> the same as the one based on structural equivalence we obtained earlier, although it would lead to the same reduced image matrix for the blocks.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-everett_borgatti13" class="csl-entry" role="doc-biblioentry">
Everett, Martin G, and Stephen P Borgatti. 2013. <span>“The Dual-Projection Approach for Two-Mode Networks.”</span> <em>Social Networks</em> 35 (2): 204–10.
</div>
<div id="ref-jeh_widom02" class="csl-entry" role="doc-biblioentry">
Jeh, Glen, and Jennifer Widom. 2002. <span>“Simrank: A Measure of Structural-Context Similarity.”</span> In <em>Proceedings of the Eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 538–43.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>