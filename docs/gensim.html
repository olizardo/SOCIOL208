<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Generalized Vertex Similarities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Generalized Vertex Similarities">
<meta property="og:description" content="So far, we have defined distances and similarities mainly as a function of the number of shared neighbors between two nodes.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Generalized Vertex Similarities</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Basic Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-dir.html" class="sidebar-item-text sidebar-link">Basic Network Statistics for Directed Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ego.html" class="sidebar-item-text sidebar-link">Analyzing Ego Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">Matrix Eigendecomposition</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random.html" class="sidebar-item-text sidebar-link">Random Walk Concepts in Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Centrality</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./degcent.html" class="sidebar-item-text sidebar-link">Degree Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./closcent.html" class="sidebar-item-text sidebar-link">Closeness Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./betcent.html" class="sidebar-item-text sidebar-link">Betwenness Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Centrality Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-cent.html" class="sidebar-item-text sidebar-link">Random Walk Centralities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./edgecent.html" class="sidebar-item-text sidebar-link">Edge Centralities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-centrality.html" class="sidebar-item-text sidebar-link">Centrality in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Status and Prestige</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pagerank.html" class="sidebar-item-text sidebar-link">PageRank Prestige Scoring</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hits.html" class="sidebar-item-text sidebar-link">Hubs and Authorities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestige-ml.html" class="sidebar-item-text sidebar-link">Prestige in Multilayer Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-prestige.html" class="sidebar-item-text sidebar-link">Status and Prestige in Two Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Equivalence and Similarity</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structequiv.html" class="sidebar-item-text sidebar-link">Structural Equivalence</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./locsim.html" class="sidebar-item-text sidebar-link">Local Vertex Similarities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./globsim.html" class="sidebar-item-text sidebar-link">Global Vertex Similarities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gensim.html" class="sidebar-item-text sidebar-link active">Generalized Vertex Similarities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dualsim.html" class="sidebar-item-text sidebar-link">Similarity and Equivalence in Two-Mode Networks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Communities and Clustering</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./community.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-community-ca.html" class="sidebar-item-text sidebar-link">Community Detection in Two-Mode Networks Using CA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-spectral.html" class="sidebar-item-text sidebar-link">Spectral Clustering of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Two-Mode Networks</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-basic.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-duality.html" class="sidebar-item-text sidebar-link">The Duality of Persons and Groups</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-reflections.html" class="sidebar-item-text sidebar-link">The Method of Reflections in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-fitness.html" class="sidebar-item-text sidebar-link">Fitness and Complexity in Two Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm-null.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backbone.html" class="sidebar-item-text sidebar-link">Extracting the Backbone of Bipartite Projections Using Two-Mode Graph Ensembles</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Statistical Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swap.html" class="sidebar-item-text sidebar-link">Graph Ensembles in Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qap.html" class="sidebar-item-text sidebar-link">Network Regression Using Permutation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm1.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ergm2.html" class="sidebar-item-text sidebar-link">Exponential Random Graphs Models II</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">Data Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loading.html" class="sidebar-item-text sidebar-link">Loading Network Data from a File</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-lists.html" class="sidebar-item-text sidebar-link">Handling Graph Objects in Lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subgraph-select.html" class="sidebar-item-text sidebar-link">Selecting a Subgraph Based on Edge Conditions</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#generalized-similarities" id="toc-generalized-similarities" class="nav-link active" data-scroll-target="#generalized-similarities">Generalized Similarities</a></li>
  <li><a href="#jeh-and-widoms-simrank" id="toc-jeh-and-widoms-simrank" class="nav-link" data-scroll-target="#jeh-and-widoms-simrank">Jeh and Widom’s SimRank</a></li>
  <li><a href="#the-lhn-approach" id="toc-the-lhn-approach" class="nav-link" data-scroll-target="#the-lhn-approach">The LHN Approach</a></li>
  <li><a href="#the-melnik-et-al.-approach" id="toc-the-melnik-et-al.-approach" class="nav-link" data-scroll-target="#the-melnik-et-al.-approach">The Melnik et al.&nbsp;Approach</a></li>
  <li><a href="#the-blondel-et-al.-self-similarity" id="toc-the-blondel-et-al.-self-similarity" class="nav-link" data-scroll-target="#the-blondel-et-al.-self-similarity">The Blondel et al.&nbsp;Self Similarity</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/gensim.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Generalized Vertex Similarities</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="generalized-similarities" class="level2">
<h2 class="anchored" data-anchor-id="generalized-similarities">Generalized Similarities</h2>
<p>So far, we have defined distances and similarities mainly as a function of the number of shared neighbors between two nodes. Structural equivalence is an idealized version of this, obtaining whenever people share exactly the same set of neighbors.</p>
<p>Yet, similarities based on local neighborhood information only have been criticized (e.g., by <span class="citation" data-cites="borgatti_everett92">Borgatti and Everett (<a href="#ref-borgatti_everett92" role="doc-biblioref">1992</a>)</span>) for not quite capturing the sociological intuition behind the idea of a <em>role</em> which is usually what they are deployed for. That is, two doctors don’t occupy the same role because they treat the <em>same</em> set of patients (in fact, this would be weird); instead, the set of doctors occupy the same role to the extent they treat a set of actors in the same (or similar) role: Namely, patients, regardless of whether those actors are literally the same or not.</p>
<p>This worry led social network analysts to try to generalize the concept of structural equivalence using less stringent algebraic definition, resulting in something of a proliferation of different equivalences such as <strong>automorphic</strong> or <strong>regular equivalence</strong> <span class="citation" data-cites="borgatti_everett92">(<a href="#ref-borgatti_everett92" role="doc-biblioref">Borgatti and Everett 1992</a>)</span>.</p>
<p>Unfortunately, none of this work led (unlike the work on structural equivalence) to useful or actionable tools for data analysis, with some even concluding that some definitions of equivalence (like regular equivalence) are unlikely to be found in any interesting substantive setting.</p>
<p>A better approach here is to use the more relaxed notion of similarity like we did above to come up with a more general definition that can capture our role-based intuitions. Note that all the similarity notions studied earlier have structural equivalence as the limiting case of maximum similarity. So they are still based on the idea that <em>nodes are similar to the extent they connect to the same others</em>.</p>
<p>We can generalize this idea (to deal with the doctor/patient role problem) in the following way: <em>nodes are similar to the extent they connect to similar others</em>, with the restriction that we can only use endogenous (structural connectivity) information—like with structural equivalence or common-neighbor approaches—to define everyone’s similarity (no exogenous attribute stuff).</p>
</section>
<section id="jeh-and-widoms-simrank" class="level2">
<h2 class="anchored" data-anchor-id="jeh-and-widoms-simrank">Jeh and Widom’s SimRank</h2>
<p>As <span class="citation" data-cites="jeh_widom02">Jeh and Widom (<a href="#ref-jeh_widom02" role="doc-biblioref">2002</a>)</span> note, this approach does lead to a coherent generalization of the idea of similarity for nodes in graphs because we can just define similarity <em>recursively</em> and iterate through the graph until the similarity scores stop changing.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>More specifically, they propose to measure the similarity between two nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> at each iteration-step <span class="math inline">\(t\)</span> (<span class="math inline">\(s_{ij}(t)\)</span>) using the formula:</p>
<p><span id="eq-simrank"><span class="math display">\[
   s_{ij}(t) = \frac{\alpha}{d_i d_j} \sum_{k \in N(i)} \sum_{l \in N(j)} s_{kl}(t-1)
\tag{1}\]</span></span></p>
<p>So the similarity between two nodes at step <span class="math inline">\(t\)</span> is just the sum of the pairwise similarities between each of their neighbors (computed in the previous step, <span class="math inline">\(t-1\)</span>), weighted by the ratio of a free parameter <span class="math inline">\(\alpha\)</span> (a number between zero and one) to the product of their degrees (to take a weighted average).</p>
<p>This measure nicely captures the idea that nodes are similar to the extent they both connect to people who are themselves similar. Note that it doesn’t matter whether these neighbors are shared between the two nodes (the summation occurs over each pair of nodes formed by crossing the set <span class="math inline">\(p\)</span> + <span class="math inline">\(q\)</span> against <span class="math inline">\(p\)</span> + <span class="math inline">\(r\)</span> as defined in the <a href="./locsim.html">local similarity</a> lecture), whether they are themselves neighbors, which deals with the doctor/patient problem we referred to earlier.</p>
<p>A function that implements this idea looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   SimRank <span class="ot">&lt;-</span> <span class="cf">function</span>(w, <span class="at">alpha =</span> <span class="fl">0.85</span>) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>      d <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(w) <span class="co">#degree vector</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(w) <span class="co">#number of nodes in the graph</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>      z <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n) <span class="co">#diagonal matrix (nodes are maximally similar to themselves)</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">rownames</span>(w)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">rownames</span>(w) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(w)} <span class="co">#checking if matrix has row names</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">colnames</span>(w)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">colnames</span>(w) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(w)} <span class="co">#checking if matrix has column names</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>      <span class="fu">rownames</span>(z) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(w) <span class="co">#naming similarity matrix rows</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>      <span class="fu">colnames</span>(z) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(w) <span class="co">#naming similarity matrix columns</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>      nei <span class="ot">&lt;-</span> <span class="fu">apply</span>(w, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">which</span>(x <span class="sc">==</span> <span class="dv">1</span>)}) <span class="co">#neighbors list</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>      delta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>      <span class="cf">while</span>(delta <span class="sc">&gt;</span> <span class="fl">1e-10</span>) { <span class="co">#run while delta is bigger than a tiny number</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>         z.o <span class="ot">&lt;-</span> z <span class="co">#old similarity matrix at t-1</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>         <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb1-14"><a href="#cb1-14"></a>            <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb1-15"><a href="#cb1-15"></a>               <span class="cf">if</span> (i <span class="sc">!=</span> j) { </span>
<span id="cb1-16"><a href="#cb1-16"></a>                  sigma <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#initialize ij sum for iteration t</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>                  <span class="cf">for</span> (k <span class="cf">in</span> nei[[i]]) { <span class="co">#loop through i's neighbors</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>                     <span class="cf">for</span> (l <span class="cf">in</span> nei[[j]]) { <span class="co">#loop through j's neighbors</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>                        sigma <span class="ot">&lt;-</span> sigma <span class="sc">+</span> z[k, l] <span class="co">#i's similarity to j is equal to sum of neighbors' similarity</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>                        } <span class="co">#end l for loop</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>                     } <span class="co">#end k for loop</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>                  z[i,j] <span class="ot">&lt;-</span> alpha<span class="sc">/</span>(d[i] <span class="sc">*</span> d[j]) <span class="sc">*</span> sigma <span class="co">#updating ij similarity score at t</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>                  } <span class="co">#end if</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>               } <span class="co">#end j for loop</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>            } <span class="co">#end i for loop</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>         delta <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(z)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(z.o))) <span class="co">#difference between similarity matrices at t and t-1</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>         } <span class="co">#end while loop</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>      <span class="fu">return</span>(z) <span class="co">#return similarity matrix after convergence</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>      } <span class="co">#end function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>SimRank</code> function takes an adjacency matrix as input (<code>w</code>) and returns a generalized similarity matrix between nodes (<code>z</code>) as output.</p>
<p>Let’s try it out in the <em>Pulp Fiction</em> graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb2-2"><a href="#cb2-2"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb2-3"><a href="#cb2-3"></a>   <span class="fu">library</span>(stringr) <span class="co">#using stringr to change names from all caps to title case</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>   g <span class="ot">&lt;-</span> movie_559</span>
<span id="cb2-5"><a href="#cb2-5"></a>   <span class="fu">V</span>(g)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">str_to_title</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name)</span>
<span id="cb2-6"><a href="#cb2-6"></a>   <span class="fu">V</span>(g)<span class="sc">$</span>name[<span class="fu">which</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Esmarelda"</span>)] <span class="ot">&lt;-</span> <span class="st">"Esmeralda"</span> <span class="co">#fixing misspelled name</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>   g <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g, <span class="fu">degree</span>(g) <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="co">#deleting low degree vertices</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb2-9"><a href="#cb2-9"></a>   S <span class="ot">&lt;-</span> <span class="fu">SimRank</span>(A)</span>
<span id="cb2-10"><a href="#cb2-10"></a>   <span class="fu">round</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Brett Buddy Butch Capt Koons Ed Sullivan
Brett        1.00  0.22  0.22       0.22        0.22
Buddy        0.22  1.00  0.22       0.32        0.52
Butch        0.22  0.22  1.00       0.22        0.22
Capt Koons   0.22  0.32  0.22       1.00        0.32
Ed Sullivan  0.22  0.52  0.22       0.32        1.00</code></pre>
</div>
</div>
<p>We can transform the generalized similarities to distances and plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb4-2"><a href="#cb4-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gensim_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Note that the lowest levels of the dendrogram hierarchy some of the pairings make a lot of sense: The Gimp is most similar to Zed, Pumpkin is most similar to Honey Bunny (and other characters in the diner scene), Jimmie is most similar ot the Wolf, and Jules, Marsellus, Butch, Mia, and Vincent (the main characters) are most similar to one another.</p>
<p>The plot suggests a division into five major node clusters. We can obtain that as follows using the <code>cutree</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Brett           Buddy           Butch      Capt Koons     Ed Sullivan 
              1               2               1               2               2 
   English Dave        Fabienne      Fourth Man       Gawker #2     Honey Bunny 
              2               1               3               1               4 
         Jimmie            Jody           Jules           Lance         Manager 
              3               2               1               2               4 
      Marsellus          Marvin         Maynard             Mia          Mother 
              1               1               5               1               2 
         Patron      Pedestrian        Preacher         Pumpkin          Raquel 
              4               1               2               4               3 
          Roger Sportscaster #1        The Gimp        The Wolf         Vincent 
              1               1               5               3               1 
       Waitress         Winston           Woman       Young Man     Young Woman 
              4               3               2               4               4 
            Zed 
              5 </code></pre>
</div>
</div>
</section>
<section id="the-lhn-approach" class="level2">
<h2 class="anchored" data-anchor-id="the-lhn-approach">The LHN Approach</h2>
<p><span class="citation" data-cites="leicht_etal06">Leicht, Holme, and Newman (<a href="#ref-leicht_etal06" role="doc-biblioref">2006</a>)</span> provide a twist on the SimRank approach. Their idea is that a node <span class="math inline">\(i\)</span> is similar to another node <span class="math inline">\(j\)</span> just in case <span class="math inline">\(i\)</span>’s neighbors are similar to <span class="math inline">\(j\)</span>:</p>
<p><span id="eq-lhn"><span class="math display">\[
   s_{ij}(t) = \delta_{ij} + \alpha \sum_{k \in N(i)} s_{kj}(t-1)
\tag{2}\]</span></span></p>
<p>Where <span class="math inline">\(\delta_{ij}\)</span> is the Kronecker function that equals one when <span class="math inline">\(i = j\)</span> and zero otherwise, and <span class="math inline">\(\alpha\)</span> is a number between zero and one with the restriction: <span class="math inline">\(\alpha &lt; \frac{1}{\lambda_1}\)</span>, where <span class="math inline">\(\lambda_1\)</span> is the largest eigenvalue of the adjacency matrix (also called the <strong>spectral radius</strong> of the adjacency matrix). This is required for the series to converge, just like the global Katz similarity <a href="./globsim.html">we considered before</a>.</p>
<p>Meanwhile, the <span class="math inline">\(\delta_{ij}\)</span> can be interpreted as “free similarity points” that each node gets for being similar to itself. In this setup, the pairwise similarity between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is just the sum of the previously calculated similarities between the set of neighbors of <span class="math inline">\(i\)</span> and the focal node <span class="math inline">\(j\)</span> weighted by the parameter <span class="math inline">\(\alpha\)</span>.</p>
<p>Here’s a function that does that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>   LHN.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(w, <span class="at">alpha =</span> <span class="fl">0.25</span>) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(w) <span class="co">#number of nodes in the graph</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>      z <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n) <span class="co">#diagonal matrix (nodes are maximally similar to themselves)</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">rownames</span>(w)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">rownames</span>(w) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(w)} <span class="co">#checking if matrix has row names</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">colnames</span>(w)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">colnames</span>(w) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(w)} <span class="co">#checking if matrix has column names</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>      <span class="fu">rownames</span>(z) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(w) <span class="co">#naming similarity matrix rows</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>      <span class="fu">colnames</span>(z) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(w) <span class="co">#naming similarity matrix columns</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>      nei <span class="ot">&lt;-</span> <span class="fu">apply</span>(w, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">which</span>(x <span class="sc">==</span> <span class="dv">1</span>)}) <span class="co">#neighbors list</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>      rho <span class="ot">&lt;-</span> (<span class="fu">eigen</span>(w)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">^-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fl">1e-02</span>  <span class="co">#inverse of spectral radius of adjacency matrix minus a tiny number</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>      <span class="cf">if</span>(alpha <span class="sc">&gt;</span> rho) {alpha <span class="ot">&lt;-</span> rho} <span class="co">#if alpha is larger than rho make it rho</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>      delta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>      <span class="cf">while</span>(delta <span class="sc">&gt;</span> <span class="fl">1e-10</span>) { <span class="co">#run while delta is bigger than a tiny number</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>         z.o <span class="ot">&lt;-</span> z <span class="co">#old similarity matrix at t-1</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>         <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb7-15"><a href="#cb7-15"></a>            <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb7-16"><a href="#cb7-16"></a>               sigma <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#initialize ij sum for iteration t</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>               <span class="cf">for</span> (k <span class="cf">in</span> nei[[i]]) { <span class="co">#loop through i's neighbors</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>                  sigma <span class="ot">&lt;-</span> sigma <span class="sc">+</span> z[k,j] <span class="co">#ij similarity equal to sum of i's neighbors' k similarity to j</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>                  } <span class="co">#end k for loop</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>               z[i,j] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(i <span class="sc">==</span> j) <span class="sc">+</span> (alpha <span class="sc">*</span> sigma) <span class="co">#updating ij similarity score at t</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>               } <span class="co">#end j for loop</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>            } <span class="co">#end i for loop</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>         delta <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(z)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(z.o))) <span class="co">#difference between similarity matrices at t and t-1</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>         } <span class="co">#end while loop</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>      <span class="fu">return</span>(z) <span class="co">#return similarity matrix after convergence</span></span>
<span id="cb7-26"><a href="#cb7-26"></a>      } <span class="co">#end function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And here are the results for the <em>Pulp Fiction</em> network:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">LHN.sim</span>(A)</span>
<span id="cb8-2"><a href="#cb8-2"></a>   <span class="fu">round</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Brett Buddy Butch Capt Koons Ed Sullivan
Brett        1.51  0.16  0.82       0.31        0.16
Buddy        0.16  1.08  0.25       0.13        0.08
Butch        0.82  0.25  2.16       0.61        0.25
Capt Koons   0.31  0.13  0.61       1.27        0.13
Ed Sullivan  0.16  0.08  0.25       0.13        1.08</code></pre>
</div>
</div>
<p>Note that in the LHN framework, nodes are always maximally similar to themselves.</p>
<p>We can transform the LHN generalized similarities to distances by dividing by the maximum and then clustering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>   S <span class="ot">&lt;-</span> S<span class="sc">/</span><span class="fu">max</span>(S)</span>
<span id="cb10-2"><a href="#cb10-2"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb10-3"><a href="#cb10-3"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gensim_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Which looks like another five-block partition. Cutting the dendrogram at the requisite height, we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Brett           Buddy           Butch      Capt Koons     Ed Sullivan 
              1               2               3               4               2 
   English Dave        Fabienne      Fourth Man       Gawker #2     Honey Bunny 
              4               2               2               2               4 
         Jimmie            Jody           Jules           Lance         Manager 
              2               2               3               2               4 
      Marsellus          Marvin         Maynard             Mia          Mother 
              1               1               5               1               4 
         Patron      Pedestrian        Preacher         Pumpkin          Raquel 
              4               2               2               4               2 
          Roger Sportscaster #1        The Gimp        The Wolf         Vincent 
              1               5               5               2               3 
       Waitress         Winston           Woman       Young Man     Young Woman 
              5               2               4               5               5 
            Zed 
              5 </code></pre>
</div>
</div>
<p>Which is a bit different from the SimRank clustering. Here, the three main characters <span class="math inline">\(\{\)</span> Vincent, Jules, Butch <span class="math inline">\(\}\)</span> appear as maximally similar in their own cluster, while <span class="math inline">\(\{\)</span> Brett, Marvin, Roger, Marsellus, Mia <span class="math inline">\(\}\)</span> form their own similarity group.</p>
</section>
<section id="the-melnik-et-al.-approach" class="level2">
<h2 class="anchored" data-anchor-id="the-melnik-et-al.-approach">The Melnik et al.&nbsp;Approach</h2>
<p><span class="citation" data-cites="melnik_etal02">Melnik, Garcia-Molina, and Rahm (<a href="#ref-melnik_etal02" role="doc-biblioref">2002</a>)</span> provide yet another variation on the theme of generalized similarity scoring. Their approach is a bit different that SimRank or the LHN strategy. The idea is to start from state in which <em>all</em> pairs of nodes have the same similarity score (e.g., <span class="math inline">\(s_{ij} = 1\)</span>) at <span class="math inline">\(t = 0\)</span> and then update the subsequent similarities according to the rule:</p>
<p><span id="eq-melnik"><span class="math display">\[
s_{ij}(t) = s_{ij}(t-1) + \left[\sum_{k \in N(i)} \sum_{l \in N(j)} \frac{1}{d_k d_l} s_{kl}(t-1)\right]
\tag{3}\]</span></span></p>
<p>So the similarity between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is equal to their previous similarity <span class="math inline">\(s_{ij}(t-1)\)</span> plus the sum of their neighbors similarity (just like SimRank), weighted by their respective degrees (unlike SimRank).</p>
<p>In order for the iterations to converge, we need to normalize the similarity matrix <span class="math inline">\(\mathbf{S}\)</span> at each iteration step <span class="math inline">\(t\)</span> according to:</p>
<p><span class="math display">\[
\mathbf{S}(t) = \frac{\mathbf{S}(t)}{||\mathbf{S}(t)||_2}
\]</span></p>
<p>Where <span class="math inline">\(||\mathbf{S}||_2\)</span> is the matrix Frobenius (Euclidean) norm, or the square root of the sum of the square entries:</p>
<p><span class="math display">\[
||\mathbf{S}(t)||_2 = \sqrt{\sum_i \sum_j s_{ij}(t)^2}
\]</span></p>
<p>Here’s a function that does that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>   melnik.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(w) {</span>
<span id="cb13-2"><a href="#cb13-2"></a>      d <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(w) <span class="co">#degree vector</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(w) <span class="co">#number of nodes in the graph</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>      z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, n, n) <span class="co">#all pairs start as equally similar (sij = 1)</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">rownames</span>(w)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">rownames</span>(w) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(w)} <span class="co">#checking if matrix has row names</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">colnames</span>(w)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">colnames</span>(w) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(w)} <span class="co">#checking if matrix has column names</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>      <span class="fu">rownames</span>(z) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(w) <span class="co">#naming similarity matrix rows</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>      <span class="fu">colnames</span>(z) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(w) <span class="co">#naming similarity matrix columns</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>      nei <span class="ot">&lt;-</span> <span class="fu">apply</span>(w, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">which</span>(x <span class="sc">==</span> <span class="dv">1</span>)}) <span class="co">#neighbors list</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>      delta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>      <span class="cf">while</span>(delta <span class="sc">&gt;</span> <span class="fl">1e-10</span>) { <span class="co">#run while delta is bigger than a tiny number</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>         z.o <span class="ot">&lt;-</span> z <span class="co">#old similarity matrix at t-1</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>         <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb13-14"><a href="#cb13-14"></a>            <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb13-15"><a href="#cb13-15"></a>               sigma <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#initialize ij sum for iteration t</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>               <span class="cf">for</span> (k <span class="cf">in</span> nei[[i]]) { <span class="co">#loop through i's neighbors</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>                  <span class="cf">for</span> (l <span class="cf">in</span> nei[[j]]) { <span class="co">#loop through j's neighbors</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>                     sigma <span class="ot">&lt;-</span> sigma <span class="sc">+</span> (d[k]<span class="sc">*</span>d[l])<span class="sc">^-</span><span class="dv">1</span> <span class="sc">*</span> z[k,l] <span class="co">#i's similarity to j is equal to sum of neighbors' similarity weighted by their degree </span></span>
<span id="cb13-19"><a href="#cb13-19"></a>                     } <span class="co">#end l for loop</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>                  } <span class="co">#end k for loop</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>               z[i,j] <span class="ot">&lt;-</span> z[i,j] <span class="sc">+</span> sigma <span class="co">#updating ij similarity score at t</span></span>
<span id="cb13-22"><a href="#cb13-22"></a>               } <span class="co">#end j for loop</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>            } <span class="co">#end i for loop</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>         z <span class="ot">&lt;-</span> z<span class="sc">/</span><span class="fu">norm</span>(z, <span class="at">type =</span> <span class="st">"F"</span>) <span class="co">#normalizing similarity matrix at z</span></span>
<span id="cb13-25"><a href="#cb13-25"></a>         delta <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(z)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(z.o))) <span class="co">#difference between similarity matrices at t and t-1</span></span>
<span id="cb13-26"><a href="#cb13-26"></a>         } <span class="co">#end while loop</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>      <span class="fu">return</span>(z) <span class="co">#return similarity matrix after convergence</span></span>
<span id="cb13-28"><a href="#cb13-28"></a>      } <span class="co">#end function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now test it on the <em>Pulp Fiction</em> network:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">melnik.sim</span>(A)</span>
<span id="cb14-2"><a href="#cb14-2"></a>   <span class="fu">round</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Brett Buddy Butch Capt Koons Ed Sullivan
Brett        0.01  0.00  0.03       0.01        0.00
Buddy        0.00  0.00  0.01       0.00        0.00
Butch        0.03  0.01  0.08       0.02        0.01
Capt Koons   0.01  0.00  0.03       0.01        0.00
Ed Sullivan  0.00  0.00  0.01       0.00        0.00</code></pre>
</div>
</div>
<p>Which yields the following distance matrix and hierarchical clustering dendrogram:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>   S <span class="ot">&lt;-</span> S<span class="sc">/</span><span class="fu">max</span>(S)</span>
<span id="cb16-2"><a href="#cb16-2"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb16-3"><a href="#cb16-3"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gensim_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Which looks like yet another five-block partition. Cutting the dendrogram at the requisite height, we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   blocks  <span class="ot">&lt;-</span> <span class="fu">cutree</span>(h.res, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>   blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Brett           Buddy           Butch      Capt Koons     Ed Sullivan 
              1               1               2               1               1 
   English Dave        Fabienne      Fourth Man       Gawker #2     Honey Bunny 
              1               1               1               1               3 
         Jimmie            Jody           Jules           Lance         Manager 
              1               1               4               1               3 
      Marsellus          Marvin         Maynard             Mia          Mother 
              2               3               1               4               3 
         Patron      Pedestrian        Preacher         Pumpkin          Raquel 
              3               1               1               2               1 
          Roger Sportscaster #1        The Gimp        The Wolf         Vincent 
              2               1               1               1               5 
       Waitress         Winston           Woman       Young Man     Young Woman 
              3               3               2               3               2 
            Zed 
              1 </code></pre>
</div>
</div>
<p>Note that the Milnek et al.&nbsp;approach produces a clustering that is distinct from that obtained using either SimRank or LHN. Here, <span class="math inline">\(\{\)</span> Vincent <span class="math inline">\(\}\)</span> is its own singleton cluster, and <span class="math inline">\(\{\)</span> Jules, Mia <span class="math inline">\(\}\)</span> comprise another small similarity class.</p>
</section>
<section id="the-blondel-et-al.-self-similarity" class="level2">
<h2 class="anchored" data-anchor-id="the-blondel-et-al.-self-similarity">The Blondel et al.&nbsp;Self Similarity</h2>
<p>We can adapt the approach we used to compute the similarity between nodes in different graphs <a href="./blondel.html">here</a> to compute the similarity between nodes in the same graph, or what <span class="citation" data-cites="blondel_etal04">Blondel et al. (<a href="#ref-blondel_etal04" role="doc-biblioref">2004</a>)</span> call the <em>self-similarity</em>.</p>
<p>Recall that the similarity between nodes in different graphs <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> can be computed using the following formula:</p>
<p><span id="eq-blondel"><span class="math display">\[
   \mathbf{Z}(t) = \mathbf{B}\mathbf{Z(t-1)}\mathbf{A}^T + \mathbf{B}^T\mathbf{Z(t-1)}\mathbf{A}
\tag{4}\]</span></span></p>
<p>Where the similarity matrix at <span class="math inline">\(t=0\)</span> is <span class="math inline">\(\mathbf{Z}(0) = 1\)</span>, the all ones matrix.</p>
<p>So to compute the self-similarity for a single graph <span class="math inline">\(\mathbf{A}\)</span>, we just plug in <span class="math inline">\(\mathbf{A}\)</span> instead of <span class="math inline">\(\mathbf{B}\)</span> in <a href="#eq-blondel">Equation&nbsp;4</a> to get:</p>
<p><span id="eq-selfsim"><span class="math display">\[
   \mathbf{Z}(t) = \mathbf{A}\mathbf{Z(t-1)}\mathbf{A}^T + \mathbf{A}^T\mathbf{Z(t-1)}\mathbf{A}
\tag{5}\]</span></span></p>
<p>Here’s a function that does that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   self.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb19-2"><a href="#cb19-2"></a>      z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(a), <span class="fu">nrow</span>(a))</span>
<span id="cb19-3"><a href="#cb19-3"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">rownames</span>(a)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">rownames</span>(a) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(a)} <span class="co">#checking if matrix has row names</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">colnames</span>(a)) <span class="sc">==</span> <span class="cn">TRUE</span>) {<span class="fu">colnames</span>(a) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(a)} <span class="co">#checking if matrix has column names</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>      <span class="fu">rownames</span>(z) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(a)</span>
<span id="cb19-6"><a href="#cb19-6"></a>      <span class="fu">colnames</span>(z) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(a)</span>
<span id="cb19-7"><a href="#cb19-7"></a>      d <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#initializing  delta</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>      d.o <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#initializing comparison delta</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>      m <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#initializing iteration counter</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>      <span class="cf">while</span> (d <span class="sc">!=</span> d.o <span class="sc">|</span> m <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">!=</span> <span class="dv">0</span>) { <span class="co">#do while the previous delta is different from the current delta and the iteration is odd</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>         z.o <span class="ot">&lt;-</span> z <span class="co">#initializing old similarity matrix</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>         d.o <span class="ot">&lt;-</span> d <span class="co">#old delta equals previous delta</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>         z <span class="ot">&lt;-</span> (a <span class="sc">%*%</span> z.o <span class="sc">%*%</span> <span class="fu">t</span>(a)) <span class="sc">+</span> (<span class="fu">t</span>(a) <span class="sc">%*%</span> z.o <span class="sc">%*%</span> a) <span class="co">#blondel et al. similarity equation</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>         z <span class="ot">&lt;-</span> z<span class="sc">/</span><span class="fu">norm</span>(z, <span class="at">type =</span> <span class="st">"F"</span>) <span class="co">#normalizing similarity matrix</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>         d <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(z)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(z.o))) <span class="co">#updating delta</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>         m <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span> <span class="co">#updating iteration counter</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>         }</span>
<span id="cb19-18"><a href="#cb19-18"></a>   <span class="fu">return</span>(z) <span class="co">#return converged similarity matrix</span></span>
<span id="cb19-19"><a href="#cb19-19"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now test it on the <em>Pulp Fiction</em> network:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">self.sim</span>(A)</span>
<span id="cb20-2"><a href="#cb20-2"></a>   S <span class="ot">&lt;-</span> S<span class="sc">/</span><span class="fu">max</span>(S)</span>
<span id="cb20-3"><a href="#cb20-3"></a>   <span class="fu">round</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Brett Buddy Butch Capt Koons Ed Sullivan
Brett        0.23  0.08  0.35       0.16        0.08
Buddy        0.08  0.03  0.13       0.06        0.03
Butch        0.35  0.13  0.53       0.24        0.13
Capt Koons   0.16  0.06  0.24       0.11        0.06
Ed Sullivan  0.08  0.03  0.13       0.06        0.03</code></pre>
</div>
</div>
<p>Which yields the following distance matrix and hierarchical clustering dendrogram:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   D <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="dv">1</span><span class="sc">-</span> S)</span>
<span id="cb22-2"><a href="#cb22-2"></a>   h.res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D, <span class="at">method =</span> <span class="st">"ward.D2"</span>) <span class="co">#hierarchical clustering</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>   <span class="fu">plot</span>(h.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gensim_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>This approach yields five major similarity clusters. At the center we see the cluster composed of the main characters <span class="math inline">\(\{\)</span> Vincent, Butch, Jules <span class="math inline">\(\}\)</span>, on the right we see two clusters composed <span class="math inline">\(\{\)</span> Pumpkin, Honey Bunny <span class="math inline">\(\}\)</span> and the other diner folk, and another composed of <span class="math inline">\(\{\)</span> Mia, Marsellus, Rogert, Brett, Marvin <span class="math inline">\(\}\)</span>. The cluster on the left is bigger, but we can see that maximally similar characters like <span class="math inline">\(\{\)</span> Zed, The Gimp <span class="math inline">\(\}\)</span> make sense.</p>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<p>A more general (and shorter) version of the function to compute <code>SimRank</code> looks like this <span class="citation" data-cites="fouss_etal16">(partly based on <a href="#ref-fouss_etal16" role="doc-biblioref">Fouss, Saerens, and Shimbo 2016, 84</a>, algorithm 2.4)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>   SimRank2 <span class="ot">&lt;-</span> <span class="cf">function</span>(w, <span class="at">alpha =</span> <span class="fl">0.85</span>) {</span>
<span id="cb23-2"><a href="#cb23-2"></a>      n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(w) <span class="co">#number of nodes</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>      d <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">colSums</span>(w) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="co">#degree vector</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>      e <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, n, <span class="dv">1</span>) <span class="co">#all ones column vector</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>      q <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(e) <span class="sc">%*%</span> w), n, n) <span class="co">#q matrix</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>      <span class="fu">diag</span>(q) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(q) <span class="co">#setting q diagonals to inverse</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>      q <span class="ot">&lt;-</span> w <span class="sc">%*%</span> q</span>
<span id="cb23-8"><a href="#cb23-8"></a>      q[<span class="fu">is.nan</span>(q)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>      delta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>      k <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n)</span>
<span id="cb23-11"><a href="#cb23-11"></a>      <span class="cf">while</span>(delta <span class="sc">&gt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb23-12"><a href="#cb23-12"></a>         k.o <span class="ot">&lt;-</span> k</span>
<span id="cb23-13"><a href="#cb23-13"></a>         k.p <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">t</span>(q) <span class="sc">%*%</span> k <span class="sc">%*%</span> q</span>
<span id="cb23-14"><a href="#cb23-14"></a>         k <span class="ot">&lt;-</span> k.p <span class="sc">-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(k.p), n, n) <span class="sc">+</span> <span class="fu">diag</span>(d, n, n)</span>
<span id="cb23-15"><a href="#cb23-15"></a>         delta <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(k)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(k.o)))</span>
<span id="cb23-16"><a href="#cb23-16"></a>         }</span>
<span id="cb23-17"><a href="#cb23-17"></a>      <span class="fu">rownames</span>(k) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(w)</span>
<span id="cb23-18"><a href="#cb23-18"></a>      <span class="fu">colnames</span>(k) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(w)</span>
<span id="cb23-19"><a href="#cb23-19"></a>      <span class="fu">return</span>(k)</span>
<span id="cb23-20"><a href="#cb23-20"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-blondel_etal04" class="csl-entry" role="doc-biblioentry">
Blondel, Vincent D, Anahı́ Gajardo, Maureen Heymans, Pierre Senellart, and Paul Van Dooren. 2004. <span>“A Measure of Similarity Between Graph Vertices: Applications to Synonym Extraction and Web Searching.”</span> <em>SIAM Review</em> 46 (4): 647–66.
</div>
<div id="ref-borgatti_everett92" class="csl-entry" role="doc-biblioentry">
Borgatti, Stephen P, and Martin G Everett. 1992. <span>“Notions of Position in Social Network Analysis.”</span> <em>Sociological Methodology</em> 22: 1–35.
</div>
<div id="ref-fouss_etal16" class="csl-entry" role="doc-biblioentry">
Fouss, François, Marco Saerens, and Masashi Shimbo. 2016. <em>Algorithms and Models for Network Data and Link Analysis</em>. Cambridge University Press.
</div>
<div id="ref-jeh_widom02" class="csl-entry" role="doc-biblioentry">
Jeh, Glen, and Jennifer Widom. 2002. <span>“Simrank: A Measure of Structural-Context Similarity.”</span> In <em>Proceedings of the Eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 538–43.
</div>
<div id="ref-leicht_etal06" class="csl-entry" role="doc-biblioentry">
Leicht, Elizabeth A, Petter Holme, and Mark EJ Newman. 2006. <span>“Vertex Similarity in Networks.”</span> <em>Physical Review E—Statistical, Nonlinear, and Soft Matter Physics</em> 73 (2): 026120.
</div>
<div id="ref-melnik_etal02" class="csl-entry" role="doc-biblioentry">
Melnik, Sergey, Hector Garcia-Molina, and Erhard Rahm. 2002. <span>“Similarity Flooding: A Versatile Graph Matching Algorithm and Its Application to Schema Matching.”</span> In <em>Proceedings 18th International Conference on Data Engineering</em>, 117–28. IEEE.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Note the similarity (heh, heh) between this idea and the various status ranking algorithms for computing <a href="./tm-prestige.html">prestige scores</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>