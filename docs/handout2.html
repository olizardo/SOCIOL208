<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Centrality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Centrality">
<meta property="og:description" content="In this handout we will go through the basic centrality metrics. Particularly, the “big three” according to Freeman (1979), namely, degree, closeness (in two flavors) and betweenness.">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Centrality</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Handouts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout1.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout2.html" class="sidebar-item-text sidebar-link active">Centrality</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#degree-centrality" id="toc-degree-centrality" class="nav-link active" data-scroll-target="#degree-centrality">Degree Centrality</a></li>
  <li><a href="#indegree-and-outdegree" id="toc-indegree-and-outdegree" class="nav-link" data-scroll-target="#indegree-and-outdegree">Indegree and Outdegree</a>
  <ul class="collapse">
  <li><a href="#subsetting-the-graph-according-to-a-node-attribute" id="toc-subsetting-the-graph-according-to-a-node-attribute" class="nav-link" data-scroll-target="#subsetting-the-graph-according-to-a-node-attribute">Subsetting the Graph According to a Node Attribute</a></li>
  <li><a href="#computing-in-and-outdegree" id="toc-computing-in-and-outdegree" class="nav-link" data-scroll-target="#computing-in-and-outdegree">Computing in and outdegree</a></li>
  </ul></li>
  <li><a href="#closeness-centrality" id="toc-closeness-centrality" class="nav-link" data-scroll-target="#closeness-centrality">Closeness Centrality</a></li>
  <li><a href="#edge-closeness" id="toc-edge-closeness" class="nav-link" data-scroll-target="#edge-closeness">Edge Closeness</a></li>
  <li><a href="#closeness-centrality-in-directed-graphs" id="toc-closeness-centrality-in-directed-graphs" class="nav-link" data-scroll-target="#closeness-centrality-in-directed-graphs">Closeness Centrality in Directed Graphs</a>
  <ul class="collapse">
  <li><a href="#harmonic-centrality" id="toc-harmonic-centrality" class="nav-link" data-scroll-target="#harmonic-centrality">Harmonic Centrality</a></li>
  </ul></li>
  <li><a href="#betweenness" id="toc-betweenness" class="nav-link" data-scroll-target="#betweenness">Betweenness</a></li>
  <li><a href="#edge-betweenness" id="toc-edge-betweenness" class="nav-link" data-scroll-target="#edge-betweenness">Edge Betweenness</a>
  <ul class="collapse">
  <li><a href="#disconnecting-a-graph-via-bridge-removal" id="toc-disconnecting-a-graph-via-bridge-removal" class="nav-link" data-scroll-target="#disconnecting-a-graph-via-bridge-removal">Disconnecting a Graph Via Bridge Removal</a></li>
  </ul></li>
  <li><a href="#induced-betweenness" id="toc-induced-betweenness" class="nav-link" data-scroll-target="#induced-betweenness">Induced Betweenness</a></li>
  <li><a href="#generalized-harmonic-centrality" id="toc-generalized-harmonic-centrality" class="nav-link" data-scroll-target="#generalized-harmonic-centrality">Generalized Harmonic Centrality</a></li>
  <li><a href="#appendix-selecting-a-subgraph-based-on-edge-conditions" id="toc-appendix-selecting-a-subgraph-based-on-edge-conditions" class="nav-link" data-scroll-target="#appendix-selecting-a-subgraph-based-on-edge-conditions">Appendix: Selecting a Subgraph Based on Edge Conditions</a></li>
  <li><a href="#note-handling-graph-objects-in-lists" id="toc-note-handling-graph-objects-in-lists" class="nav-link" data-scroll-target="#note-handling-graph-objects-in-lists">Note: Handling Graph Objects in Lists</a>
  <ul class="collapse">
  <li><a href="#looping-through-lists" id="toc-looping-through-lists" class="nav-link" data-scroll-target="#looping-through-lists">Looping Through Lists</a></li>
  <li><a href="#naming-lists" id="toc-naming-lists" class="nav-link" data-scroll-target="#naming-lists">Naming Lists</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/handout2.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Centrality</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this handout we will go through the basic centrality metrics. Particularly, the “big three” according to <span class="citation" data-cites="freeman79">Freeman (<a href="#ref-freeman79" role="doc-biblioref">1979</a>)</span>, namely, <strong>degree</strong>, <strong>closeness</strong> (in two flavors) and <strong>betweenness</strong>.</p>
<p>We first load our trusty <em>Pulp Fiction</em> data set from the <code>networkdata</code> package, which is an <strong>undirected</strong> graph of character scene co-appearances in the film:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3"></a>   g <span class="ot">&lt;-</span> movie_559</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="degree-centrality" class="level2">
<h2 class="anchored" data-anchor-id="degree-centrality">Degree Centrality</h2>
<p>Degree centrality is the simplest and most straightforward measure. In fact, we are already computed in <a href="https://olizardo.github.io/SOCIOL208/handout1.html">handout 1</a> since it is the same as obtaining the graph’s <strong>degree sequence</strong>. So the <code>igraph</code> function <code>degree</code> would do it as we already saw.</p>
<p>Here we follow a different approach using the row (or column) sums of the graph’s <strong>adjacency matrix</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as_adjacency_matrix</span>(g)</span>
<span id="cb2-2"><a href="#cb2-2"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(A)</span>
<span id="cb2-3"><a href="#cb2-3"></a>   <span class="fu">rowSums</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          BRETT           BUDDY           BUTCH      CAPT KOONS     ED SULLIVAN 
              7               2              17               5               2 
   ENGLISH DAVE       ESMARELDA        FABIENNE      FOURTH MAN       GAWKER #2 
              4               1               3               2               3 
    HONEY BUNNY          JIMMIE            JODY           JULES           LANCE 
              8               3               4              16               4 
        MANAGER       MARSELLUS          MARVIN         MAYNARD             MIA 
              5              10               6               3              11 
         MOTHER          PATRON      PEDESTRIAN        PREACHER         PUMPKIN 
              5               5               3               3               8 
         RAQUEL           ROGER SPORTSCASTER #1 SPORTSCASTER #2        THE GIMP 
              3               6               2               1               2 
       THE WOLF         VINCENT        WAITRESS         WINSTON           WOMAN 
              3              25               4               3               5 
      YOUNG MAN     YOUNG WOMAN             ZED 
              4               4               2 </code></pre>
</div>
</div>
<p>The <code>igraph</code> function <code>as_adjancency_matrix</code> doesn’t quite return a regular <code>R</code> matrix object, so we have to further coerce the resulting object into a numerical matrix containing zeroes and ones using the <code>as.matrix</code> function in line 2. Then we can apply the native <code>rowSums</code> function to obtain each node’s degree. Note that this is same output we got using the <code>degree</code> function before.</p>
</section>
<section id="indegree-and-outdegree" class="level2">
<h2 class="anchored" data-anchor-id="indegree-and-outdegree">Indegree and Outdegree</h2>
<p>The movie network is based on the relationship of co-appearance in a scene which by nature lacks any natural directionality (it’s a symmetric relation) and can therefore be represented in an <strong>undirected graph</strong>. The concepts of in and outdegree, by contrast, are only applicable to directed relations. So to illustrate them, we need to switch to a different source of data.</p>
<p>We pick an <strong>advice network</strong> which is a classical directed kind of (asymmetric) relation. I can give advice to you, but that doesn’t necessarily mean you can give advice to me. The <code>networkdata</code> package contains one such data set collected in the late 80s early 1990s in a New England law firm (see the description <a href="https://rdrr.io/github/schochastics/networkdata/man/law_advice.html">here</a>), called <code>law_advice</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>   d.g <span class="ot">&lt;-</span> law_advice</span>
<span id="cb4-2"><a href="#cb4-2"></a>   <span class="fu">V</span>(d.g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 71/71 vertices, from d1a9da7:
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
[51] 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   <span class="fu">vertex_attr</span>(d.g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$status
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

$gender
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 2 1 1 1 1 2 1 1 1 2
[39] 2 1 1 1 2 2 1 2 1 2 1 1 2 1 1 1 1 1 2 1 2 2 2 1 1 2 1 1 2 1 2 1 2

$office
 [1] 1 1 2 1 2 2 2 1 1 1 1 1 1 2 3 1 1 2 1 1 1 1 1 1 2 1 1 2 1 2 2 2 2 1 2 1 3 1
[39] 1 1 1 1 1 3 1 2 3 1 1 2 2 1 1 1 1 1 1 2 2 1 1 1 2 1 1 1 1 1 1 1 1

$seniority
 [1] 31 32 13 31 31 29 29 28 25 25 23 24 22  1 21 20 23 18 19 19 17  9 16 15 15
[26] 15 13 11 10  7  8  8  8  8  8  5  5  7  6  6  5  4  5  5  3  3  3  1  4  3
[51]  4  4 10  3  3  3  3  3  2  2  2  2  2  2  2  1  1  1  1  1  1

$age
 [1] 64 62 67 59 59 55 63 53 53 53 50 52 57 56 48 46 50 45 46 49 43 49 45 44 43
[26] 41 47 38 38 39 34 33 37 36 33 43 44 53 37 34 31 31 47 53 38 42 38 35 36 31
[51] 29 29 38 29 34 38 33 33 30 31 34 32 29 45 28 43 35 26 38 31 26

$practice
 [1] 1 2 1 2 1 1 2 1 2 2 1 2 1 2 2 2 2 1 2 1 1 1 1 1 2 1 1 2 2 1 1 1 1 2 2 1 2 1
[39] 1 1 1 2 1 2 2 2 1 2 1 2 1 1 2 1 1 1 1 1 1 2 2 2 2 2 1 1 1 1 1 2 1

$law_school
 [1] 1 1 1 3 2 1 3 3 1 3 1 2 2 1 3 1 1 2 1 1 2 3 2 2 2 3 1 2 3 3 2 3 3 2 3 3 3 2
[39] 1 1 2 2 2 1 3 2 3 3 2 2 3 3 3 3 3 2 2 3 2 2 3 2 2 2 3 3 2 3 3 2 2</code></pre>
</div>
</div>
<p>We can see that the graph has 71 vertices, and that there are various <strong>attributes</strong> associated with each vertex, like gender, age, seniority, status in the law firm, etc. We can query those attributes using the <code>igraph</code> function <code>vertex_attr</code>, which takes the graph object as input.</p>
<section id="subsetting-the-graph-according-to-a-node-attribute" class="level3">
<h3 class="anchored" data-anchor-id="subsetting-the-graph-according-to-a-node-attribute">Subsetting the Graph According to a Node Attribute</h3>
<p>To keep things manageable, we will restrict our analysis to partners. To do that we need to select the <strong>subgraph</strong> that only includes the vertices with value of 1 in the “status” vertex attribute. From the <a href="https://rdrr.io/github/schochastics/networkdata/man/law_advice.html">data description</a>, we know the first 36 nodes (with value of 1 in the status attribute) are the law firm’s partners (the rest are associates). In <code>igraph</code> we can do this as using the <code>subgraph</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   d.g <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(d.g, <span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>   <span class="fu">V</span>(d.g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 36/36 vertices, from cb628e7:
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32 33 34 35 36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>   <span class="fu">V</span>(d.g)<span class="sc">$</span>status</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<p>The first line just tells <code>igraph</code> to generate the subgraph containing the first 36 nodes (the partners). The <code>subgraph</code> function thus takes two main inputs: The graph object, and then a vector of node ids (or node labels) telling the function which nodes to select to create the <strong>node-induced subgraph</strong>.</p>
<p>Of course we already knew from the data description that the first 36 nodes where the partners. But let’s say we have a large data set and we don’t know <em>which</em> nodes are the partners. A smarter way of selecting a subgraph based on a node attribute is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>   partners <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(law_advice)<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>   d.g <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(law_advice, partners)</span>
<span id="cb12-3"><a href="#cb12-3"></a>   <span class="fu">V</span>(d.g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 36/36 vertices, from cb691bb:
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32 33 34 35 36</code></pre>
</div>
</div>
<p>The first line using the native <code>R</code> vector function <code>which</code> allowing us to subset a vector based on a logical condition. The function takes a vector followed by a logical condition as input, and returns the <em>position</em> of the vector elements that meet that condition. In this case, we took the vector of values for the attribute of status and selected the node ids where status is equal to 1. We then fed that vector to the <code>subgraph</code> function in line 2.</p>
<p>We could do this with any other attribute:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   older <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(law_advice)<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">50</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>   older</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 12 13 14 38 44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>   og <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(law_advice, older)</span>
<span id="cb16-2"><a href="#cb16-2"></a>   <span class="fu">V</span>(og)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 15/15 vertices, from cb6eeb1:
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</code></pre>
</div>
</div>
<p>Here we selected the subgraph (called “og”, get it, get it) formed by the subset of nodes over the age of 50 at the firm. The values of the vector older tell us which of the 71 members meet the relevant condition.</p>
</section>
<section id="computing-in-and-outdegree" class="level3">
<h3 class="anchored" data-anchor-id="computing-in-and-outdegree">Computing in and outdegree</h3>
<p>OK, going back to the partners subgraph, we can now create our (asymmetric) adjacency matrix and compute the row and column sums:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>   d.A <span class="ot">&lt;-</span> <span class="fu">as_adjacency_matrix</span>(d.g)</span>
<span id="cb18-2"><a href="#cb18-2"></a>   d.A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(d.A)</span>
<span id="cb18-3"><a href="#cb18-3"></a>   <span class="fu">rowSums</span>(d.A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3  7  7 17  4  0  4  2  3  7  5 18 11 13 10 19 17  5 21 10  9 12  9 16  8
[26] 22 18 22 13 15 16  9 15  6 15  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>   <span class="fu">colSums</span>(d.A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 18 17  8 14 10 17  4  8 10  6 11 14 14 12 15 13 21  7  7 17 11 10  2 14  7
[26] 20  2 14 12 11  8 13  2 16  8  2</code></pre>
</div>
</div>
<p>Note that in contrast to the undirected case the row and column sums give you two different sets of numbers. The row sums provide the directed graph’s <strong>outdegree set</strong> (number of <em>outgoing</em> links incident to each node), and the column sums provide the graph’s <strong>indegree set</strong> (number of <em>incoming</em> links incident to each node). So if you are high in the first vector, you are an <em>advice giver</em> (perhaps indicating informal status or experience) and if you are high in the second you are advice taker.</p>
<p>Of course <code>igraph</code> has a dedicated function for this, which is just our old friend <code>degree</code> with an extra option <code>mode</code>, indicating whether you want the in or outdegrees:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>   d.o <span class="ot">&lt;-</span> <span class="fu">degree</span>(d.g, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>   d.i <span class="ot">&lt;-</span> <span class="fu">degree</span>(d.g, <span class="at">mode =</span> <span class="st">"in"</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>   d.o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3  7  7 17  4  0  4  2  3  7  5 18 11 13 10 19 17  5 21 10  9 12  9 16  8
[26] 22 18 22 13 15 16  9 15  6 15  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>   d.i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 18 17  8 14 10 17  4  8 10  6 11 14 14 12 15 13 21  7  7 17 11 10  2 14  7
[26] 20  2 14 12 11  8 13  2 16  8  2</code></pre>
</div>
</div>
<p>Note that the graph attributes are just vectors of values, and can be accessed from the graph object using the $ operator attached to the <code>V()</code> function as we did above.</p>
<p>So if we wanted to figure out the correlation between some vertex attribute and in or out degree centrality, all we need to do is correlate the two vectors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>   r <span class="ot">&lt;-</span> <span class="fu">cor</span>(d.o, <span class="fu">V</span>(d.g)<span class="sc">$</span>age)</span>
<span id="cb26-2"><a href="#cb26-2"></a>   <span class="fu">round</span>(r, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.43</code></pre>
</div>
</div>
<p>Which tells us that at least in this case, younger partners are more sought after as sources of advice than older partners.</p>
</section>
</section>
<section id="closeness-centrality" class="level2">
<h2 class="anchored" data-anchor-id="closeness-centrality">Closeness Centrality</h2>
<p>Recall that the <strong>closeness centrality</strong> is defined as the inverse of the sum of the <em>lengths</em> of shortest paths from each node to every other node. That means that to compute it, we first need to calculate the shortest path matrix. Then, we sum the rows (or columns) and then we obtain the inverse to get the closeness of each node:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">distances</span>(g) <span class="co">#length of shortest paths matrix</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>   d.sum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(S)</span>
<span id="cb28-3"><a href="#cb28-3"></a>   close1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>d.sum, <span class="dv">4</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a>   close1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          BRETT           BUDDY           BUTCH      CAPT KOONS     ED SULLIVAN 
         0.0125          0.0108          0.0143          0.0125          0.0108 
   ENGLISH DAVE       ESMARELDA        FABIENNE      FOURTH MAN       GAWKER #2 
         0.0105          0.0070          0.0096          0.0104          0.0097 
    HONEY BUNNY          JIMMIE            JODY           JULES           LANCE 
         0.0114          0.0093          0.0093          0.0132          0.0093 
        MANAGER       MARSELLUS          MARVIN         MAYNARD             MIA 
         0.0111          0.0104          0.0103          0.0098          0.0115 
         MOTHER          PATRON      PEDESTRIAN        PREACHER         PUMPKIN 
         0.0125          0.0111          0.0097          0.0097          0.0114 
         RAQUEL           ROGER SPORTSCASTER #1 SPORTSCASTER #2        THE GIMP 
         0.0105          0.0125          0.0096          0.0057          0.0073 
       THE WOLF         VINCENT        WAITRESS         WINSTON           WOMAN 
         0.0056          0.0139          0.0083          0.0105          0.0125 
      YOUNG MAN     YOUNG WOMAN             ZED 
         0.0083          0.0083          0.0073 </code></pre>
</div>
</div>
<p>Of course, we could have just used the available function in igraph and computed the closeness centrality directly from the graph object using the function <code>closeness</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>   close2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">closeness</span>(g), <span class="dv">4</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>   close2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          BRETT           BUDDY           BUTCH      CAPT KOONS     ED SULLIVAN 
         0.0125          0.0108          0.0143          0.0125          0.0108 
   ENGLISH DAVE       ESMARELDA        FABIENNE      FOURTH MAN       GAWKER #2 
         0.0105          0.0070          0.0096          0.0104          0.0097 
    HONEY BUNNY          JIMMIE            JODY           JULES           LANCE 
         0.0114          0.0093          0.0093          0.0132          0.0093 
        MANAGER       MARSELLUS          MARVIN         MAYNARD             MIA 
         0.0111          0.0104          0.0103          0.0098          0.0115 
         MOTHER          PATRON      PEDESTRIAN        PREACHER         PUMPKIN 
         0.0125          0.0111          0.0097          0.0097          0.0114 
         RAQUEL           ROGER SPORTSCASTER #1 SPORTSCASTER #2        THE GIMP 
         0.0105          0.0125          0.0096          0.0057          0.0073 
       THE WOLF         VINCENT        WAITRESS         WINSTON           WOMAN 
         0.0056          0.0139          0.0083          0.0105          0.0125 
      YOUNG MAN     YOUNG WOMAN             ZED 
         0.0083          0.0083          0.0073 </code></pre>
</div>
</div>
<p>Once we have the closeness centrality values, we are interested in who are the top nodes. The following code creates a table with the top five:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>   <span class="fu">library</span>(kableExtra)</span>
<span id="cb32-2"><a href="#cb32-2"></a>   close2 <span class="ot">&lt;-</span> <span class="fu">sort</span>(close2, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>   close2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(close2[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb32-4"><a href="#cb32-4"></a>   <span class="fu">kbl</span>(close2, <span class="at">format =</span> <span class="st">"pipe"</span>, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>),</span>
<span id="cb32-5"><a href="#cb32-5"></a>       <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Character"</span>, <span class="st">"Closeness"</span>),</span>
<span id="cb32-6"><a href="#cb32-6"></a>       <span class="at">caption =</span> <span class="st">"Top Five Closeness Characters in Pulp Fiction Network."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7"></a>   <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>Top Five Closeness Characters in Pulp Fiction Network.</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Character </th>
   <th style="text-align:left;"> Closeness </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> BUTCH </td>
   <td style="text-align:left;"> 0.0143 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> VINCENT </td>
   <td style="text-align:left;"> 0.0139 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> JULES </td>
   <td style="text-align:left;"> 0.0132 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRETT </td>
   <td style="text-align:left;"> 0.0125 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> CAPT KOONS </td>
   <td style="text-align:left;"> 0.0125 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>It makes sense that the three main characters are also the ones that are at closest distances from everyone else!</p>
</section>
<section id="edge-closeness" class="level2">
<h2 class="anchored" data-anchor-id="edge-closeness">Edge Closeness</h2>
<p><span class="citation" data-cites="brohl_lehnertz22">Bröhl and Lehnertz (<a href="#ref-brohl_lehnertz22" role="doc-biblioref">2022</a>)</span> define the closeness of an edge as a function of the closeness of the two nodes incident to it. An edge <span class="math inline">\(e_{jk}\)</span> linking vertex <span class="math inline">\(v_j\)</span> to <span class="math inline">\(v_k\)</span> has high closeness whenever vertices <span class="math inline">\(v_j\)</span> and <span class="math inline">\(v_k\)</span> also have high closeness.</p>
<p>More specifically, the closeness centrality of an edge is proportional to the ratio of the product of the closeness of the two nodes incident to it divided by their sum:</p>
<p><span class="math display">\[
C(e_{jk}) = (E - 1)\frac{C(v_j) \times C(v_k)}{C(v_j)+C(v_k)}
\]</span></p>
<p>Note that the equation normalizes the ratio of the product to the sum of the vertex closeness centralities by the number of edges minus one.</p>
<p>To compute edge closeness in a real network, we can use the same approach to data wrangling we used to compute the degree correlation in Handout 1. The goal is to create an edge list data frame containing five columns. The ids of the two nodes in the edge, the closeness centralities of the two nodes in the edge, and the closeness centrality of the edge calculated according to the above equation.</p>
<p>In the <em>Pulp Fiction</em> network this looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>   <span class="fu">library</span>(dplyr)</span>
<span id="cb33-2"><a href="#cb33-2"></a>   g.el <span class="ot">&lt;-</span> <span class="fu">as_edgelist</span>(g) <span class="co">#transforming graph to edgelist</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>   c <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">closeness</span>(g), <span class="dv">3</span>)  <span class="co">#closeness centrality vector</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>   c.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name1 =</span> <span class="fu">names</span>(c), <span class="at">name2 =</span> <span class="fu">names</span>(c), c)</span>
<span id="cb33-5"><a href="#cb33-5"></a>   el.temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name2 =</span> g.el[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb33-6"><a href="#cb33-6"></a>      <span class="fu">left_join</span>(c.dat, <span class="at">by =</span> <span class="st">"name2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-7"><a href="#cb33-7"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"name2"</span>, <span class="st">"c"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8"></a>      <span class="fu">rename</span>(<span class="at">c2 =</span> c) </span>
<span id="cb33-9"><a href="#cb33-9"></a>   c.el <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name1 =</span> g.el[, <span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="#cb33-10"></a>      <span class="fu">left_join</span>(c.dat, <span class="at">by =</span> <span class="st">"name1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-11"><a href="#cb33-11"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"name1"</span>, <span class="st">"c"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-12"><a href="#cb33-12"></a>      <span class="fu">rename</span>(<span class="at">c1 =</span> c) <span class="sc">%&gt;%</span> </span>
<span id="cb33-13"><a href="#cb33-13"></a>      <span class="fu">cbind</span>(el.temp) <span class="sc">%&gt;%</span> </span>
<span id="cb33-14"><a href="#cb33-14"></a>      <span class="fu">mutate</span>(<span class="at">e.clos =</span> <span class="fu">round</span>((<span class="fu">ecount</span>(g)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(c1<span class="sc">*</span>c2)<span class="sc">/</span>(c<span class="sc">+</span>c2), <span class="dv">3</span>))</span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="fu">head</span>(c.el)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name1    c1     name2    c2 e.clos
1 BRETT 0.013 MARSELLUS 0.010  0.571
2 BRETT 0.013    MARVIN 0.010  0.625
3 BRETT 0.013     ROGER 0.013  0.632
4 BRETT 0.013   VINCENT 0.014  0.681
5 BUDDY 0.011       MIA 0.011  0.555
6 BUDDY 0.011   VINCENT 0.014  0.622</code></pre>
</div>
</div>
<p>To create a table of the top five closeness centrality edges, we just order the data frame by the last column and table it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>   c.el <span class="ot">&lt;-</span> c.el[<span class="fu">order</span>(c.el<span class="sc">$</span>e.clos, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"name1"</span>, <span class="st">"name2"</span>, <span class="st">"e.clos"</span>))</span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a>   <span class="fu">kbl</span>(c.el[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ], <span class="at">format =</span> <span class="st">"pipe"</span>, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>),</span>
<span id="cb35-5"><a href="#cb35-5"></a>       <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"i"</span>, <span class="st">"j"</span>, <span class="st">"Edge Clos."</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-6"><a href="#cb35-6"></a>       <span class="at">caption =</span> <span class="st">"Edges Sorted by Closeness in the Pulp Fiction Network"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7"></a>   <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>Edges Sorted by Closeness in the Pulp Fiction Network</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> i </th>
   <th style="text-align:left;"> j </th>
   <th style="text-align:center;"> Edge Clos. </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> BUTCH </td>
   <td style="text-align:left;"> VINCENT </td>
   <td style="text-align:center;"> 0.900 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRETT </td>
   <td style="text-align:left;"> BUTCH </td>
   <td style="text-align:center;"> 0.875 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MOTHER </td>
   <td style="text-align:left;"> VINCENT </td>
   <td style="text-align:center;"> 0.875 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BUTCH </td>
   <td style="text-align:left;"> MIA </td>
   <td style="text-align:center;"> 0.864 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> JULES </td>
   <td style="text-align:left;"> PUMPKIN </td>
   <td style="text-align:center;"> 0.850 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Interestingly, the top closeness edges tend to bring somewhat strange bedfellows, characters that themselves don’t spend much time together in the film (e.g., the Butch/Vincent interaction is relatively brief and somewhat embarrassing for Vincent) but who themselves can reach other character clusters in the film via relatively short paths.</p>
</section>
<section id="closeness-centrality-in-directed-graphs" class="level2">
<h2 class="anchored" data-anchor-id="closeness-centrality-in-directed-graphs">Closeness Centrality in Directed Graphs</h2>
<p>What about closeness centrality for a directed network? Let us see how this works using a <strong>subgraph</strong> of the advice network, this time selecting just women under the age of forty:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>   women <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(law_advice)<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>   wg <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(law_advice, women)</span>
<span id="cb36-3"><a href="#cb36-3"></a>   young <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(wg)<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">40</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a>   wg <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(wg, young)</span>
<span id="cb36-5"><a href="#cb36-5"></a>   <span class="fu">V</span>(wg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 12/12 vertices, from cbfef19:
 [1]  1  2  3  4  5  6  7  8  9 10 11 12</code></pre>
</div>
</div>
<p>This network is small enough that a plot could be informative about its structure. Let us plot it using the package <code>ggraph</code>, a visualization package that follows the same principles as the <code>ggplot</code> grammar of graphics but for network graphs (see <a href="https://exts.ggplot2.tidyverse.org/ggraph.html">here</a>).</p>
<div class="cell" data-fig-cap-location="margin">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>   <span class="co">#install.packages("ggraph")</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>   <span class="fu">library</span>(ggraph)</span>
<span id="cb38-3"><a href="#cb38-3"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(wg, <span class="at">layout =</span> <span class="st">'auto'</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_edge_parallel</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">edge_width =</span> <span class="fl">0.5</span>,</span>
<span id="cb38-5"><a href="#cb38-5"></a>                                <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">'mm'</span>)),</span>
<span id="cb38-6"><a href="#cb38-6"></a>                                <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">4</span>, <span class="st">'mm'</span>), </span>
<span id="cb38-7"><a href="#cb38-7"></a>                                <span class="at">sep =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">'mm'</span>))</span>
<span id="cb38-8"><a href="#cb38-8"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"tan2"</span>) </span>
<span id="cb38-9"><a href="#cb38-9"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(wg)), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb38-10"><a href="#cb38-10"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_graph</span>() </span>
<span id="cb38-11"><a href="#cb38-11"></a>    p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Women lawyers advice network</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Now a question we might ask is who has the greatest closeness centrality in this advice network. We could proceed as usual and compute the geodesic distances between actors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">distances</span>(wg)</span>
<span id="cb39-2"><a href="#cb39-2"></a>   S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
 [1,]    0    1    2    1    3    3    4    2    2     3     3     3
 [2,]    1    0    2    1    2    3    3    1    1     3     3     3
 [3,]    2    2    0    1    1    1    2    2    3     1     1     1
 [4,]    1    1    1    0    2    2    3    2    2     2     2     2
 [5,]    3    2    1    2    0    1    1    1    2     2     2     2
 [6,]    3    3    1    2    1    0    2    2    3     1     2     1
 [7,]    4    3    2    3    1    2    0    2    3     3     3     3
 [8,]    2    1    2    2    1    2    2    0    1     3     3     3
 [9,]    2    1    3    2    2    3    3    1    0     4     4     4
[10,]    3    3    1    2    2    1    3    3    4     0     1     1
[11,]    3    3    1    2    2    2    3    3    4     1     0     1
[12,]    3    3    1    2    2    1    3    3    4     1     1     0</code></pre>
</div>
</div>
<p>Note that this is not quite right. In <code>igraph</code> the default settings of the distance function treats the graph as undirected. So it doesn’t use the strict <strong>directed paths</strong>, but it just treats them all as <strong>semi-paths</strong> ignoring direction. That is why, for instance, it counts node 1 as being “adjacent” to node 4 even though there is only one incoming link from 4 to 1 and why the whole matrix is symmetric, when we know from just eyeballing the network that there is a lot of asymmetry in terms of who can reach who via directed paths.</p>
<p>To get the actual directed distance matrix, we need to specify the “mode” option, asking whether we want in or out paths. Here, let’s select out-paths:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">distances</span>(wg, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>   S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
 [1,]    0    1  Inf  Inf  Inf  Inf  Inf  Inf  Inf   Inf   Inf   Inf
 [2,]    1    0  Inf  Inf  Inf  Inf  Inf  Inf  Inf   Inf   Inf   Inf
 [3,]    2    2    0    1  Inf    1  Inf  Inf  Inf   Inf   Inf   Inf
 [4,]    1    1    1    0  Inf    2  Inf  Inf  Inf   Inf   Inf   Inf
 [5,]    3    2    1    2    0    1    1    1    2   Inf   Inf   Inf
 [6,]    3    3    1    2  Inf    0  Inf  Inf  Inf   Inf   Inf   Inf
 [7,]    4    3    2    3    1    2    0    2    3   Inf   Inf   Inf
 [8,]    2    1  Inf  Inf  Inf  Inf  Inf    0    1   Inf   Inf   Inf
 [9,]    2    1  Inf  Inf  Inf  Inf  Inf    1    0   Inf   Inf   Inf
[10,]    3    3    1    2  Inf    1  Inf  Inf  Inf     0     1     2
[11,]    3    3    1    2  Inf    2  Inf  Inf  Inf     1     0     1
[12,]    3    3    1    2  Inf    1  Inf  Inf  Inf     1     1     0</code></pre>
</div>
</div>
<p>This is better but introduces a problem. The directed graph is not <strong>strongly connected</strong>, so it means that some nodes cannot reach other ones via a directed path of <em>any</em> length. That means that the <strong>geodesic distances</strong> from a node to an unreachable node is coded as “infinite” (Inf). The problem with infinity is that it gets in the way of calculating sums of distances, a requirement for the closeness centrality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">distances</span>(wg, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>   <span class="fu">rowSums</span>(S)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf</code></pre>
</div>
</div>
<p>Adding infinity to a number just returns infinity so all the rows with at least one “Inf” in the distance matrix get an Inf for the row sum. In this case that’s all of them. A bummer.</p>
<section id="harmonic-centrality" class="level3">
<h3 class="anchored" data-anchor-id="harmonic-centrality">Harmonic Centrality</h3>
<p>But dont’ worry there’s a <a href="https://olizardo.github.io/networks-textbook/lesson-sna-closeness.html#houston-we-have-a-problem">patch</a>. It is called the <strong>harmonic centrality</strong> <span class="citation" data-cites="rochat09">(<a href="#ref-rochat09" role="doc-biblioref">Rochat 2009</a>)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This is a variation on the closeness centrality that works whether you are working with connected or disconnected graphs (or in the case of directed graphs regardless of whether the graph is strongly or weakly connected), and therefore regardless of whether the geodesic distance matrix contains Infs.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The main difference between the harmonic and regular closeness centrality is that instead of calculating the inverse of the sum of the distances for each node, we calculate the <em>sum of the inverses</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>   S <span class="ot">&lt;-</span> <span class="fu">distances</span>(wg, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>   S <span class="ot">=</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>S, <span class="dv">2</span>) </span>
<span id="cb45-3"><a href="#cb45-3"></a>   <span class="fu">diag</span>(S) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#setting diagonals to zero</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>   S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
 [1,] 0.00 1.00  0.0 0.00    0  0.0    0  0.0 0.00     0     0   0.0
 [2,] 1.00 0.00  0.0 0.00    0  0.0    0  0.0 0.00     0     0   0.0
 [3,] 0.50 0.50  0.0 1.00    0  1.0    0  0.0 0.00     0     0   0.0
 [4,] 1.00 1.00  1.0 0.00    0  0.5    0  0.0 0.00     0     0   0.0
 [5,] 0.33 0.50  1.0 0.50    0  1.0    1  1.0 0.50     0     0   0.0
 [6,] 0.33 0.33  1.0 0.50    0  0.0    0  0.0 0.00     0     0   0.0
 [7,] 0.25 0.33  0.5 0.33    1  0.5    0  0.5 0.33     0     0   0.0
 [8,] 0.50 1.00  0.0 0.00    0  0.0    0  0.0 1.00     0     0   0.0
 [9,] 0.50 1.00  0.0 0.00    0  0.0    0  1.0 0.00     0     0   0.0
[10,] 0.33 0.33  1.0 0.50    0  1.0    0  0.0 0.00     0     1   0.5
[11,] 0.33 0.33  1.0 0.50    0  0.5    0  0.0 0.00     1     0   1.0
[12,] 0.33 0.33  1.0 0.50    0  1.0    0  0.0 0.00     1     1   0.0</code></pre>
</div>
</div>
<p>Note that in this matrix of inverse distances, the closest (adjacent) nodes get the maximum score of one, and nodes farther apart when smaller scores (approaching zero). More importantly, those pesky Infs disappear (!) because unreachable directed pairs of nodes get the lowest score, corresponding to <span class="math inline">\(1/\infty = 0\)</span>. Turns out the mathematics of infinity weren’t our enemy after all.</p>
<p>Also note that the reachability relation expressed in this matrix is asymmetric: So node 4 and reach node 1 (there is a directed tie from 4 to 1), but node 1 cannot reach 4. This is precisely what we want.</p>
<p>Once we have this matrix of inverse distances, we can then we can compute the harmonic centrality the same way as regular closeness by adding up the row scores for each node and dividing by the number of nodes minus one (to get the average):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>   d.harm <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(S)</span>
<span id="cb47-2"><a href="#cb47-2"></a>   d.harm <span class="ot">&lt;-</span> d.harm<span class="sc">/</span>(<span class="fu">vcount</span>(wg) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb47-3"><a href="#cb47-3"></a>   d.harm <span class="ot">&lt;-</span> <span class="fu">round</span>(d.harm, <span class="dv">2</span>)</span>
<span id="cb47-4"><a href="#cb47-4"></a>   d.harm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.09 0.09 0.27 0.32 0.53 0.20 0.34 0.23 0.23 0.42 0.42 0.47</code></pre>
</div>
</div>
<p>We can see that the highest harmonic closeness centrality node is 5, followed by 12. Here’s a plot of the network highlighting the highest harmonic (closeness) centrality node.</p>
<div class="cell" data-fig-cap-location="margin">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>   col <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"tan2"</span>, <span class="fu">vcount</span>(wg)) <span class="co">#creating node color vector</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>   col[<span class="fu">which</span>(d.harm <span class="sc">==</span> <span class="fu">max</span>(d.harm))] <span class="ot">&lt;-</span> <span class="st">"red"</span> <span class="co">#changing color of max centrality node to red</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> col)</span>
<span id="cb49-4"><a href="#cb49-4"></a>   p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(wg)), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb49-5"><a href="#cb49-5"></a>   p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Women lawyers advice network with highest closeness centrality node in red</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Of course, <code>igraph</code> has a built in function to calculate the harmonic centrality called (you guessed it) <code>harmonic_centrality</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>   d.harm <span class="ot">&lt;-</span> <span class="fu">harmonic_centrality</span>(wg, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>   d.harm <span class="ot">&lt;-</span> <span class="fu">round</span>(d.harm, <span class="dv">2</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a>   d.harm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.09 0.09 0.27 0.32 0.53 0.20 0.34 0.23 0.23 0.42 0.42 0.47</code></pre>
</div>
</div>
<p>Which gives us the same results.</p>
</section>
</section>
<section id="betweenness" class="level2">
<h2 class="anchored" data-anchor-id="betweenness">Betweenness</h2>
<p>We finally come to betweenness centrality. Recall that the key conceptual distinction between closeness and betweenness according to <span class="citation" data-cites="freeman79">Freeman (<a href="#ref-freeman79" role="doc-biblioref">1979</a>)</span> is that between (pun intended) the capacity to reach others quickly (e.g., via the shortest paths) and the capacity to <em>intermediate</em> among those same paths. High betweenness nodes control the flow of information in the network between other nodes.</p>
<p>This is evident in the way betweenness is calculated. Recall that the betweenness of a node <em>k</em> relative to any pair of nodes <em>i</em> and <em>j</em> in the network is simply:</p>
<p><span class="math display">\[
\frac{\sigma_{i(k)j}}{\sigma_{ij}}
\]</span></p>
<p>Where the denominator of the fraction (<span class="math inline">\(\sigma_{ij}\)</span>) is a count of the <em>total</em> number of shortest paths that start and end with nodes <em>i</em> and <em>j</em> and the numerator of the fraction (<span class="math inline">\(\sigma_{i(k)j}\)</span>) is the subset of those paths that include node <em>k</em> as an <strong>inner node</strong>.</p>
<p>As <span class="citation" data-cites="freeman79">Freeman (<a href="#ref-freeman79" role="doc-biblioref">1979</a>)</span> also notes because this is a ratio, it can range from zero to one, with everything in between. As such the betweenness centrality of a node relative to any two others has an intuitive interpretation as a <em>probability</em>, namely the probability that if you send something from <em>i</em> to <em>j</em> it has to go <em>through</em> <em>k</em>. This probability is 1.0 if <em>k</em> stands in <em>every</em> shortest path between <em>i</em> and <em>j</em> and zero if they stand in none of the shortest paths indirectly connecting <em>i</em> and <em>j</em>.</p>
<p>The betweenness of a given node is just the sum all of these probabilities across every pair of nodes in the graph for each node:</p>
<p><span class="math display">\[
\sum_{i \neq j, i \neq n, j \neq v} \frac{\sigma_{i(k)j}}{\sigma_{ij}}
\]</span></p>
<p>Below we can see a point and line diagram of the undirectd <em>Pulp Fiction</em> network we have been working with.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Pulp Fiction character schene co-appearance network.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We should expect a character to have high betweenness in this network to the extent that they appear in scenes with characters who themselves don’t appear in any scenes together, thus inter-mediating between different parts of the story. Characters who only appear in one scene with some others (like The Wolf or The Gimp) are likely to be low in betweenness.</p>
<p>Let’s create a top ten table of betweenness for the <em>Pulp Fiction</em> network. We use the <code>igraph</code> function <code>betweenness</code> to calculate the scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>   pulp.bet <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(g)</span>
<span id="cb52-2"><a href="#cb52-2"></a>   top.<span class="fl">5.</span>bet <span class="ot">&lt;-</span> <span class="fu">sort</span>(pulp.bet, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb52-3"><a href="#cb52-3"></a>   <span class="fu">kbl</span>(<span class="fu">round</span>(top.<span class="fl">5.</span>bet, <span class="dv">2</span>), <span class="at">format =</span> <span class="st">"pipe"</span>, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>),</span>
<span id="cb52-4"><a href="#cb52-4"></a>       <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Character"</span>, <span class="st">"Betweenness"</span>),</span>
<span id="cb52-5"><a href="#cb52-5"></a>       <span class="at">caption =</span> <span class="st">"Top Five Betweenness Characters in Pulp Fiction Network."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6"></a>   <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>Top Five Betweenness Characters in Pulp Fiction Network.</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Character </th>
   <th style="text-align:left;"> Betweenness </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> BUTCH </td>
   <td style="text-align:left;"> 275.52 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> VINCENT </td>
   <td style="text-align:left;"> 230.19 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> JULES </td>
   <td style="text-align:left;"> 142.11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MIA </td>
   <td style="text-align:left;"> 76.68 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MAYNARD </td>
   <td style="text-align:left;"> 70.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> HONEY BUNNY </td>
   <td style="text-align:left;"> 49.97 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> PUMPKIN </td>
   <td style="text-align:left;"> 49.97 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> SPORTSCASTER #1 </td>
   <td style="text-align:left;"> 36.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRETT </td>
   <td style="text-align:left;"> 29.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> PREACHER </td>
   <td style="text-align:left;"> 28.23 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Unsurprisingly, the top four characters are also the highest in betweenness. Somewhat surprisingly, the main antagonist of the story (the pawn shop owner) is also up there. After that we see a steep drop in the bottom five of the top ten.</p>
<p>Now let us examine betweenness centrality in our directed women lawyers advice network:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>   w.bet <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(wg)</span>
<span id="cb53-2"><a href="#cb53-2"></a>   w.bet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.0000000  3.0000000 16.3333333 11.0000000  7.0000000  0.0000000
 [7]  0.0000000  5.0000000  0.0000000  0.3333333  1.0000000  0.3333333</code></pre>
</div>
</div>
<p>Here we see that node 3 is the highest in betweenness, pictured below:</p>
<div class="cell" data-fig-cap-location="margin">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Women lawyers advice network with highest closeness centrality node in blue and highest betweenness centrality node in red</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>This result makes sense. Node 3 intermediates all the connections linking the tightly knit group of nodes on the left side (6, 10, 11, 12) with the rest of the network. Also if nodes 5 and 7 need to pass something along to the rest, they have to use 3 at least half time. Node 4 also needs 3 to reach 6.</p>
<p>This result nicely illustrates the difference between closeness and betweenness.</p>
</section>
<section id="edge-betweenness" class="level2">
<h2 class="anchored" data-anchor-id="edge-betweenness">Edge Betweenness</h2>
<p>Edge betweenness is defined in similar fashion as node betweenness:</p>
<p><span class="math display">\[
\sum_{i \neq j} \frac{\sigma_{i(e)j}}{\sigma_{ij}}
\]</span></p>
<p>Where <span class="math inline">\(\sigma_{i(e)j}\)</span> is a count of the number of shortest paths between <em>i</em> and <em>j</em> that feature edge <em>e</em> as an intermediary link. This tells us that the betweenness of an edge <em>e</em> is the sum of the ratios of the number of times that edge appears in the middle of a shortest path connecting every pair of nodes in the graph <em>i</em> and <em>j</em> divided by the total number of shortest paths linking each pair of nodes.</p>
<p>Like before, the edge betweenness with respect to a specific pair of nodes in the graph is a probability: Namely, that if you send something–using a shortest path–from any node <em>i</em> to any other node <em>j</em> it has to go through edge <em>e</em>. The resulting edge betweenness scores is the sum of these probabilities across every possible pair of nodes for each edge in the graph.</p>
<p>For this example, we will work with a simplified version of the women lawyers advice network, in which we transform it into an <strong>undirected</strong> graph. We use the <code>igraph</code> function <code>as.undirected</code> for that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>   wg <span class="ot">&lt;-</span> <span class="fu">as.undirected</span>(wg, <span class="at">mode =</span> <span class="st">"collapse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The “collapse” value in the “mode” argument tells <code>as.undirected</code> to link every connected dyad in the original directed graph using an undirected edge. It does that by removing the directional arrow of the single directed links and collapsing (hence the name) all the bi-directional links into a single undirected one.</p>
<p>The resulting undirected graph looks like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="handout2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at this point and line plot of the women lawyers advice network, which edge do you think has the top betweenness?</p>
<p>Well no need to figure that out via eyeballing! We can just use the <code>igraph</code> function <code>edge_betweenness</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>   w.ebet <span class="ot">&lt;-</span> <span class="fu">edge_betweenness</span>(wg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>edge_betweenness</code> function takes the <code>igraph</code> graph object as input and produces a vector of edge betweenness values of the same length as the number of edges in the graph, which happens to be 20 in this case.</p>
<p>Using this information, we can then create a table of the top ten edges ordered by betweenness:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>   edges <span class="ot">&lt;-</span> <span class="fu">as_edgelist</span>(wg) <span class="co">#creating an edgelist</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>   etab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edges, <span class="at">bet =</span> <span class="fu">round</span>(w.ebet, <span class="dv">2</span>)) <span class="co">#adding bet. scores to edgelist</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>   etab <span class="ot">&lt;-</span> etab[<span class="fu">order</span>(etab<span class="sc">$</span>bet, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ] <span class="co">#ordering by bet.</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>   <span class="fu">kbl</span>(etab[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], <span class="at">format =</span> <span class="st">"pipe"</span>, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>),</span>
<span id="cb57-5"><a href="#cb57-5"></a>       <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"i"</span>, <span class="st">"j"</span>, <span class="st">"Edge Bet."</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb57-6"><a href="#cb57-6"></a>       <span class="at">caption =</span> <span class="st">"Edges Sorted by Betweenness in the Women Lawyers Advice Network"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-7"><a href="#cb57-7"></a>   <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>Edges Sorted by Betweenness in the Women Lawyers Advice Network</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> i </th>
   <th style="text-align:left;"> j </th>
   <th style="text-align:center;"> Edge Bet. </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:center;"> 19.17 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:center;"> 15.83 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:center;"> 13.67 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:center;"> 11.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:center;"> 9.17 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:center;"> 8.33 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:center;"> 8.17 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:center;"> 7.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:center;"> 6.50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:center;"> 6.33 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Not surprisingly, the top edges are the ones linking nodes 3 and 4 and nodes 5 and 8.</p>
<section id="disconnecting-a-graph-via-bridge-removal" class="level3">
<h3 class="anchored" data-anchor-id="disconnecting-a-graph-via-bridge-removal">Disconnecting a Graph Via Bridge Removal</h3>
<p>High betweenness edges are likely to function as <strong>bridges</strong> being the only point of indirect connectivity between most nodes in the social structure. That means that an easy way to disconnect a connected graph is to remove the bridges <span class="citation" data-cites="girvan_newman02">(<a href="#ref-girvan_newman02" role="doc-biblioref">Girvan and Newman 2002</a>)</span>.</p>
<p>In <code>igraph</code> we can produce an <strong>edge deleted subgraph</strong> of an original graph using the “minus” operator, along with the <code>edge</code> function like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>   del.g <span class="ot">&lt;-</span> wg <span class="sc">-</span> <span class="fu">edge</span>(<span class="st">"3|4"</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>   del.g <span class="ot">&lt;-</span> del.g <span class="sc">-</span> <span class="fu">edge</span>(<span class="st">"5|8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first line creates a new graph object (a subgraph) which equals the original graph minus the edge linking nodes 3 and 4. The second line takes this last subgraph and further deletes the edge linking nodes 5 and 8.</p>
<p>The resulting subgraph, minus the top two high-betweenness edges, looks like:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="handout2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which is indeed disconnected!</p>
</section>
</section>
<section id="induced-betweenness" class="level2">
<h2 class="anchored" data-anchor-id="induced-betweenness">Induced Betweenness</h2>
<p>In the assigned handbook chapter reading, Borgatti and Everett argue that another way of thinking about centrality of a node (or edge) is to calculate the difference that <em>removing</em> that node makes for some graph property in the network. They further suggest that the sum of the centrality scores of each node is just such a property, proposing that betweenness is particularly interesting in this regard. Let’s see how this works.</p>
<p>We will use the undirected version of the women lawyers advice network for this example. Let’s say we are interested in the difference that node 10 makes for the betweenness centralities of everyone else. In that case we would proceed as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>   bet <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(wg) <span class="co">#original centrality scores</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>   Sbet <span class="ot">&lt;-</span> <span class="fu">sum</span>(bet) <span class="co">#sum of original centrality scores</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>   wg.d <span class="ot">&lt;-</span> wg <span class="sc">-</span> <span class="fu">vertex</span>(<span class="st">"10"</span>) <span class="co">#removing vertex 10 from the graph</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>   bet.d <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(wg.d) <span class="co">#centrality scores of node deleted subgraph</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>   Sbet.d <span class="ot">&lt;-</span> <span class="fu">sum</span>(bet.d) <span class="co">#sum of centrality scores of node deleted subgraph</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>   total.c <span class="ot">&lt;-</span> Sbet <span class="sc">-</span> Sbet.d <span class="co">#total centrality</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>   indirect.c <span class="ot">&lt;-</span> total.c <span class="sc">-</span> bet[<span class="dv">10</span>] <span class="co">#indirect centrality</span></span>
<span id="cb59-8"><a href="#cb59-8"></a>   indirect.c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.66667</code></pre>
</div>
</div>
<p>Line 1 just calculates the regular betweenness centrality vector for the graph. Line 2 sums up all of the entries of this vector. Line 3 creates a node deleted subgraph by removing node 10. This is done using the “minus” operator and the <code>igraph</code> function <code>vertex</code>, which works just like the <code>edge</code> function we used earlier to create an edge deleted subgraph, except it takes a node id or name as input.</p>
<p>Lines 4-5 just recalculate the sum of betweenness centralities in the subgraph that excludes node 10. Then in line 6 we subtract the sum of centralities of the node deleted subgraph from the sum of centralities of the original graph. If this number, which Borgatti and Everett call the “total” centrality, is large and positive then that means that node 10 makes a difference for the centrality of others.</p>
<p>However, part of that difference is node 10’s own “direct” centrality, so to get a more accurate sense of node 10’s impact on other people’s centrality we need to subtract node 10’s direct centrality from the total number, which we do in line 7 to get node 10’s “indirect” centrality. The result is shown in the last line, which indicates that node 10 has a pretty big impact on other people’s betweenness centralities, net of their own (which is pretty small).</p>
<p>Now all we need to do is do the same for each node to create a vector of indirect betweenness centralities. So we incorporate the code above into a short loop through all vertices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>   total.c <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#empty vector</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>   indirect.c <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#empty vector</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(wg)) {</span>
<span id="cb61-4"><a href="#cb61-4"></a>      wg.d <span class="ot">&lt;-</span> wg <span class="sc">-</span> <span class="fu">vertex</span>(i)</span>
<span id="cb61-5"><a href="#cb61-5"></a>      bet.d <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(wg.d) <span class="co">#centrality scores of node deleted subgraph</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>      Sbet.d <span class="ot">&lt;-</span> <span class="fu">sum</span>(bet.d) <span class="co">#sum of centrality scores of node deleted subgraph</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>      total.c[i] <span class="ot">&lt;-</span> Sbet <span class="sc">-</span> Sbet.d <span class="co">#total centrality</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>   indirect.c[i] <span class="ot">&lt;-</span> total.c[i] <span class="sc">-</span> bet[i] <span class="co">#total minus direct</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now list the total, direct, and indirect betweenness centralities for the women lawyers graph using a nice table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>   i.bet <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(wg), total.c, <span class="fu">round</span>(<span class="fu">betweenness</span>(wg), <span class="dv">1</span>), <span class="fu">round</span>(indirect.c, <span class="dv">1</span>))</span>
<span id="cb62-2"><a href="#cb62-2"></a>   <span class="fu">kbl</span>(i.bet, <span class="at">format =</span> <span class="st">"pipe"</span>, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb62-3"><a href="#cb62-3"></a>       <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Node"</span>, <span class="st">"Total"</span>, <span class="st">"Direct"</span>, <span class="st">"Indirect"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-4"><a href="#cb62-4"></a>       <span class="at">caption =</span> <span class="st">"Induced Betweenness Scores in the Women Lawyers Advice Network"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5"></a>   <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>Induced Betweenness Scores in the Women Lawyers Advice Network</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Node </th>
   <th style="text-align:center;"> Total </th>
   <th style="text-align:center;"> Direct </th>
   <th style="text-align:center;"> Indirect </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:center;"> 16 </td>
   <td style="text-align:center;"> 0.0 </td>
   <td style="text-align:center;"> 16.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 6.7 </td>
   <td style="text-align:center;"> -2.7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:center;"> -24 </td>
   <td style="text-align:center;"> 23.2 </td>
   <td style="text-align:center;"> -47.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:center;"> -4 </td>
   <td style="text-align:center;"> 12.2 </td>
   <td style="text-align:center;"> -16.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:center;"> 19 </td>
   <td style="text-align:center;"> 18.8 </td>
   <td style="text-align:center;"> 0.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 3.7 </td>
   <td style="text-align:center;"> 6.3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:center;"> 18 </td>
   <td style="text-align:center;"> 0.0 </td>
   <td style="text-align:center;"> 18.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 8.8 </td>
   <td style="text-align:center;"> -4.8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 9 </td>
   <td style="text-align:center;"> 18 </td>
   <td style="text-align:center;"> 0.0 </td>
   <td style="text-align:center;"> 18.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:center;"> 13 </td>
   <td style="text-align:center;"> 0.3 </td>
   <td style="text-align:center;"> 12.7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:center;"> 14 </td>
   <td style="text-align:center;"> 0.0 </td>
   <td style="text-align:center;"> 14.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:center;"> 13 </td>
   <td style="text-align:center;"> 0.3 </td>
   <td style="text-align:center;"> 12.7 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>This approach to decomposing betweenness centrality provides a new way to categorize actors in a network:</p>
<ul>
<li><p>On the one hand, we have actors like nodes 3 and 4 who “hog” centrality from others. Perhaps these are the prototypical high betweenness actors who monopolize the flow through the network. Their own direct centrality is high, but their indirect centrality is negative, suggesting that others become <em>more</em> central when they are removed from the graph as they can now become intermediaries themselves.</p></li>
<li><p>In contrast, we also have actors like node 5 who are high centrality themselves, but who’s removal from the network does not affect anyone else’s centrality. These actors are high betweenness but themselves don’t monopolize the flow of information in the network.</p></li>
<li><p>Then we have actors (like nodes 9-12) who have low centrality, but whose removal from the network makes a positive difference for other people’s centrality, which overall <em>decreases</em> when they are removed from the network.</p></li>
<li><p>Finally, we have actors line nodes 2 and 8, who are not particularly central, but who also hog centrality from others, in that removing them from the network also increases other people’s centrality (although not such an extent as the hogs).</p></li>
</ul>
</section>
<section id="generalized-harmonic-centrality" class="level2">
<h2 class="anchored" data-anchor-id="generalized-harmonic-centrality">Generalized Harmonic Centrality</h2>
<p><span class="citation" data-cites="agneessens_etal17">Agneessens, Borgatti, and Everett (<a href="#ref-agneessens_etal17" role="doc-biblioref">2017</a>)</span> propose a “generalized” version of the harmonic centrality that yields plain old degree centrality and the regular harmonic centrality as special cases. The key is to introduce a parameter <span class="math inline">\(\delta\)</span> governing how much weight we give to shortest paths based on distance. Let’s see how this works.</p>
<p>Recall that the harmonic centrality we defined earlier is given by:</p>
<p><span class="math display">\[
\frac{\sum_{j \neq i} (g_{ij})^{-1}}{n-1}
\]</span></p>
<p>Where <span class="math inline">\(g_{ij}\)</span> is the geodesic distance between nodes <em>i</em> and <em>j</em> which could be “infinite” if there is no path linking them.</p>
<p>Agneessens et al’s tweak is to instead compute:</p>
<p><span class="math display">\[
\frac{\sum_{j \neq i} (g_{ij})^{-\delta}}{n-1}
\]</span></p>
<p>Where <span class="math inline">\(\delta\)</span> is a free parameter chosen by the researcher with the restriction that <span class="math inline">\(\delta \geq 0\)</span> (if you want to calculate a closeness measure as we will see below).</p>
<p>When <span class="math inline">\(\delta = \infty\)</span> the numerator element <span class="math inline">\(1/(g_{ij})^{\infty} = 1\)</span> only when nodes are adjacent and <span class="math inline">\(g_{ij} = 1\)</span> (because <span class="math inline">\(1^{\infty} = 1\)</span>); otherwise, for <span class="math inline">\(g_{ij} &gt; 1\)</span> then <span class="math inline">\(1/(g_{ij})^{\infty} = 0\)</span>, and therefore the generalized harmonic centrality just becomes a (normalized) version of degree centrality. Alternatively, when <span class="math inline">\(\delta = 1\)</span> we just get the plain old harmonic centrality we defined earlier.</p>
<p>The interesting cases come from <span class="math inline">\(1 &gt; \delta &lt; \infty\)</span> and <span class="math inline">\(0 &gt; \delta &lt; 1\)</span>. In the first case, nodes at shorter distances are weighted more (like in the standard harmonic centrality measure) as <span class="math inline">\(\delta\)</span> becomes bigger and bigger then the generalized harmonic centrality approximates degree. For values below one, as <span class="math inline">\(\delta\)</span> approaches zero, then indirect connections to nodes of greater length are discounted less, and thus count for “more” in defining your generalized harmonic centrality score.</p>
<p>Let us see a real-world example of the generalized harmonic centrality in action:</p>
<p>First, we create a custom function to compute the generalized harmonic centrality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>   g.harm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, d) {</span>
<span id="cb63-2"><a href="#cb63-2"></a>      <span class="fu">library</span>(igraph)</span>
<span id="cb63-3"><a href="#cb63-3"></a>      S <span class="ot">&lt;-</span> <span class="fu">distances</span>(x) <span class="co">#get distances from graph object</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>      S <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>S<span class="sc">^</span>d <span class="co">#matrix of generalized inverse distances</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>      <span class="fu">diag</span>(S) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#set diagonals to zero</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>      c <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(S)<span class="sc">/</span>(<span class="fu">vcount</span>(x) <span class="sc">-</span> <span class="dv">1</span>) <span class="co">#summing and averaging</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>      <span class="fu">return</span>(c)</span>
<span id="cb63-8"><a href="#cb63-8"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Second, we compute three versions of the harmonic centrality, with <span class="math inline">\(\delta = 5\)</span>, <span class="math inline">\(\delta = 0.05\)</span>, and <span class="math inline">\(\delta = -5\)</span>, using the full (unrestricted by age) subgraph of the <code>law_advice</code> network composed of the women lawyers at the firm, with relations constrained to be undirected:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>   women <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(law_advice)<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a>   wg <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(law_advice, women)</span>
<span id="cb64-3"><a href="#cb64-3"></a>   wg <span class="ot">&lt;-</span> <span class="fu">as.undirected</span>(wg)</span>
<span id="cb64-4"><a href="#cb64-4"></a>   c1 <span class="ot">&lt;-</span> <span class="fu">g.harm</span>(wg, <span class="at">d =</span> <span class="dv">5</span>)</span>
<span id="cb64-5"><a href="#cb64-5"></a>   c2 <span class="ot">&lt;-</span> <span class="fu">g.harm</span>(wg, <span class="at">d =</span> <span class="fl">0.05</span>)</span>
<span id="cb64-6"><a href="#cb64-6"></a>   c3 <span class="ot">&lt;-</span> <span class="fu">g.harm</span>(wg, <span class="at">d =</span> <span class="sc">-</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>The first version of the harmonic centrality in line 5, with a positive value of <span class="math inline">\(\delta\)</span> above zero, will compute centrality scores emphasizing <em>direct</em> (one-step) connections, thus coming closer to <strong>degree</strong>.</p></li>
<li><p>The second version, in line 6, with a value of <span class="math inline">\(\delta\)</span> close to zero, will give comparatively more emphasis to <em>indirect</em> connections weighing longer paths almost as much as shorter paths (but always a little less), thus being more similar to <strong>closeness</strong> centrality.</p></li>
<li><p>Finally, the last version, in line 7, with <span class="math inline">\(\delta &lt; 0\)</span>, will weigh <em>longer</em> paths more than shorter ones, serving as a measure of <strong>eccentricity</strong> (farness from others) not closeness.</p></li>
</ul>
<div class="cell" data-fig-cap-location="margin">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Full women lawyers advice network</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Above is a plot of the women lawyers network showing the top node for each of the centralities:</p>
<ul>
<li><p>In red we have node 3 who has the largest degree (<span class="math inline">\(k(3) = 8\)</span>) and thus comes out on top using the generalized harmonic centrality version emphasizing direct connections (<span class="math inline">\(\delta &gt; 1\)</span>).</p></li>
<li><p>Then in blue we have node 9 who can reach the most others via the shortest paths, and thus comes out on top when the generalized harmonic centrality emphasizes indirect connectivity.</p></li>
<li><p>Finally, in purple we have node 12, which is <em>farthest</em> from everyone else, and thus comes out on “top” when longer indirect connections count for more (<span class="math inline">\(\delta &lt; 0)\)</span>.</p></li>
</ul>
<p>As we said earlier, both regular harmonic centrality and degree are special cases of the generalized measure. We can check this by setting <span class="math inline">\(\delta\)</span> to either one or infinity.</p>
<p>When we set <span class="math inline">\(\delta=1\)</span> the generalized harmonic centrality is the same as (normalized by number of nodes minus one) the regular harmonic centrality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>   <span class="fu">g.harm</span>(wg, <span class="at">d =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.5980392 0.5343137 0.7058824 0.5980392 0.6568627 0.6274510 0.4264706
 [8] 0.5392157 0.6960784 0.6470588 0.6666667 0.4068627 0.5882353 0.5196078
[15] 0.5833333 0.6029412 0.5588235 0.5441176</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>   <span class="fu">harmonic_centrality</span>(wg, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.5980392 0.5343137 0.7058824 0.5980392 0.6568627 0.6274510 0.4264706
 [8] 0.5392157 0.6960784 0.6470588 0.6666667 0.4068627 0.5882353 0.5196078
[15] 0.5833333 0.6029412 0.5588235 0.5441176</code></pre>
</div>
</div>
<p>When we set <span class="math inline">\(\delta=\infty\)</span> the generalized harmonic centrality is the same as (normalized by number of nodes minus one) degree centrality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>   <span class="fu">g.harm</span>(wg, <span class="at">d =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.23529412 0.17647059 0.47058824 0.23529412 0.35294118 0.29411765
 [7] 0.05882353 0.17647059 0.41176471 0.35294118 0.41176471 0.05882353
[13] 0.23529412 0.17647059 0.23529412 0.35294118 0.23529412 0.23529412</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>   <span class="fu">degree</span>(wg, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.23529412 0.17647059 0.47058824 0.23529412 0.35294118 0.29411765
 [7] 0.05882353 0.17647059 0.41176471 0.35294118 0.41176471 0.05882353
[13] 0.23529412 0.17647059 0.23529412 0.35294118 0.23529412 0.23529412</code></pre>
</div>
</div>
</section>
<section id="appendix-selecting-a-subgraph-based-on-edge-conditions" class="level2">
<h2 class="anchored" data-anchor-id="appendix-selecting-a-subgraph-based-on-edge-conditions">Appendix: Selecting a Subgraph Based on Edge Conditions</h2>
<p>A great question asked in class goes as follows: What if I want to create a subgraph based on selecting a subset of a nodes, and then the other nodes in the graph that are that set of node’s in-neighbors?</p>
<p>Let’s see how that would work.</p>
<p>First, we create a vector with the node ids of our <strong>focal nodes</strong>, which will be women under 40 in the <code>law_advice</code> network.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>   yw <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(law_advice)<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="fu">V</span>(law_advice)<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">40</span>)</span>
<span id="cb73-2"><a href="#cb73-2"></a>   yw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 29 34 39 48 51 57 59 60 61 67 69 71</code></pre>
</div>
</div>
<p>Second, we need to collect the node ids of the people who point to these set of nodes; that is, each of these node’s <strong>in-neighbors</strong>. For that, we use the <code>igraph</code> function <code>neighbors</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>   yw_in <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co">#creating empty list</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>   k <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#counter for list position</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>   <span class="cf">for</span> (i <span class="cf">in</span> yw) {</span>
<span id="cb75-4"><a href="#cb75-4"></a>      nei <span class="ot">&lt;-</span> <span class="fu">neighbors</span>(law_advice, i, <span class="at">mode =</span> <span class="st">"in"</span>) </span>
<span id="cb75-5"><a href="#cb75-5"></a>      nei <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(nei) <span class="co">#vector of in-neighbors ids</span></span>
<span id="cb75-6"><a href="#cb75-6"></a>      yw_in[[k]] <span class="ot">&lt;-</span> nei <span class="co">#adding to list</span></span>
<span id="cb75-7"><a href="#cb75-7"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> <span class="co">#incrementing counter</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Line one creates an (empty) <code>list</code> object in <code>R</code>. The beauty of a list object is that it is an object that can hold other objects (vectors, matrices, <code>igraph</code> graph objects, etc.) as members (it can also have other lists as members, with lists all the way down). For a primer on how to work with <code>R</code> lists see <a href="https://rstudio.github.io/r-manuals/r-intro/Lists-and-data-frames.html">here</a></p>
<p>The idea is to populate this initially empty list with the vectors of the in-neighbor ids of each node listed in the vector <code>yw</code>. Lines 2-8 do that using a simple <code>for</code> loop starring the <code>igraph</code> command <code>neighbors</code>, a function which takes two inputs: an <code>igraph</code> graph object, and a node id. The argument “mode” (“in” or “out” for directed graphs), tells it which kid of neighbors you want (not necessary for undirected graphs). Here we want the in-neighbors, so <code>mode</code> = “in”.</p>
<p>Now we have a <code>list</code> object in <code>R</code> of length equal to the number of younger women (12 in this case) with each entry equal to the ids of those women’s in-neighbors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>   <span class="fu">length</span>(yw_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>   <span class="fu">head</span>(yw_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1]  4 10 12 15 16 17 19 26 27 28 34 36 41 42 45 48 70

[[2]]
 [1]  7 10 12 13 14 15 16 17 19 22 26 27 28 29 33 36 42 44 45 46 48 56 60 61 64

[[3]]
 [1] 13 17 30 40 41 42 48 51 52 55 56 57 65 66 67 69 71

[[4]]
[1] 16 17 39 42

[[5]]
[1] 58 59

[[6]]
 [1] 27 39 41 51 55 56 62 65 66 67 71</code></pre>
</div>
</div>
<p>Now we need to create a vector of the unique ids of these nodes. To do this, we just to “unlist” all of the node ids to create a simple vector from the list object.</p>
<p>The <code>unlist</code> native <code>R</code> function does that for us, taking a list as input and returning all of the elements inside each of the separate objects stored in the list as output. Here we wrap that call in the <code>unique</code> native <code>R</code> function to eliminate repeats (common in-neighbors across women):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>   yw_in <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(yw_in))</span>
<span id="cb80-2"><a href="#cb80-2"></a>   yw_in</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 10 12 15 16 17 19 26 27 28 34 36 41 42 45 48 70  7 13 14 22 29 33 44 46
[26] 56 60 61 64 30 40 51 52 55 57 65 66 67 69 71 39 58 59 62 35</code></pre>
</div>
</div>
<p>Of course, because the younger women are their own in-neighbors, they are included in this vector, so we need to get rid of them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>   yw_in <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(yw_in, yw)</span>
<span id="cb82-2"><a href="#cb82-2"></a>   yw_in</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 10 12 15 16 17 19 26 27 28 36 41 42 45 70  7 13 14 22 33 44 46 56 64 30
[26] 40 52 55 65 66 58 62 35</code></pre>
</div>
</div>
<p>We use the native command <code>setdiff</code> to find the elements in vector yw_in that are not contained in the vector of young women ids yw or the difference between the set of nodes ids stored in yw_in and the set of node ids stored in yw.</p>
<p>Now that we have the vector of ids of the focal nodes and the vector of ids of their in-neighbors, we are ready to create our subgraph! All we need to do is specify we want <em>both</em> the younger law firm women and their in-neighbors in our node-induced subgraph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>   g <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(law_advice, <span class="fu">c</span>(yw, yw_in))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can even specify a new vertex attribute, differentiating the focal network from the in-neighbor network.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>   <span class="fu">V</span>(g)<span class="sc">$</span>net_status <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(yw)), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="fu">length</span>(<span class="fu">c</span>(yw, yw_in)) <span class="sc">-</span> <span class="fu">length</span>(yw)))</span>
<span id="cb85-2"><a href="#cb85-2"></a>   <span class="fu">vertex_attr</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$status
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2

$gender
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 2 1 2 1 1 2 1 1 2 1 1 1 2 1 2 2 2 1 1 1 2 1 2 2 2 1
[39] 2 1 1 2 2 1 2

$office
 [1] 1 2 1 1 1 2 3 1 1 1 1 1 1 2 1 2 2 1 2 1 1 1 1 1 3 1 2 1 2 1 1 1 1 2 2 1 1 1
[39] 1 1 1 1 1 1 1

$seniority
 [1] 31 29 25 24 22  1 21 20 23 19  9 15 13 11 10  7  8  8  8  5  6  6  5  4  5
[26]  3  3  1  4  4  3  3  3  3  2  2  2  2  2  2  1  1  1  1  1

$age
 [1] 59 63 53 52 57 56 48 46 50 46 49 41 47 38 38 39 37 36 33 43 37 34 31 31 53
[26] 38 42 35 29 29 34 38 33 33 30 31 34 32 45 28 43 35 38 31 26

$practice
 [1] 2 2 2 2 1 2 2 2 2 2 1 1 1 2 2 1 1 2 2 1 1 1 1 2 2 2 2 2 1 1 1 1 1 1 1 2 2 2
[39] 2 1 1 1 1 2 1

$law_school
 [1] 3 3 3 2 2 1 3 1 1 1 3 3 1 2 3 3 3 2 3 3 1 1 2 2 1 3 2 3 3 3 3 2 2 3 2 2 3 2
[39] 2 3 3 2 3 2 2

$net_status
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<p>Finally, we create an <strong>edge deleted subgraph</strong> including only the incoming advice edges from nodes who are <em>not</em> younger women in the firm to younger women and deleting everything other link:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>   e.rem <span class="ot">&lt;-</span> <span class="fu">E</span>(g)[<span class="fu">V</span>(g)[net_status<span class="sc">==</span><span class="dv">1</span>] <span class="sc">%-&gt;%</span> <span class="fu">V</span>(g)[net_status<span class="sc">==</span><span class="dv">1</span>]] </span>
<span id="cb87-2"><a href="#cb87-2"></a>   <span class="co">#selecting edges from younger women to younger women</span></span>
<span id="cb87-3"><a href="#cb87-3"></a>   g.r <span class="ot">&lt;-</span> <span class="fu">delete_edges</span>(g, e.rem) <span class="co">#removing edges</span></span>
<span id="cb87-4"><a href="#cb87-4"></a>   e.rem <span class="ot">&lt;-</span> <span class="fu">E</span>(g.r)[<span class="fu">V</span>(g.r)[net_status<span class="sc">==</span><span class="dv">1</span>] <span class="sc">%-&gt;%</span> <span class="fu">V</span>(g.r)[net_status<span class="sc">==</span><span class="dv">2</span>]] </span>
<span id="cb87-5"><a href="#cb87-5"></a>   <span class="co">#selecting edges from younger women to non-younger women</span></span>
<span id="cb87-6"><a href="#cb87-6"></a>   g.r <span class="ot">&lt;-</span> <span class="fu">delete_edges</span>(g.r, e.rem) <span class="co">#removing edges</span></span>
<span id="cb87-7"><a href="#cb87-7"></a>   e.rem <span class="ot">&lt;-</span> <span class="fu">E</span>(g.r)[<span class="fu">V</span>(g.r)[net_status<span class="sc">==</span><span class="dv">2</span>] <span class="sc">%-&gt;%</span> <span class="fu">V</span>(g.r)[net_status<span class="sc">==</span><span class="dv">2</span>]] </span>
<span id="cb87-8"><a href="#cb87-8"></a>   <span class="co">#selecting edges from non-younger women to non-younger women</span></span>
<span id="cb87-9"><a href="#cb87-9"></a>   g.r <span class="ot">&lt;-</span> <span class="fu">delete_edges</span>(g.r, e.rem) <span class="co">#removing edges</span></span>
<span id="cb87-10"><a href="#cb87-10"></a>   Iso <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">degree</span>(g.r)<span class="sc">==</span><span class="dv">0</span>) <span class="co">#selecting isolates</span></span>
<span id="cb87-11"><a href="#cb87-11"></a>   g.r <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(g.r, Iso) <span class="co">#removing isolates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we can see both the <code>delete_edges</code> and <code>delete_vertices</code> functions from <code>igraph</code> in action. Both take some graph object as input followed by either an edge sequence (in this case produced by E(g))or a vector of node ids respectively. In both cases those particular edges or nodes are removed from the graph.</p>
<p>The other neat functionality we see on display here is the <code>igraph</code> %-&gt;% operator for directed graph edges (the equivalent for undirected graphs is the double dash %–%). This allows us to select a set of edges according to a vertex condition (e.g., homophilous (same group) edges or edges that link a member from group a to a member from group b).</p>
<p>So the code chunk:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>   <span class="fu">E</span>(g)[<span class="fu">V</span>(g)[net_status<span class="sc">==</span><span class="dv">1</span>] <span class="sc">%-&gt;%</span> <span class="fu">V</span>(g)[net_status<span class="sc">==</span><span class="dv">1</span>]] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 69/436 edges from ce7130b:
 [1]  1-&gt; 4  1-&gt; 5  1-&gt; 6  1-&gt; 9  1-&gt;10  1-&gt;11  1-&gt;12  2-&gt; 3  3-&gt; 8  3-&gt; 9
[11]  3-&gt;12  4-&gt; 1  4-&gt; 3  4-&gt; 5  4-&gt; 6  4-&gt; 7  4-&gt; 8  4-&gt; 9  4-&gt;10  4-&gt;12
[21]  5-&gt; 4  5-&gt; 7  5-&gt; 8  5-&gt; 9  5-&gt;12  6-&gt; 1  6-&gt; 4  6-&gt; 7  6-&gt; 8  6-&gt; 9
[31]  7-&gt; 5  7-&gt; 6  7-&gt; 8  7-&gt;11  7-&gt;12  8-&gt; 1  8-&gt; 2  8-&gt; 3  8-&gt; 4  8-&gt; 6
[41]  8-&gt; 7  8-&gt; 9  8-&gt;10  8-&gt;12  9-&gt; 1  9-&gt; 4  9-&gt; 6  9-&gt; 8  9-&gt;11  9-&gt;12
[51] 10-&gt; 1 10-&gt; 4 10-&gt; 5 10-&gt; 7 10-&gt; 9 10-&gt;11 10-&gt;12 11-&gt; 1 11-&gt; 7 11-&gt; 8
[61] 11-&gt; 9 11-&gt;10 12-&gt; 1 12-&gt; 4 12-&gt; 5 12-&gt; 7 12-&gt; 8 12-&gt; 9 12-&gt;11</code></pre>
</div>
</div>
<p>Take the edge set of the graph g (E(g)) and gives us the subset of edges that go from a vertex with net_status equal to one to another vertex that also has net_status equal to one (in this case edges directed from one of our focal nodes to another one of our focal nodes). This, of course, happens to be all the directed edges linking nodes one through twelve in the network. The same go for the other calls to the same function using different logical combinations of values of net_status between nodes.</p>
<p>FINALLY, can now plot the incoming advice network to younger women (in red):</p>
<div class="cell" data-fig-cap-location="margin">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout2_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Women lawyers advice network showing incoming links from outside the group (blue nodes) to younger women (red nodes)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="note-handling-graph-objects-in-lists" class="level2">
<h2 class="anchored" data-anchor-id="note-handling-graph-objects-in-lists">Note: Handling Graph Objects in Lists</h2>
<p>Speaking of lists, sometimes network data comes pre-stored as an <code>R</code> <strong>list</strong>. This is typical if you have a network with multiple kinds of ties recorded on the same set of actors (and thus multiple networks), or longitudinal network data, where we collect multiple “snapshots” of the same system (containing the same or more typically a different set of actors per time slice).</p>
<p>The <code>networkdata</code> package contains one such data set called <code>atp</code>. It’s a network of Tennis players who played in grand slam or official matches of the Association of Tennis Professionals (hence ATP) covering the years 1968-2021 <span class="citation" data-cites="radicchi2011best">(<a href="#ref-radicchi2011best" role="doc-biblioref">Radicchi 2011</a>)</span>.</p>
<p>In the directed graph representing each network, a tie goes <strong>from</strong> the <em>loser</em> <strong>to</strong> the <em>winner</em> of each match. Accordingly, it can be interpreted as a directed “deference” network (it would be a dominance network if it was the other way around), where actor <em>i</em> “defers” to actor <em>j</em> by getting their ass kicked by them.</p>
<p>Let’s see how this list of networks works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>   g <span class="ot">&lt;-</span> atp</span>
<span id="cb90-2"><a href="#cb90-2"></a>   <span class="fu">head</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
IGRAPH 08a202a DNW- 497 1213 -- ATP Season 1968
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from 08a202a (vertex names):
 [1] U Unknown    -&gt;Jose Mandarino     Alfredo Acuna-&gt;Alan Fox          
 [3] Andres Gimeno-&gt;Ken Rosewall       Andres Gimeno-&gt;Raymond Moore     
 [5] Juan Gisbert -&gt;Tom Okker          Juan Gisbert -&gt;Zeljko Franulovic 
 [7] Onny Parun   -&gt;Jan Kodes          Peter Curtis -&gt;Tom Okker         
 [9] Premjit Lall -&gt;Clark Graebner     Rod Laver    -&gt;Ken Rosewall      
[11] Thomas Lejus -&gt;Nicola Pietrangeli Tom Okker    -&gt;Arthur Ashe       
[13] U Unknown    -&gt;Jaidip Mukherjea   U Unknown    -&gt;Jose Luis Arillla 
+ ... omitted several edges

[[2]]
IGRAPH c895c57 DNW- 446 1418 -- ATP Season 1969
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from c895c57 (vertex names):
 [1] U Unknown           -&gt;U Unknown        
 [2] Alejandro Olmedo    -&gt;Ron Holmberg     
 [3] Arthur Ashe         -&gt;Rod Laver        
 [4] Bob Carmichael      -&gt;Jim Osborne      
 [5] Cliff Richey        -&gt;Zeljko Franulovic
 [6] Francois Jauffret   -&gt;Martin Mulligan  
 [7] Fred Stolle         -&gt;John Newcombe    
+ ... omitted several edges

[[3]]
IGRAPH d6709af DNW- 451 1650 -- ATP Season 1970
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from d6709af (vertex names):
 [1] Mark Cox            -&gt;Jan Kodes        
 [2] Charlie Pasarell    -&gt;Stan Smith       
 [3] Cliff Richey        -&gt;Arthur Ashe      
 [4] Francois Jauffret   -&gt;Manuel Orantes   
 [5] Georges Goven       -&gt;Jan Kodes        
 [6] Harald Elschenbroich-&gt;Zeljko Franulovic
 [7] Ilie Nastase        -&gt;Zeljko Franulovic
+ ... omitted several edges

[[4]]
IGRAPH a73a020 DNW- 459 2580 -- ATP Season 1971
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from a73a020 (vertex names):
 [1] Andres Gimeno    -&gt;Ken Rosewall   Arthur Ashe      -&gt;Rod Laver     
 [3] Charlie Pasarell -&gt;Cliff Drysdale Frank Froehling  -&gt;Clark Graebner
 [5] Joaquin Loyo Mayo-&gt;Thomaz Koch    John Alexander   -&gt;John Newcombe 
 [7] John Newcombe    -&gt;Marty Riessen  Nikola Pilic     -&gt;Cliff Drysdale
 [9] Owen Davidson    -&gt;Cliff Drysdale Robert Maud      -&gt;Cliff Drysdale
[11] Roger Taylor     -&gt;Marty Riessen  Roy Emerson      -&gt;Rod Laver     
[13] Tom Okker        -&gt;John Newcombe  Allan Stone      -&gt;Bob Carmichael
+ ... omitted several edges

[[5]]
IGRAPH 761ed05 DNW- 504 2767 -- ATP Season 1972
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from 761ed05 (vertex names):
 [1] Jean Loup Rouyer-&gt;Stan Smith     Marty Riessen   -&gt;Cliff Drysdale
 [3] Roy Emerson     -&gt;Arthur Ashe    Roy Emerson     -&gt;Arthur Ashe   
 [5] Tom Leonard     -&gt;John Newcombe  Tom Okker       -&gt;Arthur Ashe   
 [7] Tom Okker       -&gt;Rod Laver      Adriano Panatta -&gt;Andres Gimeno 
 [9] Adriano Panatta -&gt;Ilie Nastase   Allan Stone     -&gt;John Alexander
[11] Allan Stone     -&gt;Marty Riessen  Andres Gimeno   -&gt;Jan Kodes     
[13] Andres Gimeno   -&gt;Stan Smith     Andrew Pattison -&gt;Ilie Nastase  
+ ... omitted several edges

[[6]]
IGRAPH 92ff576 DNW- 592 3653 -- ATP Season 1973
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from 92ff576 (vertex names):
 [1] Harold Solomon    -&gt;Stan Smith       John Alexander    -&gt;Stan Smith      
 [3] Patrice Dominguez -&gt;Paolo Bertolucci Paul Gerken       -&gt;Jimmy Connors   
 [5] Roy Emerson       -&gt;Rod Laver        Adriano Panatta   -&gt;Ilie Nastase    
 [7] Bjorn Borg        -&gt;Adriano Panatta  Brian Gottfried   -&gt;Cliff Richey    
 [9] Charlie Pasarell  -&gt;John Alexander   Cliff Richey      -&gt;Stan Smith      
[11] Corrado Barazzutti-&gt;Bjorn Borg       Francois Jauffret -&gt;Ilie Nastase    
[13] Georges Goven     -&gt;Manuel Orantes   Manuel Orantes    -&gt;Ilie Nastase    
+ ... omitted several edges</code></pre>
</div>
</div>
<p>We create a graph object and then examine its contents, which we can see is a set of graph objects. In unnamed <code>R</code> lists each of the objects inside is indexed by a number in double brackets. So [[6]] just means the sixth network in the list object (corresponding to the year 1973).</p>
<p>Now let’s say we wanted to compute a network statistic like density. One way to proceed would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>   <span class="fu">edge_density</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `ensure_igraph()`:
! Must provide a graph object (provided wrong object type).</code></pre>
</div>
</div>
<p>Which gives us a weird error about the wrong object type. The reason is that <code>edge_density</code> expects an <code>igraph</code> graph object as input, but g is not a graph object it is a <em>list</em> of such objects. For it to work you have to reference a particular <em>element inside the list</em> not the whole list.</p>
<p>To do that, we use the double bracket notation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>   <span class="fu">edge_density</span>(g[[<span class="dv">6</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01044096</code></pre>
</div>
</div>
<p>Which gives us the density for the 1973 network.</p>
<section id="looping-through-lists" class="level3">
<h3 class="anchored" data-anchor-id="looping-through-lists">Looping Through Lists</h3>
<p>But what if we wanted a table of network statistics for all the years or some subset of years? Of course, we could just type a million versions of the <code>edge_density</code> command or whatever, but that would be tedious. We could also write a <code>for</code> loop or something like that (less tedious). Even less tedious is to use the many <code>apply</code> functions in <code>R</code> that are designed to work with lists, which is a subject onto itself in <code>R</code> programming.</p>
<p>But here we can just use the simple version. Let’s say we wanted a vector of densities (or any other whole network statistics) for the whole 54 years. In that case, our friend <code>sapply</code> can do the job:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>   <span class="fu">sapply</span>(g, edge_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.004920653 0.007144657 0.008130081 0.012272740 0.010914671 0.010440961
 [7] 0.010567864 0.013315132 0.012088214 0.014019237 0.014135328 0.011649909
[13] 0.011172821 0.011261426 0.012703925 0.012177336 0.012648755 0.012445937
[19] 0.012034362 0.012351377 0.010174271 0.009772014 0.019526953 0.012236462
[25] 0.014050245 0.015054181 0.013872832 0.014727924 0.014329906 0.013935502
[31] 0.013962809 0.013870042 0.013665097 0.013818887 0.012551113 0.011571679
[37] 0.012329090 0.012923683 0.011402945 0.012677988 0.012256963 0.013512884
[43] 0.012543025 0.013661748 0.013786518 0.013679697 0.015052857 0.015075622
[49] 0.015081206 0.014346468 0.015764351 0.020169225 0.011889114 0.016935400</code></pre>
</div>
</div>
<p><code>sapply</code> is kind of a “meta” function that takes two inputs: A list, and a <em>the name</em> of a function (which could be native, a package, or user defined); <code>sapply</code> then “applies” that function to each element inside the list. Here we asked <code>R</code> to apply the function <code>edge_density</code> to each element of the list of networks g and it obliged, create a vector length 54 containing the info.</p>
<p>We could use any <code>igraph</code> function, like number of nodes in the graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>   <span class="fu">sapply</span>(g, vcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 497 446 451 459 504 592 595 535 553 524 509 572 582 573 554 532 495 513 510
[20] 523 596 597 405 542 509 498 520 496 502 499 497 480 486 479 497 517 505 492
[39] 524 488 493 464 482 459 457 453 428 430 431 438 419 364 345 393</code></pre>
</div>
</div>
<p>We could also select <em>subset</em> of elements inside the list. For instance this counts the number of nodes for the first five years:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>   <span class="fu">sapply</span>(g[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], vcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 497 446 451 459 504</code></pre>
</div>
</div>
<p>Or for years 2, 6, 8, and 12:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>   <span class="fu">sapply</span>(g[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">12</span>)], vcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 446 592 535 572</code></pre>
</div>
</div>
<p>Note the <em>single bracket</em> notation here to refer to subsets of elements in the list. Inside the brackets we could put any arbitrary vector, as long as the numbers in the vector do no exceed the length of the list.</p>
<p>Of course, sometimes the functions we apply to elements of the list don’t return single numbers but vectors or other igraph objects. In that case it would be better to use <code>lapply</code> which is just like <code>sapply</code> but returns another list with the set of answers inside it.</p>
<p>For instance, let’s say we wanted the top five players for each year. In this deference network, a “top” player is one who beats many others, which means they have high <strong>indegree</strong> (lots of losers pointing at them).</p>
<p>First we create a custom function to compute the indegree and return an ordered named vector of top 5 players:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>   top5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb104-2"><a href="#cb104-2"></a>      <span class="fu">library</span>(igraph)</span>
<span id="cb104-3"><a href="#cb104-3"></a>      t <span class="ot">&lt;-</span> <span class="fu">degree</span>(x, <span class="at">mode =</span> <span class="st">"in"</span>)</span>
<span id="cb104-4"><a href="#cb104-4"></a>      t <span class="ot">&lt;-</span> <span class="fu">sort</span>(t, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb104-5"><a href="#cb104-5"></a>      <span class="fu">return</span>(t)</span>
<span id="cb104-6"><a href="#cb104-6"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can just feed that function to <code>lapply</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>   top.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(g, top5)</span>
<span id="cb105-2"><a href="#cb105-2"></a>   <span class="fu">head</span>(top.list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
   Arthur Ashe      Rod Laver Clark Graebner   Ken Rosewall      Tom Okker 
            33             27             25             23             22 

[[2]]
John Newcombe     Tom Okker     Rod Laver    Tony Roche   Arthur Ashe 
           45            41            40            40            33 

[[3]]
      Arthur Ashe      Cliff Richey         Rod Laver        Stan Smith 
               51                49                48                45 
Zeljko Franulovic 
               42 

[[4]]
     Ilie Nastase         Tom Okker     Marty Riessen        Stan Smith 
               69                63                61                61 
Zeljko Franulovic 
               60 

[[5]]
  Ilie Nastase     Stan Smith Manuel Orantes  Jimmy Connors    Arthur Ashe 
            99             72             68             65             55 

[[6]]
 Ilie Nastase     Tom Okker Jimmy Connors   Arthur Ashe    Stan Smith 
           96            81            68            63            63 </code></pre>
</div>
</div>
<p>Which is a list of named vectors containing the number of victories of the top five players each year.</p>
<p>Because the object <code>top.list</code> is just a list, we can subset it just like before. Let’s say we wanted to see the top players for more recent years:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>   top.list[<span class="dv">49</span><span class="sc">:</span><span class="dv">54</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
   Andy Murray  Dominic Thiem  Kei Nishikori Novak Djokovic   David Goffin 
            63             55             53             50             47 

[[2]]
         Rafael Nadal          David Goffin      Alexander Zverev 
                   58                    55                    52 
Roberto Bautista Agut         Dominic Thiem 
                   45                    43 

[[3]]
   Dominic Thiem Alexander Zverev   Novak Djokovic    Fabio Fognini 
              51               50               46               45 
   Roger Federer 
              44 

[[4]]
   Daniil Medvedev     Novak Djokovic       Rafael Nadal Stefanos Tsitsipas 
                55                 52                 52                 49 
     Roger Federer 
                47 

[[5]]
     Andrey Rublev     Novak Djokovic Stefanos Tsitsipas       Rafael Nadal 
                40                 36                 27                 26 
   Daniil Medvedev 
                24 

[[6]]
   Daniil Medvedev Stefanos Tsitsipas        Casper Ruud   Alexander Zverev 
                54                 52                 52                 51 
    Novak Djokovic 
                49 </code></pre>
</div>
</div>
<p>A series of names which make sense to you if you follow Tennis.</p>
</section>
<section id="naming-lists" class="level3">
<h3 class="anchored" data-anchor-id="naming-lists">Naming Lists</h3>
<p>Finally, sometimes it useful to <em>name</em> the elements of a list. In this case, for instance, having the year number would be easier to remember what’s what. For this, you can use the <code>names</code> command, which works via standard <code>R</code> assignment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>   <span class="fu">names</span>(g) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1968</span><span class="sc">:</span><span class="dv">2021</span>)</span>
<span id="cb109-2"><a href="#cb109-2"></a>   <span class="fu">head</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1968`
IGRAPH 08a202a DNW- 497 1213 -- ATP Season 1968
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from 08a202a (vertex names):
 [1] U Unknown    -&gt;Jose Mandarino     Alfredo Acuna-&gt;Alan Fox          
 [3] Andres Gimeno-&gt;Ken Rosewall       Andres Gimeno-&gt;Raymond Moore     
 [5] Juan Gisbert -&gt;Tom Okker          Juan Gisbert -&gt;Zeljko Franulovic 
 [7] Onny Parun   -&gt;Jan Kodes          Peter Curtis -&gt;Tom Okker         
 [9] Premjit Lall -&gt;Clark Graebner     Rod Laver    -&gt;Ken Rosewall      
[11] Thomas Lejus -&gt;Nicola Pietrangeli Tom Okker    -&gt;Arthur Ashe       
[13] U Unknown    -&gt;Jaidip Mukherjea   U Unknown    -&gt;Jose Luis Arillla 
+ ... omitted several edges

$`1969`
IGRAPH c895c57 DNW- 446 1418 -- ATP Season 1969
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from c895c57 (vertex names):
 [1] U Unknown           -&gt;U Unknown        
 [2] Alejandro Olmedo    -&gt;Ron Holmberg     
 [3] Arthur Ashe         -&gt;Rod Laver        
 [4] Bob Carmichael      -&gt;Jim Osborne      
 [5] Cliff Richey        -&gt;Zeljko Franulovic
 [6] Francois Jauffret   -&gt;Martin Mulligan  
 [7] Fred Stolle         -&gt;John Newcombe    
+ ... omitted several edges

$`1970`
IGRAPH d6709af DNW- 451 1650 -- ATP Season 1970
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from d6709af (vertex names):
 [1] Mark Cox            -&gt;Jan Kodes        
 [2] Charlie Pasarell    -&gt;Stan Smith       
 [3] Cliff Richey        -&gt;Arthur Ashe      
 [4] Francois Jauffret   -&gt;Manuel Orantes   
 [5] Georges Goven       -&gt;Jan Kodes        
 [6] Harald Elschenbroich-&gt;Zeljko Franulovic
 [7] Ilie Nastase        -&gt;Zeljko Franulovic
+ ... omitted several edges

$`1971`
IGRAPH a73a020 DNW- 459 2580 -- ATP Season 1971
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from a73a020 (vertex names):
 [1] Andres Gimeno    -&gt;Ken Rosewall   Arthur Ashe      -&gt;Rod Laver     
 [3] Charlie Pasarell -&gt;Cliff Drysdale Frank Froehling  -&gt;Clark Graebner
 [5] Joaquin Loyo Mayo-&gt;Thomaz Koch    John Alexander   -&gt;John Newcombe 
 [7] John Newcombe    -&gt;Marty Riessen  Nikola Pilic     -&gt;Cliff Drysdale
 [9] Owen Davidson    -&gt;Cliff Drysdale Robert Maud      -&gt;Cliff Drysdale
[11] Roger Taylor     -&gt;Marty Riessen  Roy Emerson      -&gt;Rod Laver     
[13] Tom Okker        -&gt;John Newcombe  Allan Stone      -&gt;Bob Carmichael
+ ... omitted several edges

$`1972`
IGRAPH 761ed05 DNW- 504 2767 -- ATP Season 1972
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from 761ed05 (vertex names):
 [1] Jean Loup Rouyer-&gt;Stan Smith     Marty Riessen   -&gt;Cliff Drysdale
 [3] Roy Emerson     -&gt;Arthur Ashe    Roy Emerson     -&gt;Arthur Ashe   
 [5] Tom Leonard     -&gt;John Newcombe  Tom Okker       -&gt;Arthur Ashe   
 [7] Tom Okker       -&gt;Rod Laver      Adriano Panatta -&gt;Andres Gimeno 
 [9] Adriano Panatta -&gt;Ilie Nastase   Allan Stone     -&gt;John Alexander
[11] Allan Stone     -&gt;Marty Riessen  Andres Gimeno   -&gt;Jan Kodes     
[13] Andres Gimeno   -&gt;Stan Smith     Andrew Pattison -&gt;Ilie Nastase  
+ ... omitted several edges

$`1973`
IGRAPH 92ff576 DNW- 592 3653 -- ATP Season 1973
+ attr: name (g/c), name (v/c), age (v/n), hand (v/c), country (v/c),
| surface (e/c), weight (e/n)
+ edges from 92ff576 (vertex names):
 [1] Harold Solomon    -&gt;Stan Smith       John Alexander    -&gt;Stan Smith      
 [3] Patrice Dominguez -&gt;Paolo Bertolucci Paul Gerken       -&gt;Jimmy Connors   
 [5] Roy Emerson       -&gt;Rod Laver        Adriano Panatta   -&gt;Ilie Nastase    
 [7] Bjorn Borg        -&gt;Adriano Panatta  Brian Gottfried   -&gt;Cliff Richey    
 [9] Charlie Pasarell  -&gt;John Alexander   Cliff Richey      -&gt;Stan Smith      
[11] Corrado Barazzutti-&gt;Bjorn Borg       Francois Jauffret -&gt;Ilie Nastase    
[13] Georges Goven     -&gt;Manuel Orantes   Manuel Orantes    -&gt;Ilie Nastase    
+ ... omitted several edges</code></pre>
</div>
</div>
<p>Now instead of the useless one, two, three, etc. names, we have the actual year numbers as the names of the elements on each list.</p>
<p>So if we wanted to know the top five players for 1988 we could just type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>   <span class="fu">top5</span>(g[[<span class="st">"1988"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Stefan Edberg     Andre Agassi     Boris Becker    Mats Wilander 
              63               59               52               49 
Aaron Krickstein 
              48 </code></pre>
</div>
</div>
<p>Note the double bracket notation and the fact that the name of the list is a character not a number (hence the scare quotes).</p>
<p>If we don’t want to remember the bracket business, we could also use the $ operator to refer to particular list elements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>   <span class="fu">top5</span>(g<span class="sc">$</span><span class="st">"1988"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Stefan Edberg     Andre Agassi     Boris Becker    Mats Wilander 
              63               59               52               49 
Aaron Krickstein 
              48 </code></pre>
</div>
</div>
<p>Of course, we can also use the names to subset the list. Let’s say we wanted the top five players for 1970, 1980, 1990, 2000, 2010, and 2020.</p>
<p>All we have to do is type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>   decades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1970"</span>, <span class="st">"1980"</span>, <span class="st">"1990"</span>, <span class="st">"2000"</span>, <span class="st">"2010"</span>, <span class="st">"2020"</span>)</span>
<span id="cb115-2"><a href="#cb115-2"></a>   <span class="fu">lapply</span>(g[decades], top5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1970`
      Arthur Ashe      Cliff Richey         Rod Laver        Stan Smith 
               51                49                48                45 
Zeljko Franulovic 
               42 

$`1980`
     Ivan Lendl    John Mcenroe Brian Gottfried      Bjorn Borg Eliot Teltscher 
             97              76              63              62              62 

$`1990`
  Boris Becker  Stefan Edberg     Ivan Lendl   Pete Sampras Emilio Sanchez 
            62             57             50             47             44 

$`2000`
Yevgeny Kafelnikov        Marat Safin    Gustavo Kuerten      Magnus Norman 
                63                 61                 59                 58 
    Lleyton Hewitt 
                53 

$`2010`
   Rafael Nadal   Roger Federer    David Ferrer Robin Soderling   Jurgen Melzer 
             63              54              53              53              51 

$`2020`
     Andrey Rublev     Novak Djokovic Stefanos Tsitsipas       Rafael Nadal 
                40                 36                 27                 26 
   Daniil Medvedev 
                24 </code></pre>
</div>
</div>
<p>Note that we are back to the single bracket notation.</p>
<p>With a bit of practice, lists will become your friends!</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-agneessens_etal17" class="csl-entry" role="doc-biblioentry">
Agneessens, Filip, Stephen P Borgatti, and Martin G Everett. 2017. <span>“Geodesic Based Centrality: Unifying the Local and the Global.”</span> <em>Social Networks</em> 49: 12–26.
</div>
<div id="ref-boldi_vigna14" class="csl-entry" role="doc-biblioentry">
Boldi, Paolo, and Sebastiano Vigna. 2014. <span>“Axioms for Centrality.”</span> <em>Internet Mathematics</em> 10 (3-4): 222–62.
</div>
<div id="ref-brohl_lehnertz22" class="csl-entry" role="doc-biblioentry">
Bröhl, Timo, and Klaus Lehnertz. 2022. <span>“A Straightforward Edge Centrality Concept Derived from Generalizing Degree and Strength.”</span> <em>Scientific Reports</em> 12 (1): 4407.
</div>
<div id="ref-freeman79" class="csl-entry" role="doc-biblioentry">
Freeman, Linton C. 1979. <span>“Centrality in Social Networks Conceptual Clarification.”</span> <em>Social Networks</em> 1: 215–39.
</div>
<div id="ref-girvan_newman02" class="csl-entry" role="doc-biblioentry">
Girvan, Michelle, and Mark EJ Newman. 2002. <span>“Community Structure in Social and Biological Networks.”</span> <em>Proceedings of the National Academy of Sciences</em> 99 (12): 7821–26.
</div>
<div id="ref-radicchi2011best" class="csl-entry" role="doc-biblioentry">
Radicchi, Filippo. 2011. <span>“Who Is the Best Player Ever? A Complex Network Analysis of the History of Professional Tennis.”</span> <em>PloS One</em> 6 (2): e17249.
</div>
<div id="ref-rochat09" class="csl-entry" role="doc-biblioentry">
Rochat, Yannick. 2009. <span>“Closeness Centrality Extended to Unconnected Graphs: The Harmonic Centrality Index.”</span> Switzerland: Institute of Applied Mathematics University of Lausanne. <a href="https://infoscience.epfl.ch/server/api/core/bitstreams/7f3097a0-d7e0-4cd4-a3f3-82673aab1909/content">https://infoscience.epfl.ch/server/api/core/bitstreams/7f3097a0-d7e0-4cd4-a3f3-82673aab1909/content</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="agneessens_etal17">Agneessens, Borgatti, and Everett (<a href="#ref-agneessens_etal17" role="doc-biblioref">2017</a>)</span> call the harmonic centrality “reciprocal closeness”<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Some people <span class="citation" data-cites="boldi_vigna14">(<a href="#ref-boldi_vigna14" role="doc-biblioref">Boldi and Vigna 2014</a>)</span> claim that the harmonic centrality is the <em>only</em> centrality measure that could be called by that name from a purely axiomatic mathematical approach, but that’s a different story.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>