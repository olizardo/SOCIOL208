<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL 208 - Analyzing Ego Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="SOCIOL 208 - Analyzing Ego Networks">
<meta property="og:description" content="An ego-network, is just a subgraph of a larger network that includes a node of interest (“ego”), all of the connections between ego and their neighbors (called “alters”) and usually all of the…">
<meta property="og:site-name" content="SOCIOL 208">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Analyzing Ego Networks</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOCIOL 208</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">208A</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208A.html" class="sidebar-item-text sidebar-link">208A Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208A-F24.html" class="sidebar-item-text sidebar-link">SOCIOL 208A Reading Schedule (Fall 2024)</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Handouts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout1.html" class="sidebar-item-text sidebar-link">Basic Network Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inoutdegdist.html" class="sidebar-item-text sidebar-link">Graph Degree Metrics in Directed Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout2.html" class="sidebar-item-text sidebar-link">Centrality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cube.html" class="sidebar-item-text sidebar-link">The Cube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout3.html" class="sidebar-item-text sidebar-link">Status and Prestige</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout4.html" class="sidebar-item-text sidebar-link">Role Equivalence and Structural Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout5.html" class="sidebar-item-text sidebar-link">Vertex Similarity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blondel.html" class="sidebar-item-text sidebar-link">Role Similarity Across Graphs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout6.html" class="sidebar-item-text sidebar-link">Community Structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahn.html" class="sidebar-item-text sidebar-link">Assigning Nodes to Multiple Communities</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout7.html" class="sidebar-item-text sidebar-link">Analyzing Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ca.html" class="sidebar-item-text sidebar-link">Correspondence Analysis (CA) of Two-Mode Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spectral.html" class="sidebar-item-text sidebar-link">Community Detection Using Spectral Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./handout8.html" class="sidebar-item-text sidebar-link active">Analyzing Ego Networks</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">208B</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus-208B.html" class="sidebar-item-text sidebar-link">208B Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule-208B-S24.html" class="sidebar-item-text sidebar-link">SOCIOL 208B Reading Schedule (Spring 2024)</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ego-networks-and-ego-network-data" id="toc-ego-networks-and-ego-network-data" class="nav-link active" data-scroll-target="#ego-networks-and-ego-network-data">Ego Networks and Ego Network Data</a></li>
  <li><a href="#the-clustering-coefficient" id="toc-the-clustering-coefficient" class="nav-link" data-scroll-target="#the-clustering-coefficient">The Clustering Coefficient</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/olizardo/SOCIOL208/blob/main/handout8.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Analyzing Ego Networks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="ego-networks-and-ego-network-data" class="level2">
<h2 class="anchored" data-anchor-id="ego-networks-and-ego-network-data">Ego Networks and Ego Network Data</h2>
<p>An ego-network, is just a <strong>subgraph</strong> of a larger network that includes a node of interest (“ego”), all of the connections between ego and their neighbors (called “alters”) and usually all of the connections between each of the alters.</p>
<p><strong>Ego network data</strong> is social network data collected in such way (e.g., using standard social survey techniques) that you capture the ego networks of some set of people, usually a convenience sample or, more rarely, a probability sample of some population.</p>
<p>Once you have ego network data you can analyze each ego graph using the standard techniques we learned so far (if you are only interested in the structural characteristics of the ego graph).</p>
<p>If you have attributes on each alter, you can alternatively compute measures of <strong>diversity</strong> to or <strong>homophily</strong> to get a sense of how likely ego is to connect to similar or diverse others.</p>
</section>
<section id="the-clustering-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="the-clustering-coefficient">The Clustering Coefficient</h2>
<p>Perhaps the most basic structural characteristic of an ego network is the density of the subgraph formed by all of the connections between the alters. This is called ego’s <strong>clustering coefficient</strong>. Let’s see how it works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>   <span class="fu">library</span>(networkdata)</span>
<span id="cb1-2"><a href="#cb1-2"></a>   g <span class="ot">&lt;-</span> starwars[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we said an ego graph is just a subgraph centered on a particular actor. So R2-D2’s ego graph is just:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>   <span class="fu">library</span>(igraph)</span>
<span id="cb2-2"><a href="#cb2-2"></a>   N <span class="ot">&lt;-</span> <span class="fu">neighbors</span>(g, <span class="st">"R2-D2"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>   r2d2 <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(g, <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"R2-D2"</span>), <span class="fu">as.vector</span>(N)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we can just plot it like we would any <code>igraph</code> object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>   <span class="fu">V</span>(r2d2)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">2</span>, <span class="fu">length</span>(N)))</span>
<span id="cb3-2"><a href="#cb3-2"></a>   <span class="fu">plot</span>(r2d2, </span>
<span id="cb3-3"><a href="#cb3-3"></a>     <span class="at">vertex.size=</span><span class="dv">10</span>, <span class="at">vertex.frame.color=</span><span class="st">"lightgray"</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>     <span class="at">vertex.label.dist=</span><span class="dv">2</span>, <span class="at">edge.curved=</span><span class="fl">0.2</span>, </span>
<span id="cb3-5"><a href="#cb3-5"></a>     <span class="at">layout =</span> <span class="fu">layout_</span>(r2d2, <span class="fu">as_star</span>()),</span>
<span id="cb3-6"><a href="#cb3-6"></a>     <span class="at">vertex.label.cex =</span> <span class="fl">1.25</span>, <span class="at">edge.color =</span> <span class="st">"lightgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout8_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">R2-D2’s Ego Network.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Note that we use the <code>as_star()</code> option for the layout, so that the ego is put in the center of the star graph surrounded by their alters.</p>
<p>R2-D2’s clustering coefficient is just the density of the graph that includes only the alters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>   r2d2.alters <span class="ot">&lt;-</span> r2d2 <span class="sc">-</span> <span class="fu">vertex</span>(<span class="st">"R2-D2"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>   C <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">edge_density</span>(r2d2.alters), <span class="dv">2</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>   C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.67</code></pre>
</div>
</div>
<p>The clustering coefficient <span class="math inline">\(C_i\)</span> for an ego <span class="math inline">\(i\)</span> ranges from zero to one. <span class="math inline">\(C = 0\)</span> means that <em>none</em> of ego’s alters are connected to one another and <span class="math inline">\(C = 1\)</span> means that <em>all</em> of ego’s alters are connected to one another. In this case, <span class="math inline">\(C = 0.67\)</span> means that 67% of R2-D2’s alters are connected (co-appear in scenes) with one another.</p>
<p>Typically we would want to compute the clustering coefficient of every node in a graph. This can be done using our trusty <code>lapply</code> and <code>sapply</code> meta-functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>   create.ego <span class="ot">&lt;-</span> <span class="cf">function</span>(x, w) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>      alter.net <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(w, <span class="fu">neighbors</span>(w, x))</span>
<span id="cb6-3"><a href="#cb6-3"></a>      <span class="fu">return</span>(alter.net)</span>
<span id="cb6-4"><a href="#cb6-4"></a>      }</span>
<span id="cb6-5"><a href="#cb6-5"></a>   ego.graphs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name, create.ego, <span class="at">w =</span> g)</span>
<span id="cb6-6"><a href="#cb6-6"></a>   <span class="fu">head</span>(ego.graphs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
IGRAPH 81e8e17 UNW- 9 24 -- Episode IV – A New Hope
+ attr: name (g/c), name (v/c), height (v/n), mass (v/n), hair_color
| (v/c), skin_color (v/c), eye_color (v/c), birth_year (v/n), sex
| (v/c), homeworld (v/c), species (v/c), weight (e/n)
+ edges from 81e8e17 (vertex names):
 [1] CHEWBACCA--C-3PO   CHEWBACCA--LUKE    C-3PO    --LUKE    C-3PO    --BIGGS  
 [5] LUKE     --BIGGS   CHEWBACCA--LEIA    C-3PO    --LEIA    LUKE     --LEIA   
 [9] BIGGS    --LEIA    C-3PO    --BERU    LUKE     --BERU    LEIA     --BERU   
[13] C-3PO    --OWEN    LUKE     --OWEN    BERU     --OWEN    CHEWBACCA--OBI-WAN
[17] C-3PO    --OBI-WAN LUKE     --OBI-WAN LEIA     --OBI-WAN CHEWBACCA--HAN    
[21] C-3PO    --HAN     LUKE     --HAN     LEIA     --HAN     OBI-WAN  --HAN    

[[2]]
IGRAPH 81e94cb UNW- 6 15 -- Episode IV – A New Hope
+ attr: name (g/c), name (v/c), height (v/n), mass (v/n), hair_color
| (v/c), skin_color (v/c), eye_color (v/c), birth_year (v/n), sex
| (v/c), homeworld (v/c), species (v/c), weight (e/n)
+ edges from 81e94cb (vertex names):
 [1] R2-D2  --C-3PO   R2-D2  --LUKE    C-3PO  --LUKE    R2-D2  --LEIA   
 [5] C-3PO  --LEIA    LUKE   --LEIA    R2-D2  --OBI-WAN C-3PO  --OBI-WAN
 [9] LUKE   --OBI-WAN LEIA   --OBI-WAN R2-D2  --HAN     C-3PO  --HAN    
[13] LUKE   --HAN     LEIA   --HAN     OBI-WAN--HAN    

[[3]]
IGRAPH 81e9603 UNW- 10 27 -- Episode IV – A New Hope
+ attr: name (g/c), name (v/c), height (v/n), mass (v/n), hair_color
| (v/c), skin_color (v/c), eye_color (v/c), birth_year (v/n), sex
| (v/c), homeworld (v/c), species (v/c), weight (e/n)
+ edges from 81e9603 (vertex names):
 [1] R2-D2    --CHEWBACCA R2-D2    --LUKE      CHEWBACCA--LUKE     
 [4] R2-D2    --BIGGS     LUKE     --BIGGS     R2-D2    --LEIA     
 [7] CHEWBACCA--LEIA      LUKE     --LEIA      BIGGS    --LEIA     
[10] R2-D2    --BERU      LUKE     --BERU      LEIA     --BERU     
[13] R2-D2    --OWEN      LUKE     --OWEN      BERU     --OWEN     
[16] R2-D2    --OBI-WAN   CHEWBACCA--OBI-WAN   LUKE     --OBI-WAN  
+ ... omitted several edges

[[4]]
IGRAPH 81e971e UNW- 15 36 -- Episode IV – A New Hope
+ attr: name (g/c), name (v/c), height (v/n), mass (v/n), hair_color
| (v/c), skin_color (v/c), eye_color (v/c), birth_year (v/n), sex
| (v/c), homeworld (v/c), species (v/c), weight (e/n)
+ edges from 81e971e (vertex names):
 [1] R2-D2    --CHEWBACCA R2-D2    --C-3PO     R2-D2    --BERU     
 [4] R2-D2    --OWEN      R2-D2    --OBI-WAN   R2-D2    --LEIA     
 [7] R2-D2    --BIGGS     R2-D2    --HAN       CHEWBACCA--OBI-WAN  
[10] CHEWBACCA--C-3PO     CHEWBACCA--HAN       CHEWBACCA--LEIA     
[13] CAMIE    --BIGGS     BERU     --OWEN      C-3PO    --BERU     
[16] C-3PO    --OWEN      C-3PO    --LEIA      LEIA     --BERU     
+ ... omitted several edges

[[5]]
IGRAPH 81e9826 UNW- 4 4 -- Episode IV – A New Hope
+ attr: name (g/c), name (v/c), height (v/n), mass (v/n), hair_color
| (v/c), skin_color (v/c), eye_color (v/c), birth_year (v/n), sex
| (v/c), homeworld (v/c), species (v/c), weight (e/n)
+ edges from 81e9826 (vertex names):
[1] LEIA --OBI-WAN LEIA --MOTTI   LEIA --TARKIN  MOTTI--TARKIN 

[[6]]
IGRAPH 81e9930 UNW- 2 1 -- Episode IV – A New Hope
+ attr: name (g/c), name (v/c), height (v/n), mass (v/n), hair_color
| (v/c), skin_color (v/c), eye_color (v/c), birth_year (v/n), sex
| (v/c), homeworld (v/c), species (v/c), weight (e/n)
+ edge from 81e9930 (vertex names):
[1] LUKE--BIGGS</code></pre>
</div>
</div>
<p>First, we turn the code we used to find R2-D2’s ego graph into a function, then we apply the function to each node in the network. The result is a <code>list</code> object with <span class="math inline">\(|V| = 21\)</span> ego subgraphs composed of each node’s alters and their connections.</p>
<p>Now, to find out the clustering coefficient of each node, we just type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>   C <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sapply</span>(ego.graphs, edge_density), <span class="dv">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>   <span class="fu">names</span>(C) <span class="ot">&lt;-</span> <span class="fu">V</span>(g)<span class="sc">$</span>name</span>
<span id="cb8-3"><a href="#cb8-3"></a>   C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      R2-D2   CHEWBACCA       C-3PO        LUKE DARTH VADER       CAMIE 
       0.67        1.00        0.60        0.34        0.67        1.00 
      BIGGS        LEIA        BERU        OWEN     OBI-WAN       MOTTI 
       0.54        0.42        0.90        1.00        0.76        1.00 
     TARKIN         HAN      GREEDO       JABBA     DODONNA GOLD LEADER 
       1.00        0.54         NaN         NaN        1.00        0.80 
      WEDGE  RED LEADER     RED TEN 
       0.80        0.57        1.00 </code></pre>
</div>
</div>
<p>Note we have a couple of <code>NaN</code> values in the slots corresponding to Greedo and Jabba in the clustering coefficient vector.</p>
<p>Let’s check out why:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>   <span class="fu">degree</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      R2-D2   CHEWBACCA       C-3PO        LUKE DARTH VADER       CAMIE 
          9           6          10          15           4           2 
      BIGGS        LEIA        BERU        OWEN     OBI-WAN       MOTTI 
          8          12           5           4           7           3 
     TARKIN         HAN      GREEDO       JABBA     DODONNA GOLD LEADER 
          3           8           1           1           3           5 
      WEDGE  RED LEADER     RED TEN 
          5           7           2 </code></pre>
</div>
</div>
<p>Here we see the problem is that both Greedo and Jabba are singleton nodes (with degree equal to one), so it doesn’t make sense to analyze their clustering coefficients because their ego graph is just an isolated node!</p>
<p>We can just drop them and re-analyze:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>   g <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(g, <span class="fu">degree</span>(g)<span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>   ego.graphs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name, create.ego, <span class="at">w =</span> g)</span>
<span id="cb12-3"><a href="#cb12-3"></a>   C <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sapply</span>(ego.graphs, edge_density), <span class="dv">2</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>   <span class="fu">names</span>(C) <span class="ot">&lt;-</span> <span class="fu">V</span>(g)<span class="sc">$</span>name</span>
<span id="cb12-5"><a href="#cb12-5"></a>   C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      R2-D2   CHEWBACCA       C-3PO        LUKE DARTH VADER       CAMIE 
       0.67        1.00        0.60        0.34        0.67        1.00 
      BIGGS        LEIA        BERU        OWEN     OBI-WAN       MOTTI 
       0.54        0.42        0.90        1.00        0.76        1.00 
     TARKIN         HAN     DODONNA GOLD LEADER       WEDGE  RED LEADER 
       1.00        1.00        1.00        0.80        0.80        0.57 
    RED TEN 
       1.00 </code></pre>
</div>
</div>
<p>Much better!</p>
<p>Note that in this analysis, Luke has the lowest clustering coefficient (<span class="math inline">\(C = 0.34\)</span>) this usually indicates an ego whose alters are partitioned into distinct clusters (and hence they are not connected to one another), and ego is a mediator or <em>broker</em> between those clusters.</p>
<p>Let’s see what that looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>   <span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>   luke.alters <span class="ot">&lt;-</span> <span class="fu">subgraph</span>(g, <span class="fu">neighbors</span>(g, <span class="st">"LUKE"</span>))  </span>
<span id="cb14-3"><a href="#cb14-3"></a>   <span class="fu">V</span>(luke.alters)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">cluster_leading_eigen</span>(luke.alters)<span class="sc">$</span>membership</span>
<span id="cb14-4"><a href="#cb14-4"></a>   <span class="fu">plot</span>(luke.alters, </span>
<span id="cb14-5"><a href="#cb14-5"></a>     <span class="at">vertex.size=</span><span class="dv">5</span>, <span class="at">vertex.frame.color=</span><span class="st">"lightgray"</span>, </span>
<span id="cb14-6"><a href="#cb14-6"></a>     <span class="at">vertex.label.dist=</span><span class="dv">2</span>, <span class="at">edge.curved=</span><span class="fl">0.2</span>, </span>
<span id="cb14-7"><a href="#cb14-7"></a>     <span class="at">vertex.label.cex =</span> <span class="fl">0.75</span>, <span class="at">edge.color =</span> <span class="st">"lightgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="handout8_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Luke’s Alters Network.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Note that in the ego graph that includes ego, each connected alter is a <strong>triangle</strong> in the ego graph. So the clustering coefficient is simply a count of the <em>number of undirected triangles that are centered on ego</em>, or the number of <em>cycles of length three centered on ego</em>.</p>
<p>So that means that the diagonals of the cube of the adjacency matrix also contain the information needed to compute the clustering coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>   A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g))</span>
<span id="cb15-2"><a href="#cb15-2"></a>   A3 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> A <span class="sc">%*%</span> A</span>
<span id="cb15-3"><a href="#cb15-3"></a>   <span class="fu">diag</span>(A3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      R2-D2   CHEWBACCA       C-3PO        LUKE DARTH VADER       CAMIE 
         48          30          54          72           8           2 
      BIGGS        LEIA        BERU        OWEN     OBI-WAN       MOTTI 
         30          56          18          12          32           6 
     TARKIN         HAN     DODONNA GOLD LEADER       WEDGE  RED LEADER 
          6          30           6          16          16          24 
    RED TEN 
          2 </code></pre>
</div>
</div>
<p>So all we need to do is divide these numbers by the maximum possible number of undirected triangles that could be centered on a node, which is <span class="math inline">\(k_i(k_i - 1)\)</span> where <span class="math inline">\(k_i\)</span> is ego’s degree:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   k <span class="ot">&lt;-</span> <span class="fu">degree</span>(g)</span>
<span id="cb17-2"><a href="#cb17-2"></a>   C <span class="ot">&lt;-</span> <span class="fu">diag</span>(A3)<span class="sc">/</span>(k<span class="sc">*</span>(k <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb17-3"><a href="#cb17-3"></a>   <span class="fu">round</span>(C, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      R2-D2   CHEWBACCA       C-3PO        LUKE DARTH VADER       CAMIE 
       0.67        1.00        0.60        0.34        0.67        1.00 
      BIGGS        LEIA        BERU        OWEN     OBI-WAN       MOTTI 
       0.54        0.42        0.90        1.00        0.76        1.00 
     TARKIN         HAN     DODONNA GOLD LEADER       WEDGE  RED LEADER 
       1.00        1.00        1.00        0.80        0.80        0.57 
    RED TEN 
       1.00 </code></pre>
</div>
</div>
<p>Which gives us the answer as before!</p>
<p>Finally, from each ego’s clustering coefficient (sometimes called the <strong>local clustering coefficient</strong> of each node) we can compute the graph’s <strong>global clustering coefficient</strong> which is just the average this quantity across each node in the graph:</p>
<p><span class="math display">\[
C(G) = \frac{1}{N}\sum_iC_i
\]</span></p>
<p>In <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>   C.glob <span class="ot">&lt;-</span> <span class="fu">mean</span>(C)</span>
<span id="cb19-2"><a href="#cb19-2"></a>   <span class="fu">round</span>(C.glob, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.79</code></pre>
</div>
</div>
<p>Which indicates a fairly clustered graph.</p>
<p>In <code>igraph</code> we can use the function <code>transitivity</code> to compute the local and global clustering coefficients, which can be specified using the argument <code>type</code>. For the local version, the function also expects a list of vertices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>   <span class="fu">round</span>(<span class="fu">transitivity</span>(g, <span class="fu">V</span>(g)<span class="sc">$</span>name, <span class="at">type =</span> <span class="st">"local"</span>), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      R2-D2   CHEWBACCA       C-3PO        LUKE DARTH VADER       CAMIE 
       0.67        1.00        0.60        0.34        0.67        1.00 
      BIGGS        LEIA        BERU        OWEN     OBI-WAN       MOTTI 
       0.54        0.42        0.90        1.00        0.76        1.00 
     TARKIN         HAN     DODONNA GOLD LEADER       WEDGE  RED LEADER 
       1.00        1.00        1.00        0.80        0.80        0.57 
    RED TEN 
       1.00 </code></pre>
</div>
</div>
<p>And the graph’s global clustering is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>   <span class="fu">round</span>(<span class="fu">transitivity</span>(g, <span class="at">type =</span> <span class="st">"average"</span>), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.79</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>